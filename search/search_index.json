{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Tactical RMM Documentation","text":"<p>Tactical RMM is a remote monitoring &amp; management tool for Windows computers, built with Django, Vue and Golang. It uses an agent written in Golang and integrates with MeshCentral</p>"},{"location":"#live-demo","title":"LIVE DEMO","text":""},{"location":"#features","title":"Features","text":"<ul> <li>Teamviewer-like remote desktop control</li> <li>Real-time remote shell</li> <li>Remote file browser (download and upload files)</li> <li>Remote command and script execution (batch, powershell and python scripts)</li> <li>Event log viewer</li> <li>Services management</li> <li>Windows patch management</li> <li>Automated checks with email/SMS alerting (cpu, disk, memory, services, scripts, event logs)</li> <li>Automated task runner (run scripts on a schedule)</li> <li>Remote software installation via chocolatey</li> <li>Software and hardware inventory</li> </ul>"},{"location":"3rdparty_anydesk/","title":"AnyDesk","text":""},{"location":"3rdparty_anydesk/#anydesk-integration","title":"AnyDesk Integration","text":"<p>Info</p> <p>You can setup a full automation policy to collect the machine GUID but this example will collect from just one agent for testing purposes.</p> <p>From the UI go to Settings &gt; Global Settings &gt; CUSTOM FIELDS &gt; Agents</p> <p>Add Custom Field Target = <code>Agent</code> Name = <code>AnyNetID</code> Field Type = <code>Text</code></p> <p></p> <p>While in Global Settings go to URL ACTIONS</p> <p>Add a URL Action Name = <code>AnyDesk Control</code> Description = <code>Connect to a AnyDesk Session</code> URL Pattern =</p> <pre><code>anydesk:{{agent.AnyNetID}}\n</code></pre> <p>Navigate to an agent with AnyDesk running (or apply using Settings &gt; Automation Manager). Go to Tasks. Add Task Select Script = <code>AnyDesk - Get AnyNetID for client</code> (this is a builtin script from script library) Descriptive name of task = <code>Collects the AnyNetID for AnyDesk.</code> Collector Task = <code>CHECKED</code> Custom Field to update = <code>AnyNetID</code></p> <p></p> <p>Click Next Check Manual Click Add Task</p> <p>Right click on the newly created task and click Run Task Now.</p> <p>Give it a second to execute then right click the agent that you are working with and go to Run URL Action &gt; AnyDesk Control</p> <p>It launch the session in AnyDesk.</p>"},{"location":"3rdparty_bitdefender_gravityzone/","title":"BitDefender GravityZone Deployment","text":""},{"location":"3rdparty_bitdefender_gravityzone/#how-to-deploy-bitdefender-gravityzone","title":"How to Deploy BitDefender GravityZone","text":"<p>From the UI go to Settings &gt; Global Settings &gt; CUSTOM FIELDS &gt; Clients</p> <p>Add a Custom Field</p> <p>First:  Target = <code>CLIENTS</code> Name = <code>bdurl</code> Field Type = <code>Text</code></p> <p></p> <p>Log into your GravityZone and on the left hand side, select \"Packages\" under \"Network\".</p> <p></p> <p>Select the client you are working with and click \"Send Download Links\" at the top. </p> <p></p> <p>Copy the appropriate download link</p> <p></p> <p>Paste download link into the <code>bdurl</code> when you right click your target clients name in the RMM.</p> <p></p> <p>Right click the Agent you want to deploy to and Run Script. Select BitDefender GravityZone Install and set timeout for 1800 seconds.</p> <p>Install time will vary based on internet speed and other AV removal by BitDefender BEST deployment</p>"},{"location":"3rdparty_grafana/","title":"Adding Grafana to Tactical RMM","text":"<p>Adding graphical Dashboards to Tactical.</p> <p>See https://github.com/dinger1986/TRMM-Grafana</p> <p></p> <p></p>"},{"location":"3rdparty_screenconnect/","title":"Screenconnect / Connectwise Control","text":""},{"location":"3rdparty_screenconnect/#connectwise-control-integration","title":"Connectwise Control Integration","text":"<p>Info</p> <p>To make this work you will need the name of a the Service from one of your agents running a Screen Connect Guest.</p> <p>Info</p> <p>You can setup a full automation policy to collect the machine GUID but this example will collect from just one agent for testing purposes.</p> <p>From the UI go to Settings &gt; Global Settings &gt; CUSTOM FIELDS &gt; Agents</p> <p>Add Custom Field Target = <code>Client</code> Name = <code>ScreenConnectService</code> Field Type = <code>Text</code> Default Value = <code>The name of your SC Service eg. ScreenConnect Client (XXXXXXXXXXXXXXXXX)</code></p> <p></p> <p>Add Custom Field Target = <code>Agent</code> Name = <code>ScreenConnectGUID</code> Field Type = <code>Text</code></p> <p></p> <p>While in Global Settings go to URL ACTIONS</p> <p>Add a URL Action Name = <code>ScreenConnect</code> Description = <code>Launch Screen Connect Session</code> URL Pattern =</p> <pre><code>https://&lt;your_screenconnect_fqdn_with_port&gt;/Host#Access/All%20Machines//{{agent.ScreenConnectGUID}}/Join\n</code></pre> <p></p> <p>Navigate to an agent with ConnectWise Service running (or apply using Settings &gt; Automation Manager). Go to Tasks. Add Task Select Script = <code>ScreenConnect - Get GUID for client</code> (this is a builtin script from script library) Script argument = <code>-serviceName {{client.ScreenConnectService}}</code> Descriptive name of task = <code>Collects the Machine GUID for ScreenConnect.</code> Collector Task = <code>CHECKED</code> Custom Field to update = <code>ScreenConectGUID</code></p> <p></p> <p>Click Next Check Manual Click Add Task</p> <p>Right click on the newly created task and click Run Task Now.</p> <p>Give it a second to execute then right click the agent that you are working with and go to Run URL Action &gt; ScreenConnect</p> <p>It should ask you to sign into your Connectwise Control server if you are not already logged in and launch the session.</p>"},{"location":"3rdparty_screenconnect/#install-screenconnect-via-tactical","title":"Install Screenconnect via Tactical","text":"<p>Use the Screenconnect AIO script</p> <p></p>"},{"location":"3rdparty_screenconnect/#install-tactical-rmm-via-screeconnect-commands-window","title":"Install Tactical RMM via Screeconnect commands window","text":"<ol> <li>Create a Deplopment under Agents &gt; Manage Deployments</li> <li>Replace <code>&lt;deployment URL&gt;</code> below with your Deployment Download Link.</li> </ol> <p>x64</p> <pre><code>#!ps\n#maxlength=500000\n#timeout=600000\n\nInvoke-WebRequest \"&lt;deployment URL&gt;\" -OutFile ( New-Item -Path \"C:\\temp\\trmminstallx64.exe\" -Force )\n$proc = Start-Process c:\\temp\\trmminstallx64.exe -ArgumentList '-silent' -PassThru\nWait-Process -InputObject $proc\n\nif ($proc.ExitCode -ne 0) {\n    Write-Warning \"$_ exited with status code $($proc.ExitCode)\"\n}\nRemove-Item -Path \"c:\\temp\\trmminstallx64.exe\" -Force \n</code></pre> <p>x86</p> <pre><code>#!ps\n#maxlength=500000\n#timeout=600000\n\nInvoke-WebRequest \"&lt;deployment URL&gt;\" -OutFile ( New-Item -Path \"C:\\temp\\trmminstallx86.exe\" -Force )\n$proc = Start-Process c:\\temp\\trmminstallx86.exe -ArgumentList '-silent' -PassThru\nWait-Process -InputObject $proc\n\nif ($proc.ExitCode -ne 0) {\n    Write-Warning \"$_ exited with status code $($proc.ExitCode)\"\n}\nRemove-Item -Path \"c:\\temp\\trmminstallx86.exe\" -Force \n</code></pre>"},{"location":"3rdparty_splashtop/","title":"Splashtop","text":""},{"location":"3rdparty_splashtop/#splashtop-integration","title":"Splashtop Integration","text":"<p>From the UI go to Settings &gt; Global Settings &gt; CUSTOM FIELDS &gt; Agents</p> <p>Add Custom Field Target = <code>Agent</code> Name = <code>SplashtopSUUID</code> Field Type = <code>Text</code></p> <p></p> <p>While in Global Settings go to URL ACTIONS</p> <p>Add a URL Action Name = <code>Splashtop</code> Description = <code>Connect to a Splashtop client</code> URL Pattern =</p> <pre><code>st-business://com.splashtop.business?account=&amp;uuid={{agent.SplashtopSUUID}}&amp;sessiontype=remote\n</code></pre> <p>Navigate to an agent with Splashtop running (or apply using Settings &gt; Automation Manager). Go to Tasks. Add Task Select Script = <code>Splashtop - Get SUUID for client</code> (this is a builtin script from script library) Descriptive name of task = <code>Obtain Splashtop SUUID from device registry.</code> Collector Task = <code>CHECKED</code> Custom Field to update = <code>SplashtopSUUID</code></p> <p></p> <p>Click Next Check Manual Click Add Task</p> <p>Right click on the newly created task and click Run Task Now.</p> <p>Give it a second to execute then right click the agent that you are working with and go to Run URL Action &gt; Splashtop</p>"},{"location":"3rdparty_teamviewer/","title":"TeamViewer","text":""},{"location":"3rdparty_teamviewer/#teamviewer-integration","title":"TeamViewer Integration","text":"<p>Info</p> <p>You can setup a full automation policy to collect the machine GUID but this example will collect from just one agent for testing purposes.</p> <p>From the UI go to Settings &gt; Global Settings &gt; CUSTOM FIELDS &gt; Agents</p> <p>Add Custom Field Target = <code>Agent</code> Name = <code>TeamViewerClientID</code> Field Type = <code>Text</code></p> <p></p> <p>While in Global Settings go to URL ACTIONS</p> <p>Add a URL Action Name = <code>TeamViewer Control</code> Description = <code>Connect to a Team Viewer Session</code> URL Pattern =</p> <pre><code>https://start.teamviewer.com/device/{{agent.TeamViewerClientID}}/authorization/password/mode/control\n</code></pre> <p>Navigate to an agent with TeamViewer running (or apply using Settings &gt; Automation Manager). Go to Tasks. Add Task Select Script = <code>TeamViewer - Get ClientID for client</code> (this is a builtin script from script library) Descriptive name of task = <code>Collects the ClientID for TeamViewer.</code> Collector Task = <code>CHECKED</code> Custom Field to update = <code>TeamViewerClientID</code></p> <p></p> <p>Click Next Check Manual Click Add Task</p> <p>Right click on the newly created task and click Run Task Now.</p> <p>Give it a second to execute then right click the agent that you are working with and go to Run URL Action &gt; TeamViewer Control</p> <p>It launch the session and possibly promt for password in TeamViewer.</p>"},{"location":"av/","title":"Antivirus","text":"<p>They are usually fraught with false-positives because we live in a world of complex greys, not black and white. </p> <p>At the moment, Microsoft Windows Defender thinks a go executable with virtually nothing in it is the \"Trojan:Win32/Wacatac.B!ml\" virus https://old.reddit.com/r/golang/comments/s1bh01/goexecutables_and_windows_defender/</p> <p>At Tactical we recommend: </p> <ol> <li>No 3rd party AV</li> <li>Use the <code>Defender Status Report</code> script (Task &gt; Run Daily - Use Automation manager) to monitor machines: https://github.com/wh1te909/tacticalrmm/blob/develop/scripts/Win_Defender_Status_Report.ps1</li> <li>If you want to lock a system down, run the <code>Defender Enable</code> script (test in your environment, because it can stop Microsoft Office from opening docs) that will turn on Protected Folders: https://github.com/wh1te909/tacticalrmm/blob/develop/scripts/Win_Defender_Enable.ps1 and you will be extremely safe. Annoyed, but safe. Use this as an Exclusion List for Protected Folders items.</li> </ol> <p>Be aware there is also a powershell script to add TRMM exclusions specific to Windows Defender</p> <p>Note</p> <p>If you need to use 3rd party AV, add the necessary exclusions (see below for examples) and submit the exe's as safe</p>"},{"location":"av/#bitdefender-gravityzone","title":"Bitdefender Gravityzone","text":"<p>Admin URL: https://cloud.gravityzone.bitdefender.com/</p> <p>To exclude URLs: Policies &gt; {policy name} &gt; Network Protection &gt; Content Control &gt; Settings &gt; Exclusions</p> <p></p> <p></p> <p></p>"},{"location":"av/#webroot","title":"Webroot","text":"<p>Admin URL:</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"av/#sophos","title":"Sophos","text":""},{"location":"av/#sophos-central-admin","title":"Sophos Central Admin","text":"<p>Go To Global Settings &gt;&gt; General &gt;&gt; Global Exclusions &gt;&gt; Add Exclusion</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"av/#sophos-xg-firewall","title":"Sophos XG Firewall","text":"<p>Log into Sophos Central Admin</p> <p>Admin URL: https://cloud.sophos.com/</p> <p>Log into the Sophos XG Firewall</p> <p>Go To System &gt;&gt; Hosts and services &gt;&gt; FQDN Host Group and create a new group</p> <p></p> <p>Go To System &gt;&gt; Hosts and services &gt;&gt; FQDN Host</p> <p>Create the following 3 hosts and add each to your FQDN host group.</p> <ul> <li>api.yourdomain.com</li> <li>mesh.yourdomain.com</li> <li>rmm.yourdomain.com (Optional if you want your client to have GUI access to Tactical RMM)</li> </ul> <p></p> <p></p> <p>Go To Hosts and services &gt;&gt; Services and create the following services</p> <ul> <li>Name: Tactical-Service-4222<ul> <li>Protocol: TCP</li> <li>Source port: 1:65535</li> <li>Destination port: 4222</li> </ul> </li> <li>Name: Tactical-Service-443<ul> <li>Protocol: TCP</li> <li>Source port: 1:65535</li> <li>Destination port: 443</li> </ul> </li> </ul> <p></p> <p></p> <p>Go To Hosts and services &gt;&gt; Service group and create the following service group</p> <p></p> <p>Go To Protect &gt;&gt; Rules and policies and add a firewall rule</p> <ul> <li>Rule name: Tactical Rule</li> <li>Rule position: Top</li> <li>Source zones: LAN</li> <li>Source networks: ANY</li> <li>Destination zones: WAN</li> <li>Destination networks: Your FQDN Host Group</li> <li>Services: Tactical Services</li> </ul> <p></p> <p></p> <p>Optionally select Log Firewall Traffic checkbox for troubleshooting.</p>"},{"location":"av/#eset-esmc-console","title":"ESET ESMC Console","text":"<p>There are two spots:</p> <ol> <li>In the Detection Engine -&gt; Performance Exclusions</li> <li>Web Access Protection -&gt; URL Address Management</li> </ol> <p></p> <p></p> <p></p> <p></p> <p></p>"},{"location":"backup/","title":"Backup","text":""},{"location":"backup/#backing-up-the-rmm","title":"Backing up the RMM","text":"<p>Note</p> <pre><code>This is only applicable for the standard install, not Docker installs.\n</code></pre> <p>A backup script is provided for quick and easy way to backup all settings into one file to move to another server.</p> <p>Download the backup script:</p> <pre><code>wget -N https://raw.githubusercontent.com/wh1te909/tacticalrmm/master/backup.sh\n</code></pre> <p>From the Web UI, click Tools &gt; Server Maintenance</p> <p>Choose Prune DB Tables from the dropdown and check the <code>Audit Log</code> and <code>Pending Actions</code> checkboxes, and then click Submit</p> <p>Doing a prune first before running the backup will significantly speed up the postgres vacuum command that is run during backup.</p> <p>Run the backup script</p> <pre><code>chmod +x backup.sh\n./backup.sh\n</code></pre> <p>The backup tar file will be saved in <code>/rmmbackups</code> with the following format:</p> <p><code>rmm-backup-CURRENTDATETIME.tar</code></p>"},{"location":"backup/#schedule-to-run-daily-via-cron","title":"Schedule to run daily via cron","text":"<p>Make a symlink in <code>/etc/cron.d</code> (daily cron jobs) with these contents <code>00 18 * * * tactical /rmm/backup.sh</code> to run at 6pm daily.</p> <pre><code>echo -e \"\\n\" &gt;&gt; /rmm/backup.sh\nsudo ln -s /rmm/backup.sh /etc/cron.daily/\n</code></pre> <p>Warning</p> <p>Currently the backup script doesn't have any pruning functions so the folder will grow forever without periodic cleanup</p>"},{"location":"backup/#video-walkthru","title":"Video Walkthru","text":""},{"location":"code_signing/","title":"Code Signing","text":"<p>Version added: Tactical RMM v0.6.0 / Agent v1.5.0</p> <p>Tactical RMM agents are now code signed!</p> <p>To get access to code signed agents, you must be a Github Sponsor with a minumum monthly donation of $50.00. If you signup for the $50, and then downgrade your auth token will be invalidated and stop working.</p> <p>Once you have become a sponsor, please email support@amidaware.com with your Github username (and Discord username if you're on our Discord)</p> <p>Please allow up to 24 hours for a response</p> <p>You will then be sent a code signing auth token, which you should enter into Tactical's web UI from Settings &gt; Code Signing</p>"},{"location":"code_signing/#how-does-it-work","title":"How does it work?","text":"<p>Everytime you generate an agent or an agent does a self-update, your self-hosted instance sends a request to Tactical's code signing servers with your auth token.</p> <p>If the token is valid, the server sends you back a code signed agent. If not, it sends you back the un-signed agent.</p> <p>If you think your auth token has been compromised or stolen then please email support or contact wh1te909 on discord to get a new token / invalidate the old one.</p>"},{"location":"contributing/","title":"Contributing","text":""},{"location":"contributing/#contributing-to-the-docs","title":"Contributing to the docs","text":"<p>Docs are built with MKDocs for Material</p> <p>To setup a local environment to add/edit to this documentation site:</p> <pre><code>mkdir ~/rmmdocs &amp;&amp; cd ~/rmmdocs\ngit clone https://github.com/wh1te909/tacticalrmm.git .\npython3 -m venv env\nsource env/bin/activate\npip install --upgrade pip\npip install --upgrade setuptools wheel\npip install -r api/tacticalrmm/requirements-dev.txt\ncd docs\nmkdocs serve\n</code></pre> <p>Open your browser and navigate to <code>http://yourserverip:8005</code></p> <p>Add/edit markdown files in the <code>docs/docs</code> folder and you'll see live changes at the url above.</p> <p>Edit <code>docs/mkdocs.yml</code> to edit structure and add new files.</p> <p>Full mkdocs documentation here</p> <p>Once finished, create a pull request to the <code>develop</code> branch for review.</p>"},{"location":"contributing_community_scripts/","title":"Community Scripts","text":""},{"location":"contributing_community_scripts/#script-library-naming-conventions","title":"Script Library Naming Conventions","text":""},{"location":"contributing_community_scripts/#file-names","title":"File names","text":"<p>Under <code>/scripts</code> the file name should generally follow this format:</p> <pre><code>(Platform)_(Category or Function)_(What It Does).xxx\n</code></pre> <p>Info</p> <p>Although Tactical RMM only has a Windows agent for now, we're planning for a future with more platform support</p> <p>Platform for now are:</p> <pre><code>Win\nOSX\nLinux\niOS\nAndroid\n</code></pre> <p>Good filename examples include:</p> <pre><code>Win_Azure_Mars_Cloud_Backup_Status.ps1\nWin_AzureAD_Check_Connection_Status.ps1\nWin_Network_DHCP_Set.bat\nWin_Network_DNS_Set_to_1.1.1.2.ps1\n</code></pre> <p>Info</p> <p>This is so that at a glance you can see if there is already a script with that function, and you can avoid duplication of functionality. If you can improve a script or allow Script Arguments/Parameters update existing if possible</p>"},{"location":"contributing_community_scripts/#name-field-in-community_scriptsjson","title":"Name field (in community_scripts.json)","text":"<p>Consider they are viewed in 3 different locations:</p> <p>Script Manager</p> <ul> <li> <p>List View (sortable by any column)</p> </li> <li> <p>Folder View (Grouped by Categories)</p> </li> </ul> <p>Run or Add script</p> <ul> <li>Running scripts manually or adding tasks (or adding in Automation Manager)</li> </ul> <p>Info</p> <p>A good max length is 50-60 chars or less for display in these 3 locations</p> <p>Make sure your Name roughly follows the order of file naming as above</p> <pre><code>Category or Function - What It Does\n</code></pre> <p>Consider how the alphabetic sort will affect display</p> <p></p>"},{"location":"contributing_community_scripts/#making-script-files","title":"Making Script Files","text":""},{"location":"contributing_community_scripts/#good-habits","title":"Good Habits","text":"<ul> <li> <p>Try and make them fully self-contained.</p> </li> <li> <p>If they pull data from elsewhere, create comment notes at the top with references for others to audit/validate</p> </li> <li> <p>Good folder locations to use for standardized things:</p> </li> </ul> <pre><code>c:\\ProgramData\\TacticalRMM\\\nc:\\ProgramData\\TacticalRMM\\scripts\nc:\\ProgramData\\TacticalRMM\\toolbox\nc:\\ProgramData\\TacticalRMM\\logs\nc:\\ProgramData\\TacticalRMM\\temp\nc:\\ProgramData\\TacticalRMM\\\n</code></pre> <ul> <li> <p>Command Parameters are good. Optional command parameters for extra functions are better.</p> </li> <li> <p>Add standardized Comment headers to scripts (include the first 2, more if appropriate):</p> </li> </ul> <pre><code>&lt;#\n.Synopsis\n   Short description\n   eg Check IP address\n.DESCRIPTION\n   Long description\n   eg Checks IP address on all local network adapters, and returns results\n.EXAMPLE\n   Example of how to use this cmdlet\n.EXAMPLE\n   Another example of how to use this cmdlet\n.INPUTS\n   Inputs to this cmdlet (if any)\n.OUTPUTS\n   Output from this cmdlet (if any)\n.NOTES\n   General notes\n   eg v1.0\n.COMPONENT\n   The component this cmdlet belongs to\n.ROLE\n   The role this cmdlet belongs to\n.FUNCTIONALITY\n   The functionality that best describes this cmdlet\n#&gt;\n</code></pre>"},{"location":"contributing_community_scripts/#bad-habits","title":"Bad Habits","text":"<ul> <li> <p>Assumes non-standard configurations</p> </li> <li> <p>Doesn't play well with other community scripts (reused names etc.)</p> </li> </ul>"},{"location":"contributing_community_scripts/#script-parameters","title":"Script Parameters","text":""},{"location":"contributing_community_scripts/#useful-reference-script-examples","title":"Useful Reference Script Examples","text":"<p>RunAsUser (since Tactical RMM runs as system) https://github.com/wh1te909/tacticalrmm/blob/develop/scripts/Win_Display_Message_To_User.ps1</p> <p>Command Paramater Ninja https://github.com/wh1te909/tacticalrmm/blob/develop/scripts/Win_ScreenConnectAIO.ps1</p> <p>Optional Command Parameters and testing for errors https://github.com/wh1te909/tacticalrmm/blob/develop/scripts/Win_Rename_Computer.ps1</p>"},{"location":"contributing_community_scripts/#volunteers-needed","title":"Volunteers Needed","text":"<p>If you want to contribute back to the project there are a lot of scripts that need some TLC (Tender Loving Care) please paruse thru them in The Script WIP (Work In Progress): https://github.com/wh1te909/tacticalrmm/tree/develop/scripts_wip</p> <p>Discuss/ask questions in the Discord group here</p> <p>What you can add is:</p> <ul> <li>Add standardized Comment headers per above</li> <li>Parameterize scripts where appropriate</li> <li>Add $ExitCode and error conditions as appropriate</li> <li>Contact @silversword in Discord if you need help doing Github additions/edits/adding to the community Library and have questions about Script Library Naming Conventions</li> </ul>"},{"location":"contributing_using_a_remote_server/","title":"Contributing Using a Remote Server","text":"<p>The below instructions are for a non-production server that has Tactical RMM installed and configured with a real domain. You can then use your own GitHub to push changes to and then submit a PR request to the TRMM <code>develop</code> branch (https://github.com/wh1te909/tacticalrmm).</p> <p>Warning</p> <p>Do not attempt development of this kind on your production server.</p>"},{"location":"contributing_using_a_remote_server/#install-tacticall-rmm","title":"Install Tacticall RMM","text":""},{"location":"contributing_using_a_remote_server/#1-traditional-install","title":"1. Traditional install","text":"<p>This guide assumes you have done a Traditional Install.</p>"},{"location":"contributing_using_a_remote_server/#2-install-vscode-and-extensions","title":"2. Install VSCode and Extensions","text":"<p>Download VSCode here</p> <p>Download the Remote SSH Development Pack here</p>"},{"location":"contributing_using_a_remote_server/#configure-the-remote-development-server","title":"Configure the Remote Development Server","text":""},{"location":"contributing_using_a_remote_server/#1-connect","title":"1. Connect","text":"<p>The remote development server should already have Tactical RMM installed via the traditional install method.</p> <p>After the extension pack is installed in VSCode you will have a new button at the bottom-left of VSCode. You can select it and add your remote SSH host information.</p> <p></p>"},{"location":"contributing_using_a_remote_server/#2-configure","title":"2. Configure","text":"<p>Configuring a remote server for development work is necessary so that as you make changes to the code base it will automatically refresh and you can see the changes. It may be necessary to do a full browser refresh if changing styles.</p> <p>Disable RMM and Daphne services</p> <pre><code>sudo systemctl disable --now rmm.service &amp;&amp; sudo systemctl disable --now daphne.service\n</code></pre> <p>Open /rmm/web/.env and make it look like the following</p> <pre><code>DEV_URL = \"http://api.EXAMPLE.COM:8000\"\nAPP_URL = \"http://rmm.EXAMPLE.COM:8080\"\n</code></pre> <p>Open /rmm/api/tacticalrmm/tacticalrmm/local_settings.py</p> <p><pre><code>change DEBUG = True\n</code></pre> Remove <pre><code>CORS_ORIGIN_WHITELIST list\n</code></pre> Add <pre><code>CORS_ORIGIN_ALLOW_ALL = True\n</code></pre></p> <p>Add the following to the ALLOWED HOSTS <pre><code>rmm.EXAMPLE.COM\n</code></pre> cd /rmm/api/tacticalrmm/</p> <pre><code>source ../env/bin/activate\n</code></pre> <p>Install requirements</p> <pre><code>pip install -r requirements-dev.txt -r requirements-test.txt\n</code></pre> <p>Start Django backend</p> <pre><code>python manage.py runserver 0:8000\n</code></pre> <p>Open a new terminal and compile quasar frontend</p> <pre><code>cd /rmm/web\nnpm install\nnpm install -g @quasar/cli\nquasar dev\n</code></pre> <p>Info</p> <p>If you receive a CORS error when trying to log into your server via localhost or IP, try the following</p> <p><pre><code>rm -rf node_modules .quasar\nnpm install\nquasar dev\n</code></pre> You should now have a localhost and IP based URL to view that has a live reload feature.</p>"},{"location":"contributing_using_a_remote_server/#configure-github-with-vscode","title":"Configure GitHub with VSCode","text":"<p>!!!info Make sure you are submitting Pull Requests to the develop branch. Follow this guide for a good introduction to GitHub: https://www.digitalocean.com/community/tutorials/how-to-create-a-pull-request-on-github</p> <p>Make sure u are on develop branch <pre><code>git checkout develop\n</code></pre> git remote -v should look like the following <pre><code>origin  https://github.com/yourusername/tacticalrmm.git (fetch)\norigin  https://github.com/yourusername/tacticalrmm.git (push)\nupstream https://github.com/wh1te909/tacticalrmm.git (fetch)\nupstream https://github.com/wh1te909/tacticalrmm.git (push)\n</code></pre> You will commit the change to your GitHub and from within GitHub you can then submit a PR to the develop branch of wh1te909 Tactical RMM.</p> <p>More to come...</p>"},{"location":"contributing_using_browser/","title":"Contributing Using Web Browser","text":""},{"location":"contributing_using_browser/#getting-started","title":"Getting Started","text":""},{"location":"contributing_using_browser/#1-fork-project-in-github","title":"1. Fork Project in Github","text":"<p>This is making a duplicate of the code under your Github that you can edit</p> <p>https://github.com/wh1te909/tacticalrmm</p> <p></p>"},{"location":"contributing_using_browser/#2-make-edits","title":"2. Make Edits","text":"<p>Make some changes</p> <p></p> <p></p>"},{"location":"contributing_using_browser/#3-request-your-changes-to-be-pulled-into-the-primary-repo-pull-request","title":"3. Request your changes to be pulled into the primary repo (Pull Request)","text":"<p>This is taking your changes and requesting they be integrated into the Tactical RMM develop branch.</p>"},{"location":"contributing_using_browser/#3a-check-the-status-of-your-pr","title":"3a. Check the status of your PR","text":"<p>Look at a summary of the changes you've requested, monitor for them to be accepted, or commented on.</p> <p>https://github.com/wh1te909/tacticalrmm/pulls</p> <p>Once they're accepted you can either: * Delete your fork * Sync your local fork</p>"},{"location":"contributing_using_browser/#4-sync-your-fork","title":"4. Sync your fork","text":"<p>https://docs.github.com/en/github/collaborating-with-issues-and-pull-requests/syncing-a-fork</p> <p>Bring changes from original repo to your fork so you're current with changes made in original Github repo</p> <p></p>"},{"location":"contributing_using_browser/#5-lather-rinse-repeat","title":"5. Lather, Rinse, Repeat","text":"<p>Goto Step 2. and contribute some more</p>"},{"location":"contributing_using_browser/#notes","title":"Notes","text":"<p>After your changes are accepted, they won't be live in Tactical RMM until there is a new release. #BePatient</p>"},{"location":"contributing_using_devbox/","title":"Contributing using devbox","text":"<p>Hidden docs, needs work</p> <p>For local Hyper-v Devbox notes</p> <p>From https://raw.githubusercontent.com/silversword411/tacticalrmm-devdocs</p> <p>Needs an official install_devbox.sh script</p>"},{"location":"contributing_using_devbox/#setup-local-devbox-in-hyper-v-vm","title":"Setup local devbox in hyper-v VM","text":""},{"location":"contributing_using_devbox/#install-ubuntu-2004-lts","title":"Install Ubuntu 20.04 LTS","text":"<p>Don't forget to </p> <pre><code>sudo apt-get updates &amp;&amp; sudo apt-get upgrade\n</code></pre>"},{"location":"contributing_using_devbox/#optional","title":"Optional","text":"<p>Set all users in sudo group not to require password every time:</p> <pre><code>sudo visudo\n</code></pre> <p>Add this:</p> <pre><code>%sudo ALL=(ALL) NOPASSWD: ALL\n</code></pre>"},{"location":"contributing_using_devbox/#download-customized-install-script-and-tweak","title":"Download customized install script and tweak","text":"<p>Create folder to dump into</p> <pre><code>sudo mkdir /rmm\nsudo chown ${USER}:${USER} -R /rmm\ncd /rmm\n</code></pre> <p>Get dev install script <pre><code>wget https://raw.githubusercontent.com/silversword411/tacticalrmm-devdocs/blob/main/install_devbox.sh\n</code></pre></p> <p>Edit, and search for <code>REPLACEMEWITHYOURFORKEDREPOURL</code></p> <p>and replace with your forked repo URL (example commented out below)</p>"},{"location":"contributing_using_devbox/#run-it","title":"Run it","text":"<pre><code>./install_devbox.sh\n</code></pre>"},{"location":"contributing_using_devbox/#watch-for","title":"Watch for","text":"<p>!!!Note Unlike regular installs, don't worry about the QR code</p>"},{"location":"contributing_using_devbox/#celebrate","title":"Celebrate","text":""},{"location":"contributing_using_devbox/#misc-commands","title":"Misc commands","text":""},{"location":"contributing_using_devbox/#start-mkdocs-on-dev-box","title":"Start mkdocs on dev box","text":"<pre><code>cd /rmm/api\nsource env/bin/activate\npip install --upgrade pip\npip install --upgrade setuptools wheel\npip install -r tacticalrmm/requirements-dev.txt\ncd /rmm/docs\nmkdocs serve\n</code></pre>"},{"location":"contributing_using_devbox/#running-tests-locally","title":"Running tests locally","text":"<p>Prep and update</p> <pre><code>source /rmm/api/env/bin/activate\ncd /rmm/api/tacticalrmm\npip install -r requirements.txt\n</code></pre> <p>Then run tests</p> <pre><code>python manage.py test\n</code></pre>"},{"location":"contributing_using_devbox/#misc-notes","title":"Misc Notes","text":""},{"location":"contributing_using_devbox/#spinning-up-front-end-web-interface-in-development","title":"Spinning up front end web interface in development","text":"<pre><code>cd /web\nnpm run serve\n</code></pre>"},{"location":"contributing_using_docker/","title":"Contributing using Docker","text":""},{"location":"contributing_using_docker/#install-wsl2","title":"Install WSL2","text":"<p>https://docs.microsoft.com/en-us/windows/wsl/install-win10</p>"},{"location":"contributing_using_docker/#install-docker-desktop","title":"Install Docker Desktop","text":"<p>https://www.docker.com/products/docker-desktop</p>"},{"location":"contributing_using_docker/#configure-docker","title":"Configure Docker","text":"<p>Make sure it doesn't look like this </p> <p>This is better</p> <p></p>"},{"location":"contributing_using_docker/#check-and-make-sure-wsl-is-v2-and-set-ubuntu-as-default","title":"Check and make sure WSL is v2 and set Ubuntu as default","text":"<p>https://docs.microsoft.com/en-us/windows/wsl/install-win10#set-your-distribution-version-to-wsl-1-or-wsl-2</p> <p></p>"},{"location":"contributing_using_docker/#install-vscode-extensions","title":"Install VSCode Extensions","text":"<p>Remote - Containers</p> <p>Docker</p>"},{"location":"contributing_using_docker/#connect-to-wsl-and-clone-your-github-fork","title":"Connect to WSL and clone your Github fork","text":""},{"location":"contributing_using_docker/#create-env-file","title":"Create .env file","text":"<p>Under .devcontainer duplicate</p> <pre><code>.env.example\n</code></pre> <p>as</p> <pre><code>.env\n</code></pre> <p>Customize to your tastes (it doesn't need to be internet configured, just add records in your <code>hosts</code> file) eg</p> <pre><code>127.0.0.1    rmm.example.com\n127.0.0.1    api.example.com\n127.0.0.1    mesh.example.com\n</code></pre>"},{"location":"contributing_using_docker/#launch-your-dev-vm-in-docker","title":"Launch your Dev VM in Docker","text":"<p>Right-click <code>docker-compose.yml</code> and choose <code>Compose Up</code></p> <p>Wait, it'll take a while as docker downloads all the modules and gets running.</p>"},{"location":"contributing_using_docker/#develop","title":"Develop","text":"<p>You're operational!</p> <p>Note</p> <p>Self-signed certs are in your dev environment. Navigate to https://api.example.com and https://rmm.example.com and accept the self signed certs to get rid of errors.</p>"},{"location":"contributing_using_docker/#view-mkdocks-live-edits-in-browser","title":"View mkdocks live edits in browser","text":"<p>Change stuff in <code>/docs/docs/</code></p> <p>mkdocs is Exposed on Port: 8005</p> <p>Open: http://rmm.example.com:8005/</p> <p>Note</p> <p>If you add new mkdocs extensions you might need to: - docker-compose down. - Then delete the <code>/api/tacticalrmm/env/</code> folder. - Then docker-compose up and it will download/rebuild new extensions</p>"},{"location":"contributing_using_docker/#view-django-administration","title":"View django administration","text":"<p>Open: http://rmm.example.com:8000/admin/</p>"},{"location":"contributing_using_vscode/","title":"Contributing Using VSCode","text":""},{"location":"contributing_using_vscode/#getting-started","title":"Getting Started","text":""},{"location":"contributing_using_vscode/#1-install-vscode","title":"1. Install vscode","text":"<p>https://code.visualstudio.com/download</p>"},{"location":"contributing_using_vscode/#2-fork-project-in-github","title":"2. Fork Project in Github","text":"<p>This is making a duplicate of the code under your Github that you can edit</p> <p>https://github.com/wh1te909/tacticalrmm</p> <p></p>"},{"location":"contributing_using_vscode/#3-add-your-forked-repo-to-vscode","title":"3. Add your (forked) repo to vscode","text":"<p>Clone repository</p> <p>Login to your Github</p> <p>Choose local folder</p>"},{"location":"contributing_using_vscode/#3a-install-extra-vscode-extensions","title":"3a. Install extra vscode Extensions","text":"<p>GitLens</p> <p>Remote - SSH</p>"},{"location":"contributing_using_vscode/#4-open-terminal","title":"4. Open Terminal","text":"<p>https://code.visualstudio.com/docs/editor/integrated-terminal</p> <pre><code>Ctrl+`\n</code></pre>"},{"location":"contributing_using_vscode/#5-configure-a-remote-for-your-fork-in-vscode","title":"5. Configure a remote for your fork (in vscode)","text":"<p>https://docs.github.com/en/github/collaborating-with-issues-and-pull-requests/configuring-a-remote-for-a-fork</p> <p>Configure your local fork and tell it where the original code repo is so you can compare and merge updates later when official repo is updated</p> <p>Check repos</p> <pre><code>git remote -v\n</code></pre> <p>Add upstream repo</p> <pre><code>git remote add upstream https://github.com/wh1te909/tacticalrmm\n</code></pre> <p>Confirm changes</p> <pre><code>git remote -v\n</code></pre>"},{"location":"contributing_using_vscode/#6-contribute-code","title":"6. Contribute code","text":"<p>Make changes to something.</p> <p><code>Commit</code> (update something) and notate what you did</p> <p><code>Push</code> (from your local vscode to your github fork)</p> <p>Open browser and look at your repo (It should reflect your commit)</p>"},{"location":"contributing_using_vscode/#6a-request-your-changes-to-be-pulled-into-the-primary-repo-pull-request","title":"6a. Request your changes to be pulled into the primary repo (Pull Request)","text":"<p>In browser create pull request</p>"},{"location":"contributing_using_vscode/#7-sync-your-local-fork","title":"7. Sync your local fork","text":"<p>https://docs.github.com/en/github/collaborating-with-issues-and-pull-requests/syncing-a-fork</p> <p>Bring changes from original repo to your local vscode copy so you're current with changes made in original Github repo</p> <p></p> <p>In VSCode open TERMINAL</p> <pre><code>Ctrl+`\n</code></pre> <p>Tell git to pull from the GitHub upstream repo all new changes into your local directory</p> <pre><code>git pull --rebase upstream develop\n</code></pre>"},{"location":"contributing_using_vscode/#7a-push-your-local-updated-copy-to-your-github-fork","title":"7a. Push your local updated copy to your Github fork","text":"<p>Then you're <code>push</code>ing that updated local repo to your online Github fork</p> <p></p>"},{"location":"contributing_using_vscode/#8-verify-and-repeat","title":"8. Verify and Repeat","text":"<p>Check your Github fork in browser, should be up to date now with original. Repeat 6 or 7 as necessary</p>"},{"location":"contributing_using_vscode/#reference","title":"Reference","text":""},{"location":"contributing_using_vscode/#customizing-the-admin-web-interface","title":"Customizing the Admin Web Interface","text":"<p>Created using quasar, it's all your .vue files in <code>web/src/components/modals/agents/RunScript.vue</code></p> <p>Learn stuff here</p> <p>https://quasar.dev/</p>"},{"location":"example_nginx/","title":"Example nginx","text":"<p>example of <code>/etc/nginx/sites-available/rmm.conf</code></p> <p>DO NOT COPY PASTE INTO YOUR SERVER ONLY USE AS A REFERENCE</p> <pre><code>server_tokens off;\n\nupstream tacticalrmm {\n    server unix:////rmm/api/tacticalrmm/tacticalrmm.sock;\n}\n\nmap $http_user_agent $ignore_ua {\n    \"~python-requests.*\" 0;\n    \"~go-resty.*\" 0;\n    default 1;\n}\n\nserver {\n    listen 80;\n    server_name api.example.com;\n    return 301 https://$server_name$request_uri;\n}\n\nserver {\n    listen 443 ssl;\n    server_name api.example.com;\n    client_max_body_size 300M;\n    access_log /rmm/api/tacticalrmm/tacticalrmm/private/log/access.log combined if=$ignore_ua;\n    error_log /rmm/api/tacticalrmm/tacticalrmm/private/log/error.log;\n    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;\n    ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384';\n\n    location /static/ {\n        root /rmm/api/tacticalrmm;\n    }\n\n    location /private/ {\n        internal;\n        add_header \"Access-Control-Allow-Origin\" \"https://rmm.example.com\";\n        alias /rmm/api/tacticalrmm/tacticalrmm/private/;\n    }\n\n    location ~ ^/(natsapi) {\n        allow 127.0.0.1;\n        deny all;\n        uwsgi_pass tacticalrmm;\n        include     /etc/nginx/uwsgi_params;\n        uwsgi_read_timeout 500s;\n        uwsgi_ignore_client_abort on;\n    }\n\n    location ~ ^/ws/ {\n        proxy_pass http://unix:/rmm/daphne.sock;\n\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n\n        proxy_redirect     off;\n        proxy_set_header   Host $host;\n        proxy_set_header   X-Real-IP $remote_addr;\n        proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header   X-Forwarded-Host $server_name;\n    }\n\n    location / {\n        uwsgi_pass  tacticalrmm;\n        include     /etc/nginx/uwsgi_params;\n        uwsgi_read_timeout 9999s;\n        uwsgi_ignore_client_abort on;\n    }\n}\n</code></pre>"},{"location":"faq/","title":"FAQ","text":""},{"location":"faq/#is-tactical-rmm-vulnerable-to-log4j","title":"Is Tactical RMM vulnerable to Log4j","text":"<p>No</p>"},{"location":"faq/#why-isnt-the-agent-source-available","title":"Why isn't the agent source available?","text":"<p>https://discord.com/channels/736478043522072608/744281907361218630/925449414498222103</p> <p>It's one of those \"this is why we can't have nice things\". Unfortunately there are a ton of shady people out there only looking to steal and make a profit off of someone else's work and they tried very hard with tactical.</p>"},{"location":"faq/#why-isnt-the-code-signing-free","title":"Why isn't the Code Signing free?","text":"<p>It's one way we're trying to monetize and get dev's paid. We had github sponsors up for many months before code signing. Very few people donated, some $5 and $10. maybe $40 a month. Once we announced code signing, sponsors came in like crazy, and many people upgraded their $5 to a $50 so while I would like to believe people would gladly donate, that's just not the case. We already tried.</p>"},{"location":"faq/#who-is-amidaware-llc","title":"Who is Amidaware LLC?","text":"<p>The Legal entity behind Tactical RMM</p>"},{"location":"faq/#is-it-possible-to-use-xxx-with-tactical-rmm","title":"Is it possible to use XXX with Tactical RMM","text":"<p>While it may be possible to use XXX, we have not configured it and therefore it is Unsupported. We cannot help you configure XXX as it pertains to your environment. </p>"},{"location":"faq/#is-it-possible-to-use-xxx-proxy-server-with-tactical-rmm","title":"Is it possible to use XXX proxy server with Tactical RMM","text":"<p>If you wish to stray from the easy install of a standard install in a VPS, you need to have the knowledge on how to troubleshoot your own custom environment.</p> <p>The most common reasons you're running a proxy is:</p> <ol> <li>Because you only have a single public IP and you already have something on Port 443. Workaround: Get another public IP from your ISP</li> <li>Because you want to monitor traffic for security reasons: You're a Networking Wizard.</li> </ol> <p>There are some implementations that others have done, but be aware it is Unsupported and if you're requesting help in Discord please let us know in advance.</p>"},{"location":"faq/#how-do-i-do-x-feature-in-the-web-ui","title":"How do I do X feature in the web UI?","text":"<p>Alot of features in the web UI are hidden behind right-click menus; almost everything has a right click menu so if you don't see something, try right clicking on it.</p>"},{"location":"faq/#where-are-the-linux-mac-agents","title":"Where are the Linux / Mac agents?","text":"<p>Linux / Mac agents are currently under development.</p>"},{"location":"faq/#can-i-run-tactical-rmm-locally-behind-nat-without-exposing-anything-to-the-internet","title":"Can I run Tactical RMM locally behind NAT without exposing anything to the internet?","text":"<p>Yes, you will just need to setup local DNS for the 3 subdomains, either by editing host files on all your agents or through a local DNS server.</p>"},{"location":"faq/#i-am-locked-out-of-the-web-ui-how-do-i-reset-my-password","title":"I am locked out of the web UI. How do I reset my password?","text":"<p>SSH into your server and run:</p> <pre><code>/rmm/api/env/bin/python /rmm/api/tacticalrmm/manage.py reset_password &lt;username&gt;\n</code></pre>"},{"location":"faq/#how-do-i-reset-password-or-2-factor-token","title":"How do I reset password or 2 factor token?","text":"<p>From the web UI, click Settings &gt; User Administration and then right-click on a user: </p> Reset Password or 2FA token  standard docker <pre><code>/rmm/api/env/bin/python /rmm/api/tacticalrmm/manage.py reset_2fa &lt;username&gt;\n</code></pre> <pre><code>docker exec -it trmm-backend /bin/bash\n</code></pre> <p>Then simply log out of the web UI and next time the user logs in they will be redirected to the 2FA setup page which will present a barcode to be scanned with the Authenticator app.</p>"},{"location":"faq/#how-do-i-recover-my-meshcentral-login-credentials","title":"How do I recover my MeshCentral login credentials?","text":"<p>From Tactical's web UI: Settings &gt; Global Settings &gt; MeshCentral</p> <p>Copy the username then ssh into the server and run:</p> <pre><code>cd /meshcentral/\nsudo systemctl stop meshcentral\nnode node_modules/meshcentral --resetaccount &lt;username&gt; --pass &lt;newpassword&gt;\nsudo systemctl start meshcentral\n</code></pre>"},{"location":"faq/#help-ive-been-hacked-there-are-weird-agents-appearing-in-my-tactical-rmm","title":"Help! I've been hacked there are weird agents appearing in my Tactical RMM","text":"<p>No, you haven't.</p> <ol> <li> <p>Your installer was scanned by an antivirus.</p> </li> <li> <p>It didn't recognize the exe.</p> </li> <li> <p>You have the option enabled to submit unknown applications for analysis.</p> <p></p> </li> <li> <p>They ran it against their virtualization testing cluster.</p> </li> <li> <p>You allow anyone to connect to your rmm server (you should look into techniques to hide your server from the internet).</p> </li> <li> <p>Here are some examples of what that looks like.</p> </li> </ol> <p></p> <p></p> <p></p> <p></p>"},{"location":"faq/#dns-cant-find-record","title":"DNS can't find record","text":"<p>Q. My dns isn\u2019t working </p> <p>A. Make sure it\u2019s correctly formatted some dns hosts add in the domain automatically. </p>"},{"location":"faq/#onsite-dns-server-and-lan-only-trmm-servers","title":"Onsite DNS server and LAN only TRMM servers","text":"<p>Q. Can I use onsite dns servers (I don\u2019t want my server internet accessible). </p> <p>A. Yes that\u2019s covered in the docs, you can use internal dns for api, mesh and rmm domains but need to add the dns txt to an internet resolvable dns server for letsencrypt wildcard cert</p>"},{"location":"faq/#self-signed-certs","title":"Self-Signed Certs","text":"<p>Q. Why can\u2019t I use a self signed certificate for web etc. </p> <p>A. NATS over TLS needs a real certificate signed with a trusted root certificate. NATS can function without TLS however that isn\u2019t recommended</p>"},{"location":"guide_gettingstarted/","title":"TLRD Version","text":""},{"location":"guide_gettingstarted/#at-install","title":"At Install","text":"<p>Setup Email Alerts Setup SMS Alerts Setup Server Preferences General Time Zone Clear faults on agents that haven't checked in after (days)</p> <p>Setup Automation Manager Default Profile for workstations</p>"},{"location":"guide_gettingstarted/#every-75-days","title":"Every 75 days","text":"<p>OS updates reboot Backup TRMM Update</p>"},{"location":"guide_gettingstarted/#biannually","title":"Biannually","text":""},{"location":"howitallworks/","title":"How It All Works","text":"<p>Still need graphics for</p> <pre><code>1. Agent installer steps\n\n2. Agent checks/tasks and how they work on the workstation/interact with server\n</code></pre>"},{"location":"howitallworks/#server","title":"Server","text":"<p>Has a postgres database located here:</p> <p>Django Admin</p> <p>Description</p> <p>A web interface for the postgres database</p> <p>All Tactical RMM dependencies are listed here</p>"},{"location":"howitallworks/#outbound-firewall-rules","title":"Outbound Firewall Rules","text":"<p>If you have strict firewall rules these are the only outbound rules from the server needed for all functionality:</p> <ol> <li>Outbound traffic to all agent IP scopes for reflect traffic from agents</li> </ol>"},{"location":"howitallworks/#server-without-code-signing-key","title":"Server without Code Signing key","text":"<p>No additional rules needed</p>"},{"location":"howitallworks/#server-with-code-signing-key","title":"Server with Code Signing key","text":"<p>No additional rules needed</p>"},{"location":"howitallworks/#system-services","title":"System Services","text":"<p>This lists the system services used by the server.</p>"},{"location":"howitallworks/#nginx-web-server","title":"nginx web server","text":"<p>Nginx is the web server for the <code>rmm</code>, <code>api</code>, and <code>mesh</code> domains. All sites redirect port 80 (HTTP) to port 443 (HTTPS).</p> <p>Warning</p> <p>nginx does not serve the NATS service on port 4222.</p> nginx configuration (a.k.a. sites available) <ul> <li>nginx configuration docs</li> </ul> <code>rmm.example.com</code> <code>api.example.com</code> <code>mesh.example.com</code> default <p>This serves the frontend website that you intereact with.</p> <ul> <li>Config: <code>/etc/nginx/sites-enabled/frontend.conf</code></li> <li>root: <code>/var/www/rmm/dist</code></li> <li>Access log: <code>/var/log/nginx/frontend-access.log</code></li> <li>Error log: <code>/var/log/nginx/frontend-error.log</code></li> <li>TLS certificate: <code>/etc/letsencrypt/live/example.com/fullchain.pem</code></li> </ul> <p>This serves the TRMM API for the frontend and agents. </p> <ul> <li>Config: <code>/etc/nginx/sites-enabled/rmm.conf</code></li> <li>roots:<ul> <li><code>/rmm/api/tacticalrmm/static/</code></li> <li><code>/rmm/api/tacticalrmm/tacticalrmm/private/</code></li> </ul> </li> <li>Upstreams:<ul> <li><code>unix://rmm/api/tacticalrmm/tacticalrmm.sock</code></li> <li><code>unix://rmm/daphne.sock</code></li> </ul> </li> <li>Access log: <code>/rmm/api/tacticalrmm/tacticalrmm/private/log/access.log</code></li> <li>Error log: <code>/rmm/api/tacticalrmm/tacticalrmm/private/log/error.log</code></li> <li>TLS certificate: <code>/etc/letsencrypt/live/example.com/fullchain.pem</code></li> </ul> <p>This serves MeshCentral for remote access.</p> <ul> <li>Config: <code>/etc/nginx/sites-enabled/meshcentral.conf</code></li> <li>Upstream: <code>http://127.0.0.1:4430/</code></li> <li>Access log: <code>/var/log/nginx/access.log</code> (uses deafult)</li> <li>Error log: <code>/var/log/nginx/error.log</code> (uses deafult)</li> <li>TLS certificate: <code>/etc/letsencrypt/live/example.com/fullchain.pem</code></li> </ul> <p>This is the default site installed with nginx. This listens on port 80 only.</p> <ul> <li>Config: <code>/etc/nginx/sites-enabled/default</code></li> <li>root: <code>/var/www/rmm/dist</code></li> <li>Access log: <code>/var/log/nginx/access.log</code> (uses deafult)</li> <li>Error log: <code>/var/log/nginx/error.log</code> (uses deafult)</li> </ul> systemd config  status commands standard docker <ul> <li>Status: <code>systemctl status --full nginx.service</code></li> <li>Stop: <code>systemctl stop nginx.service</code></li> <li>Start: <code>systemctl start nginx.service</code></li> <li>Restart: <code>systemctl restart nginx.service</code></li> <li>Restart: <code>systemctl reload nginx.service</code> reloads the config without restarting</li> <li>Test config: <code>nginx -t</code></li> <li>Listening process: <code>ss -tulnp | grep nginx</code></li> </ul> <ul> <li>Service: <code>nginx.service</code></li> <li>Address: <code>0.0.0.0</code></li> <li>Port: 443</li> <li>Exec: <code>/usr/sbin/nginx -g 'daemon on; master_process on;'</code></li> <li>Version: 1.18.0</li> </ul> <p>TBD - To Be Documented</p>"},{"location":"howitallworks/#tactical-rmm-django-uwsgi-service","title":"Tactical RMM (Django uWSGI) service","text":"<p>Built on the Django framework, the Tactical RMM service is the heart of system by serving the API for the frontend and agents.</p> systemd config <ul> <li>uWSGI docs</li> </ul>  status commands standard docker <ul> <li>Status: <code>systemctl status --full rmm.service</code></li> <li>Stop: <code>systemctl stop rmm.service</code></li> <li>Start: <code>systemctl start rmm.service</code></li> <li>Restart: <code>systemctl restart rmm.service</code></li> <li>journalctl:<ul> <li>\"tail\" the logs: <code>journalctl --identifier uwsgi --follow</code></li> <li>View the logs: <code>journalctl --identifier uwsgi --since \"30 minutes ago\" | less</code></li> </ul> </li> </ul> <ul> <li>Service: <code>rmm.service</code></li> <li>Socket: <code>/rmm/api/tacticalrmm/tacticalrmm.sock</code></li> <li>uWSGI config: <code>/rmm/api/tacticalrmm/app.ini</code></li> <li>Log: None</li> <li>Journal identifier: <code>uwsgi</code></li> <li>Version: 2.0.18</li> </ul> <p>TBD - To Be Documented</p>"},{"location":"howitallworks/#daphne-django-channels-daemon","title":"Daphne: Django channels daemon","text":"<p>Daphne is the official ASGI HTTP/WebSocket server maintained by the Channels project.</p> systemd config <ul> <li>Django Channels configuration docs</li> </ul>  status commands standard docker <ul> <li>Status: <code>systemctl status --full daphne.service</code></li> <li>Stop: <code>systemctl stop daphne.service</code></li> <li>Start: <code>systemctl start daphne.service</code></li> <li>Restart: <code>systemctl restart daphne.service</code></li> <li>journalctl (this provides only system start/stop logs, not the actual logs):<ul> <li>\"tail\" the logs: <code>journalctl --identifier daphne --follow</code></li> <li>View the logs: <code>journalctl --identifier daphne --since \"30 minutes ago\" | less</code></li> </ul> </li> </ul> <ul> <li>Service: <code>daphne.service</code></li> <li>Socket: <code>/rmm/daphne.sock</code></li> <li>Exec: <code>/rmm/api/env/bin/daphne -u /rmm/daphne.sock tacticalrmm.asgi:application</code></li> <li>Config: <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code></li> <li>Log: <code>/rmm/api/tacticalrmm/tacticalrmm/private/log/debug.log</code></li> </ul> <p>TBD - To Be Documented</p>"},{"location":"howitallworks/#nats-server-service","title":"NATS server service","text":"<p>NATS is a messaging bus for \"live\" communication between the agent and server. NATS provides the framework for the server to push commands to the agent and receive information back.</p> systemd config <ul> <li>NATS server configuration docs</li> </ul>  status commands standard docker <ul> <li>Status: <code>systemctl status --full nats.service</code></li> <li>Stop: <code>systemctl stop nats.service</code></li> <li>Start: <code>systemctl start nats.service</code></li> <li>Restart: <code>systemctl restart nats.service</code></li> <li>Restart: <code>systemctl reload nats.service</code> reloads the config without restarting</li> <li>journalctl:<ul> <li>\"tail\" the logs: <code>journalctl --identifier nats-server --follow</code></li> <li>View the logs: <code>journalctl --identifier nats-server --since \"30 minutes ago\" | less</code></li> </ul> </li> <li>Listening process: <code>ss -tulnp | grep nats-server</code></li> </ul> <ul> <li>Service: <code>nats.service</code></li> <li>Address: <code>0.0.0.0</code></li> <li>Port: <code>4222</code></li> <li>Exec: <code>/usr/local/bin/nats-server --config /rmm/api/tacticalrmm/nats-rmm.conf</code></li> <li>Config: <code>/rmm/api/tacticalrmm/nats-rmm.conf</code><ul> <li>TLS: <code>/etc/letsencrypt/live/example.com/fullchain.pem</code></li> </ul> </li> <li>Log: None</li> <li>Version: v2.3.3</li> </ul> <ul> <li>Get into bash in your docker with: <code>sudo docker-compose exec tactical-nats /bin/bash</code></li> <li>Log: <code>nats-api -log debug</code></li> </ul>"},{"location":"howitallworks/#nats-api-service","title":"NATS API service","text":"<p>The NATS API service is a very light golang wrapper to replace traditional http requests sent to django. The agent sends the data to nats-api which is always listening for agent requests (on Port 4222). It then saves the data to postgres directly.</p> systemd config  status commands standard docker <ul> <li>Status: <code>systemctl status --full nats-api.service</code></li> <li>Stop: <code>systemctl stop nats-api.service</code></li> <li>Start: <code>systemctl start nats-api.service</code></li> <li>Restart: <code>systemctl restart nats-api.service</code></li> <li>journalctl: This application does not appear to log anything.</li> </ul> <ul> <li>Service: <code>nats-api.service</code></li> <li>Exec: <code>/usr/local/bin/nats-api --config /rmm/api/tacticalrmm/nats-api.conf</code></li> <li>Config: <code>/rmm/api/tacticalrmm/nats-api.conf</code><ul> <li>TLS: <code>/etc/letsencrypt/live/example.com/fullchain.pem</code></li> </ul> </li> <li>Log: None</li> </ul> <p>TBD - To Be Documented</p>"},{"location":"howitallworks/#celery-service","title":"Celery service","text":"<p>Celery is a task queue focused on real-time processing and is responsible for scheduling tasks to be sent to agents.</p> <p>Log located at <code>/var/log/celery</code></p> systemd config <ul> <li>Celery docs</li> <li>Celery configuration docs</li> </ul>  status commands standard docker <ul> <li>Status: <code>systemctl status --full celery.service</code></li> <li>Stop: <code>systemctl stop celery.service</code></li> <li>Start: <code>systemctl start celery.service</code></li> <li>Restart: <code>systemctl restart celery.service</code></li> <li>journalctl: Celery executes <code>sh</code> causing the systemd identifier to be <code>sh</code>, thus mixing the <code>celery</code> and <code>celerybeat</code> logs together.<ul> <li>\"tail\" the logs: <code>journalctl --identifier sh --follow</code></li> <li>View the logs: <code>journalctl --identifier sh --since \"30 minutes ago\" | less</code></li> </ul> </li> <li>Tail logs: <code>tail -F /var/log/celery/w*-*.log</code></li> </ul> <ul> <li>Service: <code>celery.service</code></li> <li>Exec: <code>/bin/sh -c '${CELERY_BIN} -A $CELERY_APP multi start $CELERYD_NODES --pidfile=${CELERYD_PID_FILE} --logfile=${CELERYD_LOG_FILE} --loglevel=\"${CELERYD_LOG_LEVEL}\" $CELERYD_OPTS'</code></li> <li>Config: <code>/etc/conf.d/celery.conf</code></li> <li>Log: <code>/var/log/celery/w*-*.log</code></li> </ul> <p>TBD - To Be Documented</p>"},{"location":"howitallworks/#celery-beat-service","title":"Celery Beat service","text":"<p>celery beat is a scheduler; It kicks off tasks at regular intervals, that are then executed by available worker nodes in the cluster.</p> systemd config <ul> <li>Celery beat docs</li> </ul>  status commands standard docker <ul> <li>Status: <code>systemctl status --full celerybeat.service</code></li> <li>Stop: <code>systemctl stop celerybeat.service</code></li> <li>Start: <code>systemctl start celerybeat.service</code></li> <li>Restart: <code>systemctl restart celerybeat.service</code></li> <li>journalctl: Celery executes <code>sh</code> causing the systemd identifier to be <code>sh</code>, thus mixing the <code>celery</code> and <code>celerybeat</code> logs together.<ul> <li>\"tail\" the logs: <code>journalctl --identifier sh --follow</code></li> <li>View the logs: <code>journalctl --identifier sh --since \"30 minutes ago\" | less</code></li> </ul> </li> <li>Tail logs: <code>tail -F /var/log/celery/beat.log</code></li> </ul> <ul> <li>Service: <code>celerybeat.service</code></li> <li>Exec: <code>/bin/sh -c '${CELERY_BIN} -A ${CELERY_APP} beat --pidfile=${CELERYBEAT_PID_FILE} --logfile=${CELERYBEAT_LOG_FILE} --loglevel=${CELERYD_LOG_LEVEL}'</code></li> <li>Config: <code>/etc/conf.d/celery.conf</code></li> <li>Log: <code>/var/log/celery/beat.log</code></li> </ul> <p>TBD - To Be Documented</p>"},{"location":"howitallworks/#meshcentral","title":"MeshCentral","text":"<p>MeshCentral is used for: \"Take Control\" (connecting to machine for remote access), and 2 screens of the \"Remote Background\" (Terminal, and File Browser).</p> meshcentral <ul> <li>MeshCentral docs</li> </ul>  status commands Debugging <ul> <li>Status: <code>systemctl status --full meshcentral</code></li> <li>Stop: <code>systemctl stop meshcentral</code></li> <li>Start: <code>systemctl start meshcentral</code></li> <li>Restart: <code>systemctl restart meshcentral</code></li> </ul> <ul> <li>Open either \"Take Control\" or \"Remote Background\" to get mesh login token</li> <li>Open https://mesh.example.com to open native mesh admin interface</li> <li>Left-side \"My Server\" &gt; Choose \"Console\" &gt; type <code>agentstats</code></li> <li>To view detailed logging goto \"Trace\" &gt; click Tracing button and choose categories</li> </ul>"},{"location":"howitallworks/#other-dependencies","title":"Other Dependencies","text":"<p>Django - Framework to integrate the server to interact with browser.</p> Django dependencies <pre><code>future==0.18.2\nloguru==0.5.3\nmsgpack==1.0.2\npackaging==20.9\npsycopg2-binary==2.9.1\npycparser==2.20\npycryptodome==3.10.1\npyotp==2.6.0\npyparsing==2.4.7\npytz==2021.1\n</code></pre> <p>qrcode - Creating QR codes for 2FA.</p> qrcode dependencies <pre><code>redis==3.5.3\nrequests==2.25.1\nsix==1.16.0\nsqlparse==0.4.1\n</code></pre> <p>twilio - Python SMS notification integration.</p> twilio dependencies <pre><code>urllib3==1.26.5\nuWSGI==2.0.19.1\nvalidators==0.18.2\nvine==5.0.0\nwebsockets==9.1\nzipp==3.4.1\n</code></pre>"},{"location":"howitallworks/#windows-agent","title":"Windows Agent","text":"<p>Found in <code>%programfiles%\\TacticalAgent</code></p> <p>When scripts/checks execute, they are:</p> <ol> <li>transferred from the server via nats</li> <li>saved to a randomly created file in <code>c:\\windows\\temp\\trmm\\</code></li> <li>executed</li> <li>Return info is captured and returned to the server via nats</li> <li>File in <code>c:\\windows\\temp\\trmm\\</code> are removed automatically after execution/timeout.</li> </ol>"},{"location":"howitallworks/#outbound-firewall-rules_1","title":"Outbound Firewall Rules","text":"<p>If you have strict firewall rules these are the only outbound rules from the agent needed for all functionality:</p> <ol> <li> <p>All agents have to be able to connect outbound to TRMM server on the 3 domain names on ports: 443 (agent and mesh) and 4222 (nats for checks/tasks/data)</p> </li> <li> <p>The agent uses <code>https://icanhazip.tacticalrmm.io/</code> to get public IP info. If this site is down for whatever reason, the agent will fallback to <code>https://icanhazip.com</code> and then <code>https://ifconfig.co/ip</code></p> </li> </ol>"},{"location":"howitallworks/#unsigned-agents","title":"Unsigned Agents","text":"<p>Unsigned agents require access to: <code>https://github.com/wh1te909/rmmagent/releases/*</code></p>"},{"location":"howitallworks/#signed-agents","title":"Signed Agents","text":"<p>Signed agents will require: <code>https://exe.tacticalrmm.io/</code> and <code>https://exe2.tacticalrmm.io/</code> for downloading/updating agents</p>"},{"location":"howitallworks/#services","title":"Services","text":"<p>3 services exist on all clients</p> <ul> <li><code>Mesh Agent</code> </li> </ul> <p>AND</p> <ul> <li><code>TacticalAgent</code> and <code>Tactical RMM RPC Service</code> </li> </ul> <p>The MeshCentral system which is accessible from <code>https://mesh.example.com</code> and is used</p> <ul> <li>It runs 2 goroutines</li> <li>one is the checkrunner which runs all the checks and then just sleeps until it's time to run more checks</li> <li>2nd goroutine periodically sends info about the agent to the rmm and also handles agent recovery</li> </ul> <p>Note</p> <p>In Task Manager you will see additional <code>Tactical RMM Agent</code> processes appear and disappear. These are your Checks and Tasks running at scheduled intervals</p> <p><code>Tactical RMM RPC Service</code></p> <ul> <li>Uses the pub/sub model so anytime you do anything realtime from rmm (like a send command or run script)</li> <li>It maintains a persistent connection to your to the api.example.com rmm server on <code>port:4222</code> and is listening for events (using nats)</li> <li>It handles your Agent updates (Auto triggers at 35mins past every hour or when run manually from server Agents | Update Agents menu)</li> </ul>"},{"location":"howitallworks/#agent-installation-process","title":"Agent Installation Process","text":"<ul> <li>Adds Defender AV exclusions</li> <li>Copies temp files to <code>c:\\windows\\temp\\tacticalxxx</code> folder.</li> <li>INNO setup installs app into <code>%ProgramData%\\TacticalAgent\\</code> folder</li> </ul>"},{"location":"howitallworks/#agent-update-process","title":"Agent Update Process","text":"<p>Downloads latest <code>winagent-vx.x.x-x86/64.exe</code> to <code>%programfiles%</code></p> <p>Executes the file (INNO setup exe)</p> <p>Files create <code>c:\\Windows\\temp\\Tacticalxxxx\\</code> folder for install (and log files)</p>"},{"location":"howitallworks/#agent-recovery","title":"Agent Recovery","text":""},{"location":"howitallworks/#mesh-agent-recovery","title":"Mesh Agent Recovery","text":"<p>Tactical Agent just runs <code>mesh_agent.exe -something</code> to get the mesh agent id and saves it to the django database.</p>"},{"location":"howitallworks/#tactical-rpc-recovery","title":"Tactical RPC Recovery","text":""},{"location":"howitallworks/#tactical-agent-recovery","title":"Tactical Agent Recovery","text":""},{"location":"howitallworks/#windows-update-management","title":"Windows Update Management","text":"<p>Tactical RMM Agent sets:</p> <pre><code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\nAUOptions (REG_DWORD):\n1: Keep my computer up to date is disabled in Automatic Updates.\n</code></pre> <p>Uses this Microsoft API to handle updates: https://docs.microsoft.com/en-us/windows/win32/api/_wua/</p>"},{"location":"howitallworks/#log-files","title":"Log files","text":"<p>You can find 3 sets of detailed logs at <code>/rmm/api/tacticalrmm/tacticalrmm/private/log</code></p> <ul> <li> <p><code>error.log</code> nginx log for all errors on all TRMM URL's: rmm, api and mesh</p> </li> <li> <p><code>access.log</code> nginx log for access auditing on all URL's: rmm, api and mesh (this is a large file, and should be cleaned periodically)</p> </li> <li> <p><code>django_debug.log</code> created by django webapp</p> </li> </ul>"},{"location":"install_agent/","title":"Installing an agent","text":"<p>Warning</p> <p>If you don't want to deal with AV flagging/deleting your agents, check the instructions for getting code signed agents You must add antivirus exlusions for the tactical agent. Any decent AV will flag the agent as a virus, since it technically is one due to the nature of this software. Adding the following exlucions will make sure everything works, including agent update: <code>C:\\Program Files\\TacticalAgent\\*</code> <code>C:\\Program Files\\Mesh Agent\\*</code> <code>C:\\Windows\\Temp\\winagent-v*.exe</code> <code>C:\\Windows\\Temp\\trmm\\*</code> <code>C:\\temp\\tacticalrmm*.exe</code> See here for other screenshot examples</p>"},{"location":"install_agent/#dynamically-generated-executable","title":"Dynamically generated executable","text":"<p>The generated exe is simply a wrapper around the Manual install method, using a single exe/command without the need to pass any command line flags to the installer. All it does is download the generic installer from the agent's github release page and call it using predefined command line args that you choose from the web UI. It \"bakes\" the command line args into the executable.</p> <p>From the UI, click Agents &gt; Install Agent</p> <p>You can also right click on a site &gt; Install Agent. This will automatically fill in the client/site dropdown for you.</p> <p></p>"},{"location":"install_agent/#powershell","title":"Powershell","text":"<p>The powershell method is very similar to the generated exe in that it simply downloads the installer from github and calls the exe for you.</p>"},{"location":"install_agent/#manual","title":"Manual","text":"<p>The manual installation method requires you to first download the generic installer and call it using command line args. This is useful for scripting the installation using Group Policy or some other batch deployment method.</p> <p>Tip</p> <p>You can reuse the installer for any of the deployment methods, you don't need to constantly create a new installer for each new agent. The installer will be valid for however long you specify the token expiry time when generating an agent.</p>"},{"location":"install_agent/#using-a-deployment-link","title":"Using a deployment link","text":"<p>Creating a deployment link is the recommended way to deploy agents. The main benefit of this method is that the exectuable is generated only whenever the deployment download link is accessed, whereas with the other methods it's generated right away and the agent's version hardcoded into the exe. Using a deployment link will allow you to not worry about installing using an older version of an agent, which will fail to install if you have updated your RMM to a version that is not compatible with an older installer you might have lying around.</p> <p>To create a deployment, from the web UI click Agents &gt; Manage Deployments. </p> <p>Tip</p> <p>Create a client/site named \"Default\" and create a deployment for it with a very long expiry to have a generic installer that can be deployed anytime at any client/site. You can then move the agent into the correct client/site from the web UI after it's been installed.</p> <p>Copy/paste the download link from the deployment into your browser. It will take a few seconds to dynamically generate the executable and then your browser will automatically download the exe.</p>"},{"location":"install_agent/#optional-installer-args","title":"Optional installer args","text":"<p>The following optional arguments can be passed to any of the installation method executables:</p> <pre><code>-log debug\n</code></pre> <p>Will print very verbose logging during agent install. Useful for troubleshooting agent install.</p> <pre><code>-silent\n</code></pre> <p>This will not popup any message boxes during install, either any error messages or the \"Installation was successfull\" message box that pops up at the end of a successfull install.</p> <pre><code>-proxy \"http://proxyserver:port\"\n</code></pre> <p>Use a http proxy</p> <pre><code>-meshdir \"C:\\Program Files\\Your Company Name\\Mesh Agent\"\n</code></pre> <p>Specify the full path to the directory containing <code>MeshAgent.exe</code> if using custom agent branding for your MeshCentral instance.</p> <pre><code>-nomesh\n</code></pre> <p>Do not install meshcentral agent during tactical agent install. Note: take control, remote terminal and file browser will not work.</p>"},{"location":"install_agent/#scripting-agent-installation","title":"Scripting Agent Installation","text":"<p>If you want to deploy the TRMM agent using AD, intune, mesh, teamviewer, Group Policy GPO etc this is a sample CMD script for deploying Tactical.</p> <p>Note</p> <p>You will need to replace <code>deployment url</code> with your custom deployment URL</p> <pre><code>@echo off\n\nREM Setup deployment URL\nset \"DeploymentURL=\"\n\nset \"Name=\"\nfor /f \"usebackq tokens=* delims=\" %%# in (\n    `wmic service where \"name like 'tacticalagent'\" get Name /Format:Value`\n) do (\n    for /f \"tokens=* delims=\" %%g in (\"%%#\") do set \"%%g\"\n)\n\nif not defined Name (\n    echo Tactical RMM not found, installing now.\n    if not exist C:\\TEMP\\TRMM md C:\\TEMP\\TRMM\n    powershell Set-ExecutionPolicy -ExecutionPolicy Unrestricted\n    powershell Add-MpPreference -ExclusionPath C:\\TEMP\\TRMM\n    powershell Add-MpPreference -ExclusionPath \"C:\\Program Files\\TacticalAgent\\*\"\n    powershell Add-MpPreference -ExclusionPath C:\\Windows\\Temp\\winagent-v*.exe\n    powershell Add-MpPreference -ExclusionPath \"C:\\Program Files\\Mesh Agent\\*\"\n    powershell Add-MpPreference -ExclusionPath C:\\Windows\\Temp\\TRMM\\*\n    cd c:\\temp\\trmm\n    powershell Invoke-WebRequest \"%DeploymentURL%\" -Outfile tactical.exe\n    REM\"C:\\Program Files\\TacticalAgent\\unins000.exe\" /VERYSILENT\n    tactical.exe\n    powershell Remove-MpPreference -ExclusionPath C:\\TEMP\\TRMM\n    rem exit /b 1\n) else (\n       echo Tactical RMM already installed Exiting\n  Exit 0\n)\n</code></pre> <p>There is also a full powershell version here</p>"},{"location":"install_agent/#script-for-full-agent-uninstall","title":"Script for full agent uninstall","text":"<p>You can always use this to silently uninstall agent on workstations</p> <pre><code>\"C:\\Program Files\\TacticalAgent\\unins000.exe\" /VERYSILENT\n</code></pre>"},{"location":"install_agent/#reinstalling-mesh-and-reconnecting-to-trmm","title":"Reinstalling mesh and reconnecting to TRMM","text":"<p>Run this from Send Command</p> <pre><code>\"C:\\Program Files\\TacticalAgent\\meshagent.exe\" -fullinstall\n</code></pre> <p>Then use Agent Recovery | Mesh Agent and choose Recover</p>"},{"location":"install_considerations/","title":"Install Considerations","text":"<p>There's pluses and minuses to each install type. Be aware that:</p> <ul> <li>There is no migration script, once you've installed with one type there is no \"conversion\". You'll be installing a new server and migrating agents manually if you decide to go another way.</li> </ul>"},{"location":"install_considerations/#traditional-install","title":"Traditional Install","text":"<ul> <li>It's a VM/machine. One storage device to backup if you want to do VM based backups</li> <li>You have a backup and restore script</li> </ul>"},{"location":"install_considerations/#docker-install","title":"Docker Install","text":"<ul> <li>Docker is more complicated in concept: has volumes and images</li> <li>If you're running multiple apps it uses less resources in the long run because you only have one OS base files underlying many Containers/Apps</li> <li>Backup/restore is via Docker methods only</li> <li>Docker has container replication/mirroring options for redundancy/multiple servers</li> </ul>"},{"location":"install_docker/","title":"Docker Setup","text":""},{"location":"install_docker/#1-install-docker","title":"1. Install Docker","text":"<p>Install docker</p>"},{"location":"install_docker/#2-create-the-a-records","title":"2. Create the A records","text":"<p>We'll be using <code>example.com</code> as our domain for this example.</p> <p>Info</p> <p>The RMM uses 3 different sites. The Vue frontend e.g. <code>rmm.example.com</code> which is where you'll be accessing your RMM from the browser, the REST backend e.g. <code>api.example.com</code> and Meshcentral e.g. <code>mesh.example.com</code></p> <ol> <li>Get the public IP of your server with <code>curl https://icanhazip.tacticalrmm.io</code></li> <li>Open the DNS manager of wherever the domain you purchased is hosted.</li> <li>Create 3 A records: <code>rmm</code>, <code>api</code> and <code>mesh</code> and point them to the public IP of your server:</li> </ol> <p></p>"},{"location":"install_docker/#3-acquire-lets-encrypt-wildcard-certs-with-certbot","title":"3. Acquire Let's Encrypt Wildcard certs with certbot","text":"<p>Warning</p> <p>If the Let's Encrypt wildcard certificates are not provided, a self-signed certificate will be generated and most agent functions won't work. </p>"},{"location":"install_docker/#a-install-certbot","title":"A. Install Certbot","text":"<pre><code>sudo apt-get install certbot\n</code></pre>"},{"location":"install_docker/#b-generate-the-wildcard-lets-encrypt-certificates","title":"B. Generate the wildcard Let's Encrypt certificates","text":"<p>We're using the DNS-01 challenge method</p>"},{"location":"install_docker/#a-deploy-the-txt-record-in-your-dns-manager","title":"a. Deploy the TXT record in your DNS manager","text":"<p>Warning</p> <p>TXT records can take anywhere from 1 minute to a few hours to propagate depending on your DNS provider. You should verify the TXT record has been deployed first before pressing Enter. A quick way to check is with the following command: <code>dig -t txt _acme-challenge.example.com</code> or test using: https://viewdns.info/dnsrecord/ Enter: <code>_acme-challenge.example.com</code></p> <p></p> <p></p>"},{"location":"install_docker/#b-request-lets-encrypt-wildcard-cert","title":"b. Request Let's Encrypt Wildcard cert","text":"<pre><code>sudo certbot certonly --manual -d *.example.com --agree-tos --no-bootstrap --manual-public-ip-logging-ok --preferred-challenges dns\n</code></pre> <p>Note</p> <p>Replace <code>example.com</code> with your root domain</p>"},{"location":"install_docker/#4-configure-dns-and-firewall","title":"4. Configure DNS and firewall","text":"<p>You will need to add DNS entries so that the three subdomains resolve to the IP of the docker host. There is a reverse proxy running that will route the hostnames to the correct container. On the host, you will need to ensure the firewall is open on tcp ports 80, 443 and 4222.</p>"},{"location":"install_docker/#5-setting-up-the-environment","title":"5. Setting up the environment","text":"<p>Get the docker-compose and .env.example file on the host you which to install on</p> <pre><code>wget https://raw.githubusercontent.com/wh1te909/tacticalrmm/master/docker/docker-compose.yml\nwget https://raw.githubusercontent.com/wh1te909/tacticalrmm/master/docker/.env.example\nmv .env.example .env\n</code></pre> <p>Change the values in .env to match your environment.</p> <p>When supplying certificates through Let's Encrypt, see the section below about base64 encoding the certificate files.</p>"},{"location":"install_docker/#a-base64-encoding-certificates-to-pass-as-env-variables","title":"A. Base64 encoding certificates to pass as env variables","text":"<p>Use the below command to add the the correct values to the .env.</p> <p>Running this command multiple times will add redundant entries, so those will need to be removed.</p> <p>Let's encrypt certs paths are below. Replace ${rootdomain} with your own.</p> <p>public key <code>/etc/letsencrypt/live/${rootdomain}/fullchain.pem</code></p> <p>private key <code>/etc/letsencrypt/live/${rootdomain}/privkey.pem</code></p> <pre><code>echo \"CERT_PUB_KEY=$(sudo base64 -w 0 /path/to/pub/key)\" &gt;&gt; .env\necho \"CERT_PRIV_KEY=$(sudo base64 -w 0 /path/to/priv/key)\" &gt;&gt; .env\n</code></pre>"},{"location":"install_docker/#6-starting-the-environment","title":"6. Starting the environment","text":"<p>Run the below command to start the environment.</p> <pre><code>sudo docker-compose up -d\n</code></pre> <p>Removing the -d will start the containers in the foreground and is useful for debugging.</p>"},{"location":"install_docker/#7-get-meshcentral-exe-download-link","title":"7. Get MeshCentral EXE download link","text":"<p>Run the below command to get the download link for the mesh central exe. This needs to be uploaded on first successful signin.</p> <pre><code>sudo docker-compose exec tactical-backend python manage.py get_mesh_exe_url\n</code></pre> <p>Download the mesh agent:</p> <p></p> <p>Navigate to <code>https://rmm.example.com</code> and login with the username/password you created during install.</p> <p>Once logged in, you will be redirected to the initial setup page.</p> <p>Create your first client/site, choose the default timezone and then upload the mesh agent you just downloaded.</p>"},{"location":"install_docker/#note-about-backups","title":"Note about Backups","text":"<p>The backup script does not work with docker. To backup your install use standard docker backup/restore processes.</p>"},{"location":"install_server/","title":"Installation","text":""},{"location":"install_server/#general-information","title":"General Information","text":""},{"location":"install_server/#minimum-requirements","title":"Minimum requirements","text":""},{"location":"install_server/#hardware-os","title":"Hardware / OS","text":"<p>A fresh linux VM running either Ubuntu 20.04 LTS or Debian 10/11 with 2GB RAM</p> <p>Warning</p> <p>The provided install script assumes a fresh server with no software installed on it. Attempting to run it on an existing server with other services will break things and the install will fail.</p> <p>Note</p> <p>The install script has been tested on the following public cloud providers: DigitalOcean, Linode, Vultr, BuyVM (highly recommended), Hetzner, AWS, Google Cloud and Azure, as well as behind NAT on Hyper-V, Proxmox and ESXi.</p> <p>Note</p> <p>CPU: 1 core is fine for &lt; 200 agents with limited checks/tasks. Disk space and speed are dependent on your use case. Of course faster is better SSD/NVMe. Space is dependent on how long you're keeping historical data, and how many checks/script runs and their output size. 50GB should be fine for &lt; 12months of history on &lt; 200 agents with &lt; 30 checks/tasks run at reasonable time intervals.</p>"},{"location":"install_server/#network-requirements","title":"Network Requirements","text":"<ul> <li>A real (internet resolvable) domain is needed to generate a Let's Encrypt wildcard cert. If you cannot afford to purchase a domain ($12 a year) then you can get one for free at freenom.com<ul> <li>example.local is NOT a real domain. No you don't have to expose your server to the internet</li> </ul> </li> <li>A TOTP based authenticator app. Some popular ones are Google Authenticator, Authy and Microsoft Authenticator.</li> </ul>"},{"location":"install_server/#update-recommendations","title":"Update Recommendations","text":"<p>Note</p> <p>We highly recommend staying current with updates (at least every 3 months when you update your SSL certs is a good minimum) while Tactical RMM is still working towards its 1.0 release. Until we reach production release, there may be architectural changes that may be made to Tactical RMM and only a regular patching schedule is supported by developers.</p>"},{"location":"install_server/#option-1-easy-install-on-a-vps","title":"Option 1: Easy Install on a VPS","text":"<p>Install on a VPS: DigitalOcean, Linode, Vultr, BuyVM (highly recommended), Hetzner, AWS, Google Cloud and Azure to name a few</p> <p>Use something that meets minimum specs</p>"},{"location":"install_server/#run-updates-on-os","title":"Run Updates on OS","text":"<p>SSH into the server as root.</p> <p>Download and run the prereqs and latest updates</p> <pre><code>apt update\napt install -y wget curl sudo\napt -y upgrade\n</code></pre> <p>If a new kernel is installed, then reboot the server with the <code>reboot</code> command</p>"},{"location":"install_server/#create-a-linux-user","title":"Create a linux user","text":"<p>Create a linux user named <code>tactical</code> to run the rmm and add it to the sudoers group.</p> <p>For Ubuntu:</p> <pre><code>adduser tactical\nusermod -a -G sudo tactical\n</code></pre> <p>For Debian:</p> <pre><code>useradd -m -s /bin/bash tactical\nusermod -a -G sudo tactical\n</code></pre> <p>Tip</p> <p>Enable passwordless sudo to make your life easier in the future</p>"},{"location":"install_server/#setup-the-firewall-optional-but-highly-recommended","title":"Setup the firewall (optional but highly recommended)","text":"<p>Info</p> <p>Skip this step if your VM is not publicly exposed to the world e.g. running behind NAT. You should setup the firewall rules in your router instead (ports 22, 443 and 4222 TCP).</p> <pre><code>ufw default deny incoming\nufw default allow outgoing\nufw allow https\nufw allow proto tcp from any to any port 4222\n</code></pre> <p>Info</p> <p>SSH (port 22 tcp) is only required for you to remotely login and do basic linux server administration for your rmm. It is not needed for any agent communication.</p> <p>Allow ssh from everywhere (not recommended)</p> <pre><code>ufw allow ssh\n</code></pre> <p>Allow ssh from only allowed IP's (highly recommended)</p> <pre><code>ufw allow proto tcp from X.X.X.X to any port 22\nufw allow proto tcp from X.X.X.X to any port 22\n</code></pre> <p>Enable and activate the firewall</p> <pre><code>ufw enable &amp;&amp; ufw reload\n</code></pre> <p>Note</p> <p>You will never login to the server again as <code>root</code> again unless something has gone horribly wrong, and you're working with the developers.</p>"},{"location":"install_server/#create-the-a-records","title":"Create the A records","text":"<p>We'll be using <code>example.com</code> as our domain for this example.</p> <p>Info</p> <p>The RMM uses 3 different sites. The Vue frontend e.g. <code>rmm.example.com</code> which is where you'll be accessing your RMM from the browser, the REST backend e.g. <code>api.example.com</code> and Meshcentral e.g. <code>mesh.example.com</code></p> <ol> <li>Get the public IP of your server with <code>curl https://icanhazip.tacticalrmm.io</code></li> <li>Open the DNS manager of wherever the domain you purchased is hosted.</li> <li>Create 3 A records: <code>rmm</code>, <code>api</code> and <code>mesh</code> and point them to the public IP of your server:</li> </ol> <p></p>"},{"location":"install_server/#run-the-install-script","title":"Run the install script","text":"<p>Switch to the <code>tactical</code> user</p> <pre><code>su - tactical\n</code></pre> <p>Download and run the install script</p> <pre><code>wget https://raw.githubusercontent.com/wh1te909/tacticalrmm/master/install.sh\nchmod +x install.sh\n./install.sh\n</code></pre> <p>Answer the initial questions when prompted. Replace <code>example.com</code> with your domain.</p> <p></p>"},{"location":"install_server/#deploy-the-txt-record-in-your-dns-manager-for-lets-encrypt-wildcard-certs","title":"Deploy the TXT record in your DNS manager for Lets Encrypt wildcard certs","text":"<p>Warning</p> <p>TXT records can take anywhere from 1 minute to a few hours to propagate depending on your DNS provider. You should verify the TXT record has been deployed first before pressing Enter. A quick way to check is with the following command: <code>dig -t txt _acme-challenge.example.com</code> or test using: https://viewdns.info/dnsrecord/ Enter: <code>_acme-challenge.example.com</code></p> <p></p> <p></p> <p>Create a login for the RMM web UI:</p> <p></p> <p>A bunch of URLS / usernames / passwords will be printed out at the end of the install script. Save these somewhere safe. Recover them if you didn't</p>"},{"location":"install_server/#upload-mesh-agents","title":"Upload mesh agents","text":"<p>Copy the url for the meshagent exe (<code>https://mesh.example.com/agentinvite?c=......</code>), paste it in your browser and download the mesh agent:</p> <p></p> <p>Navigate to <code>https://rmm.example.com</code> and login with the username/password you created during install.</p> <p>Once logged in, you will be redirected to the initial setup page.</p> <p>Create your first client/site, choose the default timezone and then upload the mesh agent you just downloaded.</p>"},{"location":"install_server/#youre-done","title":"You're Done","text":"<p>Update Regularly</p>"},{"location":"install_server/#option-2-install-behind-nat-router","title":"Option 2: Install behind NAT Router","text":"<p>Install in your local network using: Dedicated hardware, Hyper-V, Proxmox or ESXi. All been tested and work fine.</p> <p>Do everything from Option 1: Easy Install</p>"},{"location":"install_server/#if-you-only-have-agents-on-the-private-networksubnet","title":"If you only have agents on the private network/subnet","text":"<p>Make sure your local DNS server (or agents hosts file) have your Tactical RMM server IP addresses for the 3 domain names: <code>rmm</code>, <code>api</code> and <code>mesh</code></p>"},{"location":"install_server/#agents-exist-outside-the-private-networksubnet-setup-port-forwarding","title":"Agents exist outside the private network/subnet - Setup Port Forwarding","text":"<p>If you have agents outside your local network: Make sure the public DNS servers have A records for the 3 Tactical RMM server domain names: <code>rmm</code>, <code>api</code> and <code>mesh</code></p> <p>Login to your router/NAT device.</p> <ol> <li>Set your TRMM server as a static IP (Using a DHCP reservation is usually safer)</li> <li>Create 2 port forwarding rules. <code>TCP Port 443</code> and <code>TCP Port 4222</code> to your TRMM servers private IP address.</li> </ol> <p>Note</p> <p>https://portforward.com/ can help with Port Forwarding setup</p>"},{"location":"install_server/#youre-done_1","title":"You're Done","text":"<p>Update Regularly</p>"},{"location":"install_server/#option-3-installs-by-network-wizards","title":"Option 3: Installs by Network Wizards","text":"<p>Use the scripts above.</p>"},{"location":"install_server/#requirements","title":"Requirements","text":"<ol> <li>TLD domain name which is internet resolvable (this is for a LetsEncrypt DNS wildcard request during the install script validated by DNS txt record).<ul> <li>Test using: https://viewdns.info/dnsrecord/ or https://dnschecker.org/. Enter: <code>_acme-challenge.example.com</code> as <code>TXT</code></li> </ul> </li> <li>Agents need to be able to connect to your server via DNS lookup (hosts file, local DNS, smoke signals etc.).<ul> <li>Test from agent: <code>ping rmm.example.com</code>. Should result in the IP of your Tactical RMM server</li> <li>Test from agent: <code>ping api.example.com</code>. Should result in the IP of your Tactical RMM server</li> <li>Test from agent: <code>ping mesh.example.com</code>. Should result in the IP of your Tactical RMM server</li> </ul> </li> </ol> <p>Note</p> <p>Did you notice #2 doesn't need to be something publicly available?</p> <p>That's it. You're a wizard, you know how to satisfy these 2 items.</p> <p>You'll probably enjoy browsing thru the Unsupported section of the docs.</p>"},{"location":"install_server/#update-regularly","title":"Update Regularly","text":"<p>We've said it before, we'll say it again.</p> <ul> <li> <p>We recommend regular updates.</p> <ul> <li> <p>Every 2-3 months.</p> <ul> <li>Do it when you update your SSL certs.</li> </ul> </li> </ul> </li> </ul>"},{"location":"license/","title":"License","text":"<p>MIT License</p> <p>Copyright (c) 2019-present wh1te909</p> <p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p> <p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p> <p>THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>"},{"location":"management_cmds/","title":"Management Commands","text":"<p>To run any of the management commands you must first activate the python virtual env:</p> <pre><code>cd /rmm/api/tacticalrmm\nsource ../env/bin/activate\n</code></pre> <p>or docker version:</p> <pre><code>docker exec -it trmm-backend /bin/bash\n/opt/venv/bin/python /opt/tactical/api/manage.py shell\n</code></pre> <p>Tip</p> <p>The Dev Docker version it would be <code>docker exec -it trmm-api-dev env/bin/python manage.py shell</code></p>"},{"location":"management_cmds/#bulk-delete-old-agents-by-last-checkin-date-or-agent-version","title":"Bulk Delete old agents by last checkin date or agent version","text":"<p>Test to see what will happen</p> <pre><code>python manage.py bulk_delete_agents --days 60\npython manage.py bulk_delete_agents --agentver 1.5.0\n</code></pre> <p>Do the delete</p> <pre><code>python manage.py bulk_delete_agents --days 60 --delete\npython manage.py bulk_delete_agents --agentver 1.5.0 --delete\n</code></pre>"},{"location":"management_cmds/#reset-a-users-password","title":"Reset a user's password","text":"<pre><code>python manage.py reset_password &lt;username&gt;\n</code></pre>"},{"location":"management_cmds/#reset-a-users-2fa-token","title":"Reset a user's 2fa token","text":"<pre><code>python manage.py reset_2fa &lt;username&gt;\n</code></pre>"},{"location":"management_cmds/#find-all-agents-that-have-x-software-installed","title":"Find all agents that have X software installed","text":"<pre><code>python manage.py find_software \"adobe\"\n</code></pre>"},{"location":"management_cmds/#set-specific-windows-update-to-not-install","title":"Set specific Windows update to not install","text":"<pre><code>from winupdate.models import WinUpdate\nWinUpdate.objects.filter(kb=\"KB5007186\").update(action=\"ignore\", date_installed=None)\n</code></pre>"},{"location":"management_cmds/#show-outdated-online-agents","title":"Show outdated online agents","text":"<pre><code>python manage.py show_outdated_agents\n</code></pre>"},{"location":"management_cmds/#log-out-all-active-web-sessions","title":"Log out all active web sessions","text":"<pre><code>python manage.py delete_tokens\n</code></pre>"},{"location":"management_cmds/#reset-all-auth-tokens-for-install-agents-and-web-sessions","title":"Reset all Auth Tokens for Install agents and web sessions","text":"<pre><code>python manage.py shell\nfrom knox.models import AuthToken\nAuthToken.objects.all().delete()\n</code></pre>"},{"location":"management_cmds/#check-for-orphaned-tasks-on-all-agents-and-remove-them","title":"Check for orphaned tasks on all agents and remove them","text":"<pre><code>python manage.py remove_orphaned_tasks\n</code></pre>"},{"location":"management_cmds/#create-a-meshcentral-agent-invite-link","title":"Create a MeshCentral agent invite link","text":"<pre><code>python manage.py get_mesh_exe_url\n</code></pre>"},{"location":"management_cmds/#bulk-update-agent-offlineoverdue-time","title":"Bulk update agent offline/overdue time","text":"<p>Change offline time on all agents to 5 minutes</p> <pre><code>python manage.py bulk_change_checkin --offline --all 5\n</code></pre> <p>Change offline time on all agents in site named Example Site to 2 minutes</p> <pre><code>python manage.py bulk_change_checkin --offline --site \"Example Site\" 2\n</code></pre> <p>Change offline time on all agents in client named Example Client to 12 minutes</p> <pre><code>python manage.py bulk_change_checkin --offline --client \"Example Client\" 12\n</code></pre> <p>Change overdue time on all agents to 10 minutes</p> <pre><code>python manage.py bulk_change_checkin --overdue --all 10\n</code></pre> <p>Change overdue time on all agents in site named Example Site to 4 minutes</p> <pre><code>python manage.py bulk_change_checkin --overdue --site \"Example Site\" 4\n</code></pre> <p>Change overdue time on all agents in client named Example Client to 14 minutes</p> <pre><code>python manage.py bulk_change_checkin --overdue --client \"Example Client\" 14\n</code></pre>"},{"location":"mesh_integration/","title":"MeshCentral Integration","text":""},{"location":"mesh_integration/#overview","title":"Overview","text":"<p>Tactical RMM integrates with MeshCentral for the following 3 functions:</p> <ul> <li>Take Control</li> <li>Real time shell</li> <li>Real time file browser</li> </ul> <p>At some point in the future, these functions will be directly built into the Tactical Agent, removing the need for MeshCentral.</p> <p>It should be noted that Tactical RMM and MeshCentral are 2 completely separate products and can run independently of each other.</p> <p>They do not even have to run on the same box, however when you install Tactical RMM it simply installs meshcentral for you with some preconfigured settings to allow integration.</p> <p>It is highly recommended to use the MeshCentral instance that Tactical installs, since it allows the developers more control over it and to ensure things don't break.</p>"},{"location":"mesh_integration/#how-does-it-work","title":"How does it work","text":"<p>MeshCentral has an embedding feature that allows integration into existing products.</p> <p>See Section 14 - Embedding MeshCentral in the MeshCentral User Guide for a detailed explanation of how this works.</p> <p>The Tactical RMM Agent keeps track of your Mesh Agents, and periodically interacts with them to synchronize the mesh agent's unique ID with the tactical rmm database.</p> <p>When you do a take control / terminal / file browser on an agent using the Tactical UI, behind the scenes, Tactical generates a login token for meshcentral's website and then \"wraps\" MeshCentral's UI in an iframe for that specific agent only, using it's unique ID to know what agent to render in the iframe.</p>"},{"location":"restore/","title":"Restore","text":"<p>Info</p> <p>It is currently not possible to restore to a different domain/subdomain, only to a different physical or virtual server.</p> <p>Danger</p> <p>The restore script will always restore to the latest available RMM version on github.</p> <p>Make sure you update your old RMM to the latest version using the <code>update.sh</code> script and then run a fresh backup to use with this restore script.</p>"},{"location":"restore/#install-the-new-server","title":"Install the new server","text":""},{"location":"restore/#run-updates-on-os","title":"Run Updates on OS","text":"<p>SSH into the server as root.</p> <p>Download and run the prereqs and latest updates</p> <pre><code>apt update\napt install -y wget curl sudo\napt -y upgrade\n</code></pre> <p>If a new kernel is installed, then reboot the server with the <code>reboot</code> command</p>"},{"location":"restore/#create-a-linux-user","title":"Create a linux user","text":"<p>Create a linux user named <code>tactical</code> to run the rmm and add it to the sudoers group.</p> <p>For Ubuntu:</p> <pre><code>adduser tactical\nusermod -a -G sudo tactical\n</code></pre> <p>For Debian:</p> <pre><code>useradd -m -s /bin/bash tactical\nusermod -a -G sudo tactical\n</code></pre> <p>Tip</p> <p>Enable passwordless sudo to make your life easier in the future</p>"},{"location":"restore/#setup-the-firewall-optional-but-highly-recommended","title":"Setup the firewall (optional but highly recommended)","text":"<p>Info</p> <p>Skip this step if your VM is not publicly exposed to the world e.g. running behind NAT. You should setup the firewall rules in your router instead (ports 22, 443 and 4222 TCP).</p> <pre><code>ufw default deny incoming\nufw default allow outgoing\nufw allow https\nufw allow proto tcp from any to any port 4222\n</code></pre> <p>Info</p> <p>SSH (port 22 tcp) is only required for you to remotely login and do basic linux server administration for your rmm. It is not needed for any agent communication.</p> <p>Allow ssh from everywhere (not recommended)</p> <pre><code>ufw allow ssh\n</code></pre> <p>Allow ssh from only allowed IP's (highly recommended)</p> <pre><code>ufw allow proto tcp from X.X.X.X to any port 22\nufw allow proto tcp from X.X.X.X to any port 22\n</code></pre> <p>Enable and activate the firewall</p> <pre><code>ufw enable &amp;&amp; ufw reload\n</code></pre> <p>Note</p> <p>You will never login to the server again as <code>root</code> again unless something has gone horribly wrong, and you're working with the developers.</p>"},{"location":"restore/#change-dns-a-records","title":"Change DNS A records","text":"<p>Open the DNS manager of wherever your domain is hosted.</p> <p>Change the 3 A records <code>rmm</code>, <code>api</code> and <code>mesh</code> and point them to the public IP of your new server.</p>"},{"location":"restore/#run-the-restore-script","title":"Run the restore script","text":"<ol> <li> <p>Make sure you're logged in with the non-root user (eg <code>tactical</code>)</p> </li> <li> <p>Copy the backup tar file you created during backup to the new server.</p> </li> <li> <p>Download the restore script.</p> <pre><code>wget https://raw.githubusercontent.com/wh1te909/tacticalrmm/master/restore.sh\nchmod +x restore.sh\n</code></pre> </li> <li> <p>Call the restore script, passing it the backup file as the first argument:</p> </li> </ol> <pre><code>./restore.sh rmm-backup-XXXXXXXXX.tar\n</code></pre>"},{"location":"script_variables/","title":"Script Variables","text":"<p>Tactical RMM allows passing dashboard data into script as arguments. This uses the syntax <code>{{client.name}}</code>.</p> <p>See below for the available options.</p> <p>Info</p> <p>Everything between {{}} is CaSe sEnSiTive</p>"},{"location":"script_variables/#agent","title":"Agent","text":"<ul> <li>{{agent.version}} - Tactical RMM agent version</li> <li>{{agent.operating_system}} - Agent operating system example: Windows 10 Pro, 64 bit (build 19042.928)</li> <li>{{agent.plat}} - Will show the platform example: windows</li> <li>{{agent.plat_release}} - Will show the platform release</li> <li>{{agent.hostname}} - The hostname of the agent</li> <li>{{agent.local_ips}} - Local IP address of agent</li> <li>{{agent.public_ip}} - Public IP address of agent</li> <li>{{agent.agent_id}} - agent ID in database</li> <li>{{agent.last_seen}} - Date and Time Agent last seen</li> <li>{{agent.used_ram}} - Used RAM on agent. Returns an integer - example: 16</li> <li>{{agent.total_ram}} - Total RAM on agent. Returns an integer - example: 16</li> <li>{{agent.boot_time}} - Uptime of agent. Returns unix timestamp. example: 1619439603.0</li> <li>{{agent.logged_in_username}} - Username of logged in user</li> <li>{{agent.last_logged_in_user}} - Username of last logged in user</li> <li>{{agent.monitoring_type}} - Returns a string of workstation or server</li> <li>{{agent.description}} - Description of agent in dashboard</li> <li>{{agent.mesh_node_id}} - The mesh node id used for linking the tactical agent to mesh.</li> <li>{{agent.overdue_email_alert}} - Returns true if overdue email alerts is enabled in TRMM</li> <li>{{agent.overdue_text_alert}} - Returns true if overdue SMS alerts is enabled in TRMM</li> <li>{{agent.overdue_dashboard_alert}} - Returns true if overdue agent alerts is enabled in TRMM</li> <li>{{agent.offline_time}} - Returns offline time setting for agent in TRMM</li> <li>{{agent.overdue_time}} - Returns overdue time setting for agent in TRMM</li> <li>{{agent.check_interval}} - Returns check interval time setting for agent in TRMM</li> <li>{{agent.needs_reboot}} - Returns true if reboot is pending on agent</li> <li>{{agent.choco_installed}} - Returns true if Chocolatey is installed</li> <li>{{agent.patches_last_installed}} - The date that patches were last installed by Tactical RMM.</li> <li>{{agent.needs_reboot}} - Returns true if the agent needs a reboot</li> <li>{{agent.time_zone}} - Returns timezone configured on agent</li> <li>{{agent.maintenance_mode}} - Returns true if agent is in maintenance mode</li> <li>{{agent.block_policy_inheritance}} - Returns true if agent has block policy inheritance</li> <li>{{agent.alert_template} - Returns true if agent has block policy inheritance</li> </ul>"},{"location":"script_variables/#client","title":"Client","text":"<ul> <li>{{client.name}} - Returns name of client</li> </ul>"},{"location":"script_variables/#site","title":"Site","text":"<ul> <li>{{site.name}} - Returns name of Site</li> </ul>"},{"location":"script_variables/#alert","title":"Alert","text":"<p>Info</p> <p>Only available in failure and resolve actions on alert templates!</p> <ul> <li>{{alert.alert_time}} - Time of the alert</li> <li>{{alert.message}} - Alert message</li> <li>{{alert.severity}} - Severity of the alert info, warning, or error</li> </ul>"},{"location":"securing_nginx/","title":"DISCLAIMER","text":"<p>All the settings covered in this document have been tested against Tactical RMM v0.7.2 and v0.8.0.</p> <p>Before applying these settings in production, use a pre-production environment so potential disruptions in your own environment and the service that you provide to your clients can be avoided.</p> <p>Warning</p> <pre><code>**&lt;span style=\"text-decoration:underline;\"&gt;Use the contents included in this guide and apply the security settings detailed here at your own discretion.&lt;/span&gt;**\n</code></pre>"},{"location":"securing_nginx/#intro","title":"Intro","text":"<p>This section is structured in three main subsections:</p> <ul> <li>Enabling GeoIP in NGINX config with the purpose of filtering (blocking) web requests based on the country\u2019s source IP.</li> <li>Enabling anti \u201cbad\u201d bots/referrers in HTTP requests to the NGINX server.</li> <li>Compiling and enabling ModSec + OWASP CRS in NGINX server.</li> </ul> <p>Each section can be enabled independently.</p>"},{"location":"securing_nginx/#hardening-nginx-settings","title":"Hardening NGINX settings","text":""},{"location":"securing_nginx/#geoip-integration-in-nginx-blocking-requests-by-country-code","title":"GeoIP Integration in NGINX - Blocking Requests by Country Code","text":"<p>Install required packages and NGINX module for GeoIP:</p> <pre><code># apt-get install geoip-database libgeoip1 libnginx-mod-http-geoip\n</code></pre> <p>Verify that the GeoIP database files have been placed in the right location:</p> <pre><code># ls -lrt /usr/share/GeoIP/\ntotal 10004\n-rw-r--r-- 1 root root 8138841 Jan 24  2020 GeoIPv6.dat\n-rw-r--r-- 1 root root 2099217 Jan 24  2020 GeoIP.dat\n</code></pre> <p>Edit NGINX config file (\u201c/etc/nginx/nginx.conf\u201d) and add the following config under the \u201chttp {\u201c block:</p> <pre><code>http {\n\n        ##\n        # Basic Settings\n        ##\n        # Load GeoIP Database\n        geoip_country /usr/share/GeoIP/GeoIP.dat;\n</code></pre> <p>The next settings will depend on the desired GeoIP blocking strategy. For \u201callow by default, deny by exception\u201d, the config would be:</p> <pre><code>http {\n\n        ##\n        # Basic Settings\n        ##\n        # Load GeoIP Database\n        geoip_country /usr/share/GeoIP/GeoIP.dat;\n        # map the list of denied countries\n        map $geoip_country_code $allowed_country {\n        default yes;\n        # BLOCKED_COUNTRY_1\n        COUNTRY_CODE_1 no;\n        # BLOCKED_COUNTRY_2\n        COUNTRY_CODE_2 no;\n        # BLOCKED_COUNTRY_3\n        COUNTRY_CODE_3 no;\n        }\n</code></pre> <p>(The macro can be modified to achieve the \u201cdeny by default, allow by exception\u201d approach).</p> <p>Finally, the following \u201cif\u201d statement needs to be placed in all the vhosts where the GeoIP blocking should take effect, under the \u201clocation\u201d section:</p> <pre><code>   location / {\n        root /var/www/rmm/dist;\n        try_files $uri $uri/ /index.html;\n        add_header Cache-Control \"no-store, no-cache, must-revalidate\";\n        add_header Pragma \"no-cache\";\n        # block the country\n        if ($allowed_country = no) {\n         return 444;\n        }\n    }\n</code></pre> <p>The HTTP Status = 444 is a good choice for NGINX not \u201cwasting\u201d too many resources in sending back the 4xx code to the client being blocked by GeoIP.</p>"},{"location":"securing_nginx/#blocking-bad-bots-and-bad-referrers","title":"Blocking \u201cbad bots\u201d and \u201cbad referrers\u201d","text":"<p>Nginx Bad Bot and User-Agent Blocker, Spam Referrer Blocker, Anti DDOS, Bad IP Blocker and Wordpress Theme Detector Blocker</p> <p>Source:</p> <p>https://github.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker</p> <p>Download \u201cinstall-ngxblocker\u201d to your /usr/local/sbin/directory and make the script executable.</p> <pre><code>sudo wget https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master/install-ngxblocker -O /usr/local/sbin/install-ngxblocker\nsudo chmod +x /usr/local/sbin/install-ngxblocker\n</code></pre> <p>(OPTIONAL)Now run the \u201dinstall-ngxblocker\u201d script in DRY-MODE which will show you what changes it will make and what files it will download for you. This is only a DRY-RUN so no changes are being made yet.</p> <p>The install-ngxblocker downloads all required files including the setup and update scripts.</p> <pre><code>cd /usr/local/sbin\nsudo ./install-ngxblocker\n</code></pre> <p>This will show you output as follows of the changes that will be made (NOTE: this is only a DRY-RUN no changes have been made)</p> <pre><code>Checking url: https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master/include_filelist.txt\n** Dry Run ** | not updating files | run  as 'install-ngxblocker -x' to install files.\nCreating directory: /etc/nginx/bots.d\nREPO = https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master\nDownloading [FROM]=&gt;  [REPO]/conf.d/globalblacklist.conf            [TO]=&gt;  /etc/nginx/conf.d/globalblacklist.conf\nDownloading [FROM]=&gt;  [REPO]/conf.d/botblocker-nginx-settings.conf  [TO]=&gt;  /etc/nginx/conf.d/botblocker-nginx-settings.conf\nREPO = https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master\nDownloading [FROM]=&gt;  [REPO]/bots.d/blockbots.conf              [TO]=&gt;  /etc/nginx/bots.d/blockbots.conf\nDownloading [FROM]=&gt;  [REPO]/bots.d/ddos.conf                   [TO]=&gt;  /etc/nginx/bots.d/ddos.conf\nDownloading [FROM]=&gt;  [REPO]/bots.d/whitelist-ips.conf          [TO]=&gt;  /etc/nginx/bots.d/whitelist-ips.conf\nDownloading [FROM]=&gt;  [REPO]/bots.d/whitelist-domains.conf      [TO]=&gt;  /etc/nginx/bots.d/whitelist-domains.conf\nDownloading [FROM]=&gt;  [REPO]/bots.d/blacklist-user-agents.conf  [TO]=&gt;  /etc/nginx/bots.d/blacklist-user-agents.conf\nDownloading [FROM]=&gt;  [REPO]/bots.d/blacklist-ips.conf          [TO]=&gt;  /etc/nginx/bots.d/blacklist-ips.conf\nDownloading [FROM]=&gt;  [REPO]/bots.d/bad-referrer-words.conf     [TO]=&gt;  /etc/nginx/bots.d/bad-referrer-words.conf\nDownloading [FROM]=&gt;  [REPO]/bots.d/custom-bad-referrers.conf   [TO]=&gt;  /etc/nginx/bots.d/custom-bad-referrers.conf\nREPO = https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master\nDownloading [FROM]=&gt;  [REPO]/setup-ngxblocker      [TO]=&gt;  /usr/local/sbin/setup-ngxblocker\nDownloading [FROM]=&gt;  [REPO]/update-ngxblocker     [TO]=&gt;  /usr/local/sbin/update-ngxblocker\n</code></pre> <p>Now run the install script with the -x parameter to download all the necessary files from the repository:</p> <pre><code>cd /usr/local/sbin/\nsudo ./install-ngxblocker -x\n</code></pre> <p>This will give you the following output:</p> <pre><code>Checking url: https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master/include_filelist.txt\nCreating directory: /etc/nginx/bots.d\nREPO = https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master\nDownloading [FROM]=&gt;  [REPO]/conf.d/globalblacklist.conf            [TO]=&gt;  /etc/nginx/conf.d/globalblacklist.conf...OK\nDownloading [FROM]=&gt;  [REPO]/conf.d/botblocker-nginx-settings.conf  [TO]=&gt;  /etc/nginx/conf.d/botblocker-nginx-settings.conf...OK\nREPO = https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master\nDownloading [FROM]=&gt;  [REPO]/bots.d/blockbots.conf              [TO]=&gt;  /etc/nginx/bots.d/blockbots.conf...OK\nDownloading [FROM]=&gt;  [REPO]/bots.d/ddos.conf                   [TO]=&gt;  /etc/nginx/bots.d/ddos.conf...OK\nDownloading [FROM]=&gt;  [REPO]/bots.d/whitelist-ips.conf          [TO]=&gt;  /etc/nginx/bots.d/whitelist-ips.conf...OK\nDownloading [FROM]=&gt;  [REPO]/bots.d/whitelist-domains.conf      [TO]=&gt;  /etc/nginx/bots.d/whitelist-domains.conf...OK\nDownloading [FROM]=&gt;  [REPO]/bots.d/blacklist-user-agents.conf  [TO]=&gt;  /etc/nginx/bots.d/blacklist-user-agents.conf...OK\nDownloading [FROM]=&gt;  [REPO]/bots.d/blacklist-ips.conf          [TO]=&gt;  /etc/nginx/bots.d/blacklist-ips.conf...OK\nDownloading [FROM]=&gt;  [REPO]/bots.d/bad-referrer-words.conf     [TO]=&gt;  /etc/nginx/bots.d/bad-referrer-words.conf...OK\nDownloading [FROM]=&gt;  [REPO]/bots.d/custom-bad-referrers.conf   [TO]=&gt;  /etc/nginx/bots.d/custom-bad-referrers.conf...OK\nREPO = https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master\nDownloading [FROM]=&gt;  [REPO]/setup-ngxblocker      [TO]=&gt;  /usr/local/sbin/setup-ngxblocker...OK\nDownloading [FROM]=&gt;  [REPO]/update-ngxblocker     [TO]=&gt;  /usr/local/sbin/update-ngxblocker...OK\n</code></pre> <p>All the required files have now been downloaded to the correct folders on Nginx for you direct from the repository.</p> <p>NOTE: The setup and update scripts can be used, however in this guide the config is done manually. For script execution, refer to the Github page linked above.</p> <p>Include any public IP addresses that should be whitelisted from bot and referrer analysis/blocking by editing the file \u201c/etc/nginx/bots.d/whitelist-ips.conf\u201d.</p> <p>Finally, edit every vhost file (\u201c/etc/nginx/sites-enabled/frontend.conf\u201d, \u201c/etc/nginx/sites-enabled/rmm.conf\u201d and \u201c/etc/nginx/sites-enabled/meshcentral.conf\u201d) and place the following include statements under the \u201cserver\u201d block:</p> <pre><code>server {\n    listen 443 ssl;\n    include /etc/nginx/bots.d/ddos.conf;\n    include /etc/nginx/bots.d/blockbots.conf;\n</code></pre>"},{"location":"securing_nginx/#enabling-modsec-in-nginx","title":"Enabling ModSec in NGINX","text":"<p>All steps in this section taken from the NGINX blog post \u201cCompiling and Installing ModSecurity for NGINX Open Source\u201d:</p> <p>https://www.nginx.com/blog/compiling-and-installing-modsecurity-for-open-source-nginx/</p>"},{"location":"securing_nginx/#install-prerequisite-packages","title":"Install Prerequisite Packages","text":"<p>The first step is to install the packages required to complete the remaining steps in this tutorial. Run the following command, which is appropriate for a freshly installed Ubuntu/Debian system. The required packages might be different for RHEL/CentOS/Oracle Linux.</p> <pre><code>apt-get install -y apt-utils autoconf automake build-essential git libcurl4-openssl-dev libgeoip-dev liblmdb-dev libpcre++-dev libtool libxml2-dev libyajl-dev pkgconf wget zlib1g-dev\n</code></pre>"},{"location":"securing_nginx/#download-and-compile-the-modsecurity-30-source-code","title":"Download and Compile the ModSecurity 3.0 Source Code","text":"<p>With the required prerequisite packages installed, the next step is to compile ModSecurity as an NGINX dynamic module. In ModSecurity 3.0\u2019s new modular architecture, libmodsecurity is the core component which includes all rules and functionality. The second main component in the architecture is a connector that links libmodsecurity to the web server it is running with. There are separate connectors for NGINX, Apache HTTP Server, and IIS. We cover the NGINX connector in the next section.</p> <p>To compile libmodsecurity:</p> <p>Clone the GitHub repository:</p> <pre><code>git clone --depth 1 -b v3/master --single-branch https://github.com/SpiderLabs/ModSecurity\n</code></pre> <p>Change to the ModSecurity directory and compile the source code:</p> <pre><code>cd ModSecurity\ngit submodule init\ngit submodule update\n./build.sh\n./configure\nmake\nmake install\ncd ..\n</code></pre> <p>The compilation takes about 15 minutes, depending on the processing power of your system.</p> <p>Note: It\u2019s safe to ignore messages like the following during the build process. Even when they appear, the compilation completes and creates a working object.</p> <pre><code>fatal: No names found, cannot describe anything.\n</code></pre>"},{"location":"securing_nginx/#download-the-nginx-connector-for-modsecurity-and-compile-it-as-a-dynamic-module","title":"Download the NGINX Connector for ModSecurity and Compile It as a Dynamic Module","text":"<p>Compile the ModSecurity connector for NGINX as a dynamic module for NGINX.</p> <p>Clone the GitHub repository:</p> <pre><code>git clone --depth 1 https://github.com/SpiderLabs/ModSecurity-nginx.git\n</code></pre> <p>Determine which version of NGINX is running on the host where the ModSecurity module will be loaded:</p> <pre><code>$ nginx -v\nnginx version: nginx/1.18.0 (Ubuntu)\n</code></pre> <p>Download the source code corresponding to the installed version of NGINX (the complete sources are required even though only the dynamic module is being compiled):</p> <pre><code>wget http://nginx.org/download/nginx-1.18.0.tar.gz\ntar zxvf nginx-1.18.0.tar.gz\n</code></pre> <p>Compile the dynamic module and copy it to the standard directory for modules:</p> <pre><code>cd nginx-1.18.0\n./configure --with-compat --add-dynamic-module=../ModSecurity-nginx\nmake modules\ncp objs/ngx_http_modsecurity_module.so /etc/nginx/modules\ncp objs/ngx_http_modsecurity_module.so /usr/share/nginx/modules/\ncd ..\n</code></pre>"},{"location":"securing_nginx/#load-the-nginx-modsecurity-connector-dynamic-module","title":"Load the NGINX ModSecurity Connector Dynamic Module","text":"<p>Add the following load_module directive to the main (top\u2011level) context in /etc/nginx/nginx.conf. It instructs NGINX to load the ModSecurity dynamic module when it processes the configuration:</p> <pre><code>load_module modules/ngx_http_modsecurity_module.so;\n</code></pre>"},{"location":"securing_nginx/#configure-and-enable-modsecurity","title":"Configure and Enable ModSecurity","text":"<p>The final step is to enable and test ModSecurity.</p> <p>Set up the appropriate ModSecurity configuration file. Here we\u2019re using the recommended ModSecurity configuration provided by TrustWave Spiderlabs, the corporate sponsors of ModSecurity.</p> <pre><code>mkdir /etc/nginx/modsec\nwget -P /etc/nginx/modsec/ https://raw.githubusercontent.com/SpiderLabs/ModSecurity/v3/master/modsecurity.conf-recommended\nmv /etc/nginx/modsec/modsecurity.conf-recommended /etc/nginx/modsec/modsecurity.conf\n</code></pre> <p>To guarantee that ModSecurity can find the unicode.mapping file (distributed in the top\u2011level ModSecurity directory of the GitHub repo), copy it to /etc/nginx/modsec.</p> <pre><code>cp ModSecurity/unicode.mapping /etc/nginx/modsec\n</code></pre> <p>Change the SecRuleEngine directive in the configuration to change from the default \u201cdetection only\u201d mode to actively dropping malicious traffic.</p> <pre><code>#SecRuleEngine DetectionOnly\nSecRuleEngine On\n</code></pre>"},{"location":"securing_nginx/#enabling-owasp-core-rule-set","title":"Enabling OWASP Core Rule Set","text":"<p>Clone OWASP CRS:</p> <pre><code>cd /etc/nginx/modsec\ngit clone https://github.com/coreruleset/coreruleset.git\n</code></pre> <p>Create CRS setup config file:</p> <pre><code>cp /etc/nginx/modsec/coreruleset/crs-setup.conf.example /etc/nginx/modsec/coreruleset/crs-setup.conf\n</code></pre> <p>Edit config file and enable a paranoia level of 2 (comment out section below and modify the paranoia level from 1 - default to 2):</p> <pre><code>SecAction \\\n  \"id:900000,\\\n   phase:1,\\\n   nolog,\\\n   pass,\\\n   t:none,\\\n   setvar:tx.paranoia_level=2\"\n</code></pre> <p>A Paranoia level of 2 is a good combination of security rules to load by the ModSec engine while keeping low the number of false positives.</p> <p>The OWASP CRS team carried out some tests using BURP against ModSec + OWASP CRS:</p> <p></p> <p>Create ModSecurity base config file (\u201c/etc/nginx/modsec/modsec-base-cfg.conf\u201d) and include the following lines (the order is important)<code>:</code></p> <pre><code>Include /etc/nginx/modsec/modsecurity.conf\nInclude /etc/nginx/modsec/coreruleset/crs-setup.conf\nInclude /etc/nginx/modsec/coreruleset/rules/*.conf\n</code></pre> <p>Enable ModSec in all NGINX enabled sites:</p> <p>\u201c/etc/nginx/sites-enabled/frontend.conf\u201d, \u201c/etc/nginx/sites-enabled/rmm.conf\u201d and \u201c/etc/nginx/sites-enabled/meshcentral.conf\u201d:</p> <pre><code>server {\n    modsecurity on;\n    modsecurity_rules_file /etc/nginx/modsec/modsec-base-cfg.conf;\n\n\u2026\u2026\u2026\u2026\u2026\u2026\u2026..\n\u2026\u2026\u2026\u2026\u2026\u2026\u2026..\n</code></pre> <p>Tactical RMM custom rules:</p> <ul> <li>Access to the admin UI (front-end): We apply the \u201cdeny by default, allow by exception\u201d principle, whereby only a set of predefined public IPs should be allowed to access the UI</li> <li>API and Meshcentral: RMM agents and RMM UI (as referrer while an admin session is active) make web calls that get blocked by the OWASP CRS, specifically PUT, POST and PATCH methods. These three methods can be \u201cwhitelisted\u201d when the requested URI matches legitimate requests.</li> <li>Connection to Meshcentral during Tactical agent install.</li> </ul> <p>Create a .conf file under \u201c/etc/nginx/modsec/coreruleset/rules\u201d named \u201cRMM-RULES.conf\u201d, for example, with the following content:</p> <pre><code>#ADMIN UI/FRONTEND ACCESS - DENY BY DEFAULT, ALLOW BY EXCEPTION\nSecRule SERVER_NAME \"rmm.EXAMPLE.COM\" \"id:1001,phase:1,nolog,msg:'Remote IP Not allowed',deny,chain\"\n###  ALLOWED PUBLIC IP 1 #########\nSecRule REMOTE_ADDR \"!@eq IP1\" chain\n###  ALLOWED PUBLIC IP 2 #########\nSecRule REMOTE_ADDR \"!@eq IP2\" \"t:none\"\n\n#API AND MESHCENTRAL - WHITELIST PUT, PATCH AND POST METHODS BY REQUESTED URI\nSecRule REQUEST_URI \"@beginsWith /api/v3/checkin\" \"id:1002,phase:1,t:none,nolog,allow,chain\"\nSecRule REQUEST_METHOD \"PUT|PATCH\" \"t:none\"\nSecRule REQUEST_URI \"@beginsWith /api/v3/checkrunner\" \"chain,id:'1003',phase:1,t:none,nolog,allow\"\nSecRule REQUEST_METHOD \"PATCH\" \"t:none\"\nSecRule REQUEST_URI \"@beginsWith /alerts/alerts\" \"chain,id:'1004',phase:1,t:none,nolog,allow\"\nSecRule REQUEST_METHOD \"PATCH\" \"t:none\"\nSecRule REQUEST_URI \"@beginsWith /agents/listagents\" \"chain,id:'1005',phase:1,t:none,nolog,allow\"\nSecRule REQUEST_METHOD \"PATCH\" \"t:none\"\nSecRule REQUEST_URI \"@beginsWith /api/v3/sysinfo\" \"chain,id:'1006',phase:1,t:none,nolog,allow\"\nSecRule REQUEST_METHOD \"PATCH\" \"t:none\"\nSecRule REQUEST_URI \"@beginsWith /api/v3/winupdates\" \"chain,id:'1007',phase:1,t:none,nolog,allow\"\nSecRule REQUEST_METHOD \"POST\"\n\n##REQUIRED FOR MANAGEMENT ACTIONS FROM ADMIN/FRONT-END UI. WHITELIST BY REFERRER's URL\nSecRule REQUEST_HEADERS:REFERER \"https://rmm.EXAMPLE.COM/\" \"id:1008,phase:1,nolog,ctl:ruleRemoveById=920170,allow\"\n\n#REQUIRED FOR NEW CLIENTS TO CONNECT TO MESH SERVICE WHILE INSTALLING THE AGENT\nSecRule REQUEST_URI \"@beginsWith /api/v3/meshexe\" \"id:1009,phase:1,nolog,ctl:ruleRemoveById=920170,allow\"\n\n###  NOTE ON RULE ID = 920170 (WHITELISTED IN CASES ABOVE FOR TACTICAL RMM) ###\n# Do not accept GET or HEAD requests with bodies\n# HTTP standard allows GET requests to have a body but this\n# feature is not used in real life. Attackers could try to force\n# a request body on an unsuspecting web applications.\n#\n# -=[ Rule Logic ]=-\n# This is a chained rule that first checks the Request Method.  If it is a\n# GET or HEAD method, then it checks for the existence of a Content-Length\n# header.  If the header exists and its payload is either not a 0 digit or not\n# empty, then it will match.\n#\n# -=[ References ]=-\n# http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.3\n###\n</code></pre>"},{"location":"security/","title":"Security","text":"<p>If you think that you have found a security vulnerability in Tactical RMM, please disclose it to us via our security e-mail address at security@amidaware.com</p> <p>Please do not make vulnerabilities public without notifying us and giving us at least 3 days to respond.</p> <p>If you are going to write about Tactical RMM's security, please get in touch, so we can make sure that all claims are correct.</p>"},{"location":"sponsor/","title":"Sponsor Tactical RMM","text":"<p>Tactical RMM is an MIT-licensed open-source project maintained by @wh1te909, @sadnub and a community of open source contributors. We work on behalf of the community to create new features, fix bugs, and maintain Tactical RMM.</p> <p>Tactical RMM is currently the only open-source RMM available on the market. Responses from a recent survey have rated Tactical RMM as having the fastest and most reliable remote command and script execution compared to all other commercial RMM's. Sponsorships help keep this project alive and motivate the developers to continue to put in more time and effort into the advancement of Tactical RMM. Thousands of hours have been put in to developing, maintaining, improving, and supporting Tactical RMM. Your sponsorship would be greatly appreciated and helpful to keep this project going.</p> <p>Funds donated will be used to setup a company to purchase a code signing certificate to sign all executables that are used by the RMM, costs needed to maintain demo and documentation sites, to support development of new features and the Linux and Mac agents.</p> <p>If you have signed up to be a sponsor and have not been added to the Sponsors role on discord after a few hours, or if your github username is different than your discord username, please DM wh1te909 on Discord after sponsoring to be added to the Sponsors role.</p> <p>We are always looking for feedback and ways to improve Tactical RMM to better address your needs. Please feel free to open a github issue or drop us a message on Discord with your feedback or requests.</p> <p>Sponsor with Github</p> <p>Sponsor with Ko-fi</p>"},{"location":"tidbits/","title":"Misc info","text":""},{"location":"tidbits/#run-intervals-for-checks","title":"Run Intervals for Checks","text":"<p>You can modify at several locations/levels:</p> <ul> <li>Settings Menu &gt; Automation Manager &gt; Checks tab &gt; Edit check</li> <li>Agent Level: Edit Agent &gt; Run checks every</li> <li>Edit Check under agent &gt; Run this check every (seconds)</li> </ul> <p>Note</p> <p>The interval under check will override agent check if set</p>"},{"location":"tipsntricks/","title":"Tips and Tricks","text":""},{"location":"tipsntricks/#server-monitoring","title":"Server Monitoring","text":"<p>Monitor Network usage: https://humdi.net/vnstat/</p> <p>Realtime Everything Usage: (only run when needed because it uses a lot of resources): https://learn.netdata.cloud/docs/agent/packaging/installer/methods/kickstart</p>"},{"location":"tipsntricks/#customize-user-interface","title":"Customize User Interface","text":"<p>At the top right of your web administration interface, click your Username &gt; preferences. Set default tab: Servers|Workstations|Mixed</p> <p></p>"},{"location":"tipsntricks/#use-the-filters-in-the-agent-list","title":"Use the filters in the agent list","text":""},{"location":"tipsntricks/#meshcentral","title":"MeshCentral","text":"<p>Tactical RMM is actually 2 products: An RMM service with agent, and a secondary MeshCentral install that handles the <code>Take Control</code> and <code>Remote Background</code> stuff.</p> <p>Want to download multiple files?</p> <p>ZIP zip's the currently selected file(s) and saves it in the current directory. Then you can download the ZIP. It doesn't download and ZIP on the fly.</p>"},{"location":"tipsntricks/#adjust-settings","title":"Adjust Settings","text":"<p>Right-click the connect button in Remote Background | Terminal for shell options</p> <p></p> <p>Right-click the connect button in Take Control for connect options</p> <p></p>"},{"location":"tipsntricks/#enable-remote-control-options","title":"Enable Remote Control options","text":"<p>Note</p> <p>These settings are independent of Tactical RMM. Enable features (like auto remove inactive devices) with caution</p> <ol> <li>Remote background a machine then go to mesh.EXAMPLE.COM</li> <li>Click on My Account</li> <li>Click on the device group you want to enable notifications or accept connection etc on (probably TacticalRMM)</li> <li>Next to User Consent click edit (the wee pencil) </li> <li>You can also change features by ticking whatever boxes you want in there (Features: Sync server device name to hostname, Automatically remove inactive devices, Notify/Prompt for Consent/Connection Toolbar settings) </li> <li>Ok your way out</li> </ol>"},{"location":"tipsntricks/#agent-onlineoffline-logs","title":"Agent online/offline logs","text":"<p>In mesh from the agent | General Tab</p> <p></p>"},{"location":"tipsntricks/#scripts","title":"Scripts","text":""},{"location":"tipsntricks/#when-running-scripts","title":"When Running Scripts","text":"<p>Use the (i) at the end of the script name to:</p> <ul> <li>Hover: see script parameter syntax help</li> <li>Left Click: Opens the script source in Github</li> </ul> <p></p>"},{"location":"troubleshooting/","title":"Troubleshooting","text":""},{"location":"troubleshooting/#server-troubleshooting-script","title":"Server Troubleshooting Script","text":"<p>If you've asked for help in #support please run this, and send a screenshot at the top of the thread created for troubleshooting your issue.</p> <p>Blur your domains if you desire privacy.</p> <pre><code>wget -N https://raw.githubusercontent.com/wh1te909/tacticalrmm/master/troubleshoot_server.sh\nchmod +x troubleshoot_server.sh\n./troubleshoot_server.sh\n</code></pre>"},{"location":"troubleshooting/#make-sure-dns-name-resolution-was-setup-properly","title":"Make sure DNS (name resolution) was setup properly","text":""},{"location":"troubleshooting/#from-the-agent","title":"From the agent","text":"<p>Open command prompt</p> <pre><code>ping rmm.example.com\nping api.example.com\nping mesh.example.com\n</code></pre> <p>The IP address for all 3 should reflect your Tactical RMM server</p>"},{"location":"troubleshooting/#problems-after-new-server-install","title":"Problems after new server install","text":"<p>In the very unlikely event you have issues after install please wipe the box and install again (following all the steps including downloading the install script but not running it yet) use the following command which will log the install progress and if you continue to have issues will assist with support of the installation.</p> <pre><code>bash -x install.sh 2&gt;&amp;1 | tee install.log\n</code></pre> <p>Note</p> <p>Logging of installs isn\u2019t desirable as it logs extremely sensitive information which is why this isn\u2019t done by default! Do not post the raw log publicly only provide it if requested and then by dm only. Authorized users in Discord are: @BurningTimes#1938 @sadnub#6992 @dinger1986#1734 @silversword#9652</p>"},{"location":"troubleshooting/#bad-credentials-error-when-trying-to-login-to-the-web-ui","title":"\"Bad credentials\" error when trying to login to the Web UI","text":"<p>If you are sure you are using the correct credentials and still getting a \"bad credentials\" error, open your browser's dev tools (ctrl + shift + j on chrome) and check the Console tab to see the real error.</p> <p>It will most probably be a CORS error which means you need to check your DNS settings and make sure whatever computer you're trying to access the UI from resolves your 3 subdomains to the correct IP of the server running the RMM (public IP if running in the cloud, or private IP if running behind NAT).</p> <p>If you see an error about SSL or certificate expired, then your Let's Encrypt cert has probably expired and you'll need to renew it.</p> <p>Refer to the Let's Encrypt cert renewal instructions here</p>"},{"location":"troubleshooting/#agents-not-installing-or-updating","title":"Agents not installing or updating","text":"<p>The most common problem we've seen of agents not installing or updating is due to Antivirus blocking the updater executable.</p> <p>Windows Defender will 100% of the time block the updater from running unless an exclusion is set.</p> <p>Refer to the Agent Installation instructions for AV exceptions to set and manually doing an agent update with logging to troubleshoot further.</p> <p>Agents will also not automatically update if they are too old.</p> <p>Since Tactical RMM is still in alpha and the developers makes breaking changes pretty frequently, there is no promise of backwards compatibility.</p> <p>If you have agents that are relatively old, you will need to uninstall them manually and reinstall using the latest version.</p>"},{"location":"troubleshooting/#agents-not-checking-in-or-showing-up-general-agent-issues","title":"Agents not checking in or showing up / General agent issues","text":"<p>These are nats problems. Try quickfix first:</p>"},{"location":"troubleshooting/#from-admin-web-interface","title":"from Admin Web Interface","text":"<p>First, reload NATS from tactical's web UI: Tools &gt; Server Maintenance &gt; Reload Nats Configuration</p> <p>If that doesn't work, check each part starting with the server:</p>"},{"location":"troubleshooting/#server-ssh-login","title":"Server SSH login","text":"<p>Reload NATS:</p> <pre><code>/rmm/api/env/bin/python /rmm/api/tacticalrmm/manage.py reload_nats\nsudo systemctl restart nats\n</code></pre> <p>Look at nats service errors (make sure it's running)</p> <pre><code>sudo systemctl status nats\n</code></pre> <p>If nats isn't running see detailed reason why it isn't:</p> <pre><code>sudo systemctl stop nats\nnats-server -DVV -c /rmm/api/tacticalrmm/nats-rmm.conf\n</code></pre> <p>Fix the problem, then restart nats. <pre><code>sudo systemctl restart nats\n</code></pre></p>"},{"location":"troubleshooting/#from-agent-install","title":"From Agent Install","text":"<p>Open CMD as admin on the problem computer and stop the agent services:</p> <pre><code>net stop tacticalagent\nnet stop tacticalrpc\n</code></pre> <p>Run the tacticalagent service manually with debug logging:</p> <pre><code>\"C:\\Program Files\\TacticalAgent\\tacticalrmm.exe\" -m winagentsvc -log debug -logto stdout\n</code></pre> <p>Run the tacticalrpc service manually with debug logging:</p> <pre><code>\"C:\\Program Files\\TacticalAgent\\tacticalrmm.exe\" -m rpc -log debug -logto stdout\n</code></pre> <p>This will print out a ton of info. You should be able to see the error from the debug log output.</p> <p>Please then copy/paste the logs and post them either in our Discord support chat, or create a github issue.</p> <p>If all else fails, simply uninstall the agent either from control panel or silently with <code>\"C:\\Program Files\\TacticalAgent\\unins000.exe\" /VERYSILENT</code> and then reinstall the agent.</p>"},{"location":"troubleshooting/#all-other-errors","title":"All other errors","text":"<p>First, run the update script with the <code>--force</code> flag.</p> <p>This will fix permissions and reinstall python/node packages that might have gotten corrupted.</p> <pre><code>./update.sh --force\n</code></pre> <p>Check the debug log from the web UI: File &gt; Debug Log</p> <p>Open your browser's dev tools (ctrl + shift + j on chrome) and check the Console tab for any errors</p> <p>Check all the systemd services that the rmm uses to function and check to make sure they're all active/running and enabled:</p> <pre><code>sudo systemctl status rmm\nsudo systemctl status daphne\nsudo systemctl status celery\nsudo systemctl status celerybeat\nsudo systemctl status nginx\nsudo systemctl status nats\nsudo systemctl status nats-api\nsudo systemctl status meshcentral\nsudo systemctl status mongod\nsudo systemctl status postgresql\nsudo systemctl status redis\n</code></pre> <p>Read through the log files in the following folders and check for errors:</p> <pre><code>/rmm/api/tacticalrmm/tacticalrmm/private/log\n/var/log/celery\n</code></pre>"},{"location":"troubleshooting/#using-cloudflare-dns","title":"Using Cloudflare DNS","text":"<ul> <li> <p>rmm.example.com can be proxied.</p> </li> <li> <p>api.example.com can NOT be proxied.</p> </li> <li> <p>mesh.example.com can be proxied with the caveat that Mesh checks the cert presented to the agent is the same one on the server. I.e. no MITM. You'll need to copy Cloudflare's edge cert to your server if you want to proxy this domain.</p> </li> </ul>"},{"location":"troubleshooting/#testing-network-connectivity-between-agent-and-server","title":"Testing Network Connectivity between agent and server","text":"<p>Use powershell, make sure you can connect to 443 and 4222 from agent to server:</p> <pre><code>Test-NetConnection -ComputerName api.example.com -Port 4222\n</code></pre> <pre><code>Test-NetConnection -ComputerName api.example.com -Port 443\n</code></pre> <pre><code>Test-NetConnection -ComputerName rmm.example.com -Port 443\n</code></pre> <p>Are you trying to use a proxy to share your single public IP with multiple services on 443? This is complicated and unsupported by Tactical RMM, test your setup.</p>"},{"location":"troubleshooting/#mesh-agent-x86-x64-integration-with-trmm","title":"Mesh Agent x86 x64 integration with TRMM","text":"<ol> <li>Log into Mesh (you can right-click any agent, choose remote control or Remote Background)</li> <li>Goto your mesh interface (eg <code>https://mesh.EXAMPLE.COM</code>) </li> <li>Find your TacticalRMM group</li> <li>Click the add link</li> <li>Download both agents</li> <li>In Tactical RMM, go Settings &gt; Global Settings &gt; MeshCentral &gt; Upload Mesh Agents upload them both into the appropriate places.</li> </ol>"},{"location":"troubleshooting/#need-to-recover-your-mesh-token","title":"Need to recover your mesh token?","text":"<p>Login to server with SSH and run:</p> <pre><code>node /meshcentral/node_modules/meshcentral --logintokenkey\n</code></pre>"},{"location":"troubleshooting/#mesh-agent-not-connecting-to-server","title":"Mesh Agent Not Connecting to server","text":"<p>When agents don't show up in your mesh console (after logging into https://mesh.EXAMPLE.COM), and all data is blank. Your AV has most likely blocked the agent.</p> <p></p>"},{"location":"unsupported_guidelines/","title":"Unsupported Guidelines","text":""},{"location":"unsupported_guidelines/#general-information","title":"General Information","text":"<p>Tactical RMM is designed to be secure by default.</p> <p>You CAN expose it to the internet, and start deploying agents.</p> <p>You CAN not expose it to the internet, and start deploying agents.</p>"},{"location":"unsupported_guidelines/#period","title":"Period","text":"<p>Info</p> <pre><code>BIG PERIOD **.** &lt;--- See, it's really really big \ud83d\ude42\n</code></pre>"},{"location":"unsupported_guidelines/#that-said","title":"That said","text":"<p>There are those that wish to add layers to their security onion. For the benefit of others following in their footsteps, we have added here for your convenience additional information on a range of subjects and technologies that have been graciously donated to us by the community at large.</p> <p>Please be aware that those providing help and assistance in the Discord #support channel will generally assume that you are not one of these wizards of networking magic.</p> <p>Should you employ any one or several of these unsupported technologies:</p> <ul> <li>Proxies</li> <li>Firewalls</li> <li>GeoIP filters</li> <li>fail2ban filters</li> <li>alternate methods of SSL cert management</li> <li>IDSs</li> <li>IPSs</li> <li>SDNs</li> <li>Did anything other than follow the installation instructions exactly</li> <li>and any/all other magical ABC thru XYZ technologies</li> </ul> <p>Please let us know BEFORE we start troubleshooting and looking for software bugs that you are...in fact...a \ud83e\uddd9...and using something non-standard \ud83d\ude09 </p> <p>These are \"unsupported\" because then we are troubleshooting your environment, not Tactical RMM. You need to have knowledge about how things work if you're going to stray from the easy path of the standard install. </p> <p>Help us maximize keeping developer time and resources focused on new releases...not support goosechases.</p> <p>Thank you and #KeepDeploying</p>"},{"location":"unsupported_scripts/","title":"Unsupported Reference Scripts","text":"<p>Note</p> <p>These are not supported scripts/configurations by Tactical RMM, but it's provided here for your reference.</p> <p>Although these aren't officially supported configurations, we generally will help point you in the right direction. Please use the Discord #unsupported channel to discuss issues replated to these complex installations</p>"},{"location":"unsupported_scripts/#general-notes-on-proxies-and-tactical-rmm","title":"General Notes on Proxies and Tactical RMM","text":""},{"location":"unsupported_scripts/#port-443","title":"Port 443","text":"<p>Make sure websockets option is enabled.</p> <p>All 3 URL's will need to be configured: <code>rmm</code>, <code>api</code>, <code>mesh</code></p> <p>For <code>mesh</code> see the Section 10. TLS Offloading of the MeshCentral 2 User Guide</p>"},{"location":"unsupported_scripts/#port-4222","title":"Port 4222","text":"<p>Is NATS (https://nats.io). You'll need a TCP forwarder as NATS only talks TCP not HTTP.</p>"},{"location":"unsupported_scripts/#traefikv2","title":"Traefikv2","text":"<p>Offsite Resource: https://gitlab.com/NiceGuyIT/tactical-goodies/-/tree/main/traefik</p> <p>This section will assume that by default Traefik will reverse proxy everything on port 443.</p> <p>Here is a basic Traefik config with docker-composer note the file.directory and file.watch are important. <pre><code>version: \"3.7\"\nservices:\n  traefik:\n    container_name: traefik24\n    image: traefik:v2.4 \n    restart: unless-stopped\n    command:\n      - --entryPoints.http.address=:80\n      - --entryPoints.https.address=:443\n      - --providers.docker=true\n      - --providers.docker.endpoint=unix:///var/run/docker.sock\n      - --providers.docker.defaultrule=HostHeader(`{{ index .Labels \"com.docker.compose.service\" }}.$DOMAINNAME`)\n      ## This is important, to load the config for RMM and Mesh\n      - --providers.file.directory=rules # Load dynamic configuration from one or more .toml or .yml files in a directory.\n      - --providers.file.watch=true # Only works on top level files in the rules folder\n      ####\n      - --certificatesresolvers.dns-cloudflare.acme.dnschallenge=true\n      - --certificatesResolvers.dns-cloudflare.acme.email=$CLOUDFLARE_EMAIL\n      - --certificatesResolvers.dns-cloudflare.acme.storage=/acme.json\n      - --certificatesResolvers.dns-cloudflare.acme.dnsChallenge.provider=cloudflare\n      - --certificatesResolvers.dns-cloudflare.acme.dnsChallenge.resolvers=1.1.1.1:53,1.0.0.1:53\n    ports:\n      - target: 80\n        published: 80\n        protocol: tcp\n        mode: host\n      - target: 443\n        published: 443\n        protocol: tcp\n        mode: host\n    volumes:\n        ##The rules that we will load##\n      - $USERDIR/docker/traefik2/rules:/rules \n        ##\n      - /var/run/docker.sock:/var/run/docker.sock:ro\n      - $USERDIR/docker/traefik2/acme/acme.json:/acme.json\n      - $USERDIR/docker/traefik2/traefik.log:/traefik.log\n    environment:\n      - CF_API_EMAIL=$CLOUDFLARE_EMAIL\n      - CF_API_KEY=$CLOUDFLARE_API_KEY\n    labels:\n      - \"traefik.enable=true\"\n      # HTTP-to-HTTPS Redirect\n      - \"traefik.http.routers.http-catchall.entrypoints=http\"\n      - \"traefik.http.routers.http-catchall.rule=HostRegexp(`{host:.+}`)\"\n      - \"traefik.http.routers.http-catchall.middlewares=redirect-to-https\"\n      - \"traefik.http.middlewares.redirect-to-https.redirectscheme.scheme=https\"\n      # HTTP Routers\n      - \"traefik.http.routers.traefik-rtr.entrypoints=https\"\n      - \"traefik.http.routers.traefik-rtr.rule=HostHeader(`traefik.$DOMAINNAME`)\"\n      - \"traefik.http.routers.traefik-rtr.tls=true\"\n      - \"traefik.http.routers.traefik-rtr.tls.domains[0].main=$DOMAINNAME\"\n      - \"traefik.http.routers.traefik-rtr.tls.domains[0].sans=*.$DOMAINNAME\"\n</code></pre></p> <p>Before proceding, we need to change the port 443 to 4430 and 80 to 800 because the port 443 and 80 are alredy used by Traefik.</p> <p>Here is a snippet of the only thing you should modify into docker-compose file of the installation.</p> <p><pre><code>  # container for tactical reverse proxy\n  tactical-nginx:\n    container_name: trmm-nginx\n    image: ${IMAGE_REPO}tactical-nginx:${VERSION}\n    restart: always\n    environment:\n      APP_HOST: ${APP_HOST}\n      API_HOST: ${API_HOST}\n      MESH_HOST: ${MESH_HOST}\n      CERT_PUB_KEY: ${CERT_PUB_KEY}\n      CERT_PRIV_KEY: ${CERT_PRIV_KEY}\n    networks:\n      proxy:\n        ipv4_address: 172.20.0.20\n    ports:\n      - \"800:80\" ## port 800 instead of 80\n      - \"4430:443\" ## port 4430 instead of 443\n</code></pre> Once save, make sure you run the docker-compose or installation script at least once, so all the directory structure are created. Once you have your certificate (acme.json) generated by traefikv2 we will be able to extract it for rmm.</p> <p>Copy the acme.json create by traefik into the root of your rmm directory (In my case its $USERDIR/docker/rmm) which you should have already define. After that we can run this docker to extract the certificates for us. <pre><code>version: \"3.7\"\nservices:\n##Copy the acme.json of Traefik2 at volumes: (userdir/docker/rmm in this case)\n  traefik-certs-dumper:\n    image: ldez/traefik-certs-dumper:v2.7.4\n    entrypoint: sh -c '\n      apk add jq\n      ; while ! [ -e /data/acme.json ]\n      || ! [ `jq \".[] | .Certificates | length\" /data/acme.json` != 0 ]; do\n      sleep 1\n      ; done\n      &amp;&amp; traefik-certs-dumper file --version v2 --watch\n      --source /data/acme.json --dest data/certs'\n    volumes:\n      - $USERDIR/docker/rmm:/data\n</code></pre> Once completed, you should have 1 new folder into you rmm directory $USERDIR/docker/rmm/certs in this example. As the installation instruction, we will pass those to the .env</p> <pre><code>echo \"CERT_PUB_KEY=$(sudo base64 -w 0 $USERDIR/docker/rmm/certs/certs/**yourdomaine.com.crt**)\" &gt;&gt; .env\necho \"CERT_PRIV_KEY=$(sudo base64 -w 0 $USERDIR/docker/rmm/certs/private/**yourdomaine.com.key**)\" &gt;&gt; .env\n</code></pre> <p>Next we can create 3 rules to tell traefik to correctly route the https and agent For that we will create 2 rules into traefik directory as per it configuration. folder/traefik/rules</p> <p>create  <pre><code>nano app-mesh.toml\n</code></pre> and inside it we add <pre><code>[http.routers]\n  [http.routers.mesh-rtr]\n      entryPoints = [\"https\"]\n      rule = \"Host(`mesh.**yourdomain.com**`)\"\n      service = \"mesh-svc\"\n##middleware with 2fa\n[http.services]\n  [http.services.mesh-svc]\n    [http.services.mesh-svc.loadBalancer]\n      passHostHeader = true\n      [[http.services.mesh-svc.loadBalancer.servers]]\n        url = \"https://**xxx.xxx.xxx.xxx**:4430\" # or whatever your external host's IP is\n</code></pre></p> <p>create <pre><code>nano app-meshagent.toml\n</code></pre> and inside it we add</p> <p><pre><code>[http.routers]\n  [http.routers.mesh-rtr1]\n      entryPoints = [\"https\"]\n      rule = \"\"\"Host(`mesh.**yourdomain.com**`) &amp;&amp;\n        PathPrefix( `/agent.ashx`, `/meshrelay.ashx`, ) &amp;&amp;\n        Headers(`X-Forwarded-Proto`, `wss`) \"\"\"\n    ##Don't add middle where, the agent wont work.    \n[http.services]\n  [http.services.mesh-svc1]\n    [http.services.mesh-svc.loadBalancer]\n      passHostHeader = true\n      [[http.services.mesh-svc1.loadBalancer.servers]]\n        url = \"https://**xxx.xxx.xxx.xxx**:4430\" # or whatever your external host's IP is\n</code></pre> create <pre><code>nano app-rmm.toml\n</code></pre> and inside it we add</p> <pre><code>[http.routers]\n  [http.routers.rmm-rtr]\n      entryPoints = [\"https\"]\n      rule = \"Host(`rmm.**yourdomain.com**`)\"\n      service = \"rmm-svc\"\n\n      ##middleware with 2fa\n\n[http.services]\n  [http.services.rmm-svc]\n    [http.services.rmm-svc.loadBalancer]\n      passHostHeader = true\n      [[http.services.rmm-svc.loadBalancer.servers]]\n        url = \"https://xxx.xxx.xxx.xxx:4430\" # or whatever your external host's IP:port is\n</code></pre> <p>That it, you can now restart Tactical rmm and mesh.yourdomain.com should work, same for the agent. Please note that if you have a middleware with 2FA you can still use it with the inside mesh.toml but do not add it with the agent.</p>"},{"location":"unsupported_scripts/#haproxy","title":"HAProxy","text":"<p>Check/Change the mesh central config.json, some of the values may be set already, CertUrl must be changed to point to the HAProxy server.</p>"},{"location":"unsupported_scripts/#meshcentral-adjustment","title":"Meshcentral Adjustment","text":"<p>Credit to @bradhawkins</p> <p>Edit Meshcentral config</p> <pre><code>nano /meshcentral/meshcentral-data/config.json\n</code></pre> <p>Insert this (modify <code>HAProxyIP</code> to your network)</p> <pre><code>{\n  \"settings\": {\n    \"Port\": 4430,\n    \"AliasPort\": 443,\n    \"RedirPort\": 800,\n    \"TlsOffload\": \"127.0.0.1\",\n  },\n  \"domains\": {\n    \"\": {\n      \"CertUrl\": \"https://HAProxyIP:443/\",\n    }\n  }\n}\n</code></pre> <p>Restart meshcentral</p> <pre><code>service meshcentral restart\n</code></pre>"},{"location":"unsupported_scripts/#haproxy-config","title":"HAProxy Config","text":"<p>The order of use_backend is important <code>Tactical-Mesh-WebSocket_ipvANY</code> must be before <code>Tactical-Mesh_ipvANY</code> The values of <code>timeout connect</code>, <code>timeout server</code>, <code>timeout tunnel</code> in <code>Tactical-Mesh-WebSocket</code> have been configured to maintain a stable agent connection, however you may need to adjust these values to suit your environment.</p> <pre><code>frontend HTTPS-merged\n    bind            0.0.0.0:443 name 0.0.0.0:443   ssl crt-list /var/etc/haproxy/HTTPS.crt_list  #ADJUST THIS TO YOUR OWN SSL CERTIFICATES\n    mode            http\n    log         global\n    option          socket-stats\n    option          dontlognull\n    option          http-server-close\n    option          forwardfor\n    acl https ssl_fc\n    http-request set-header     X-Forwarded-Proto http if !https\n    http-request set-header     X-Forwarded-Proto https if https\n    timeout client      30000\n    acl         RMM var(txn.txnhost) -m sub -i rmm.example.com\n    acl         aclcrt_RMM  var(txn.txnhost) -m reg -i ^([^\\.]*)\\.example\\.com(:([0-9]){1,5})?$\n    acl         API var(txn.txnhost) -m sub -i api.example.com\n    acl         aclcrt_API  var(txn.txnhost) -m reg -i ^([^\\.]*)\\.example\\.com(:([0-9]){1,5})?$\n    acl         is_websocket    hdr(Upgrade) -i WebSocket\n    acl         is_mesh var(txn.txnhost) -m beg -i mesh.example.com\n    acl         aclcrt_MESH-WebSocket   var(txn.txnhost) -m reg -i ^([^\\.]*)\\.example\\.com(:([0-9]){1,5})?$\n    acl         MESH    var(txn.txnhost) -m sub -i mesh.example.com\n    acl         aclcrt_MESH var(txn.txnhost) -m reg -i ^([^\\.]*)\\.example\\.com(:([0-9]){1,5})?$\n    #PUT OTHER USE_BACKEND IN HERE\n    use_backend Tactical_ipvANY  if  RMM aclcrt_RMM\n    use_backend Tactical_ipvANY  if  API aclcrt_API\n    use_backend Tactical-Mesh-WebSocket_ipvANY  if  is_websocket is_mesh aclcrt_MESH-WebSocket\n    use_backend Tactical-Mesh_ipvANY  if  MESH aclcrt_MESH\n\nfrontend http-to-https\n    bind            0.0.0.0:80   \n    mode            http\n    log         global\n    option          http-keep-alive\n    timeout client      30000\n    http-request redirect scheme https \n\n\nbackend Tactical_ipvANY\n    mode            http\n    id          100\n    log         global\n    timeout connect     30000\n    timeout server      30000\n    retries         3\n    option          httpchk GET / \n    server          tactical 192.168.10.123:443 id 101 ssl check inter 1000  verify none \n\n\nbackend Tactical-Mesh-WebSocket_ipvANY\n    mode            http\n    id          113\n    log         global\n    timeout connect     3000\n    timeout server      3000\n    retries         3\n    timeout tunnel      3600000\n    http-request add-header X-Forwarded-Host %[req.hdr(Host)] \n    http-request add-header X-Forwarded-Proto https \n    server          tactical 192.168.10.123:443 id 101 ssl  verify none \n\nbackend Tactical-Mesh_ipvANY\n    mode            http\n    id          112\n    log         global\n    timeout connect     15000\n    timeout server      15000\n    retries         3\n    option          httpchk GET / \n    timeout tunnel      15000\n    http-request add-header X-Forwarded-Host %[req.hdr(Host)] \n    http-request add-header X-Forwarded-Proto https \n    server          tactical 192.168.10.123:443 id 101 ssl check inter 1000  verify none \n</code></pre>"},{"location":"unsupported_scripts/#fail2ban","title":"fail2ban","text":""},{"location":"unsupported_scripts/#install-fail2ban","title":"Install fail2ban","text":"<pre><code>sudo apt install -y fail2ban\n</code></pre>"},{"location":"unsupported_scripts/#set-tactical-fail2ban-filter-conf-file","title":"Set Tactical fail2ban filter conf File","text":"<pre><code>tacticalfail2banfilter=\"$(cat &lt;&lt; EOF\n[Definition]\nfailregex = ^&lt;HOST&gt;.*400.17.*$\nignoreregex = ^&lt;HOST&gt;.*200.*$\nEOF\n)\"\nsudo echo \"${tacticalfail2banfilter}\" &gt; /etc/fail2ban/filter.d/tacticalrmm.conf\n</code></pre>"},{"location":"unsupported_scripts/#set-tactical-fail2ban-jail-conf-file","title":"Set Tactical fail2ban jail conf File","text":"<pre><code>tacticalfail2banjail=\"$(cat &lt;&lt; EOF\n[tacticalrmm]\nenabled = true\nport = 80,443\nfilter = tacticalrmm\naction = iptables-allports[name=tactical]\nlogpath = /rmm/api/tacticalrmm/tacticalrmm/private/log/access.log\nmaxretry = 3\nbantime = 14400\nfindtime = 14400\nEOF\n)\"\nsudo echo \"${tacticalfail2banjail}\" &gt; /etc/fail2ban/jail.d/tacticalrmm.local\n</code></pre>"},{"location":"unsupported_scripts/#restart-fail2ban","title":"Restart fail2ban","text":"<pre><code>sudo systemctl restart fail2ban\n</code></pre>"},{"location":"unsupported_scripts/#using-purchased-ssl-certs-instead-of-letsencrypt-wildcards","title":"Using purchased SSL certs instead of LetsEncrypt wildcards","text":"<p>Credit to @dinger1986</p> <p>How to change certs used by Tactical RMM to purchased ones (this can be a wildcard cert).</p> <p>You need to add the certificate private key and public keys to the following files:</p> <p><code>/etc/nginx/sites-available/rmm.conf</code></p> <p><code>/etc/nginx/sites-available/meshcentral.conf</code></p> <p><code>/etc/nginx/sites-available/frontend.conf</code></p> <p><code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code></p> <ol> <li> <p>create a new folder for certs and allow tactical user permissions (assumed to be tactical)</p> <pre><code>sudo mkdir /certs\nsudo chown -R tactical:tactical /certs\"\n</code></pre> </li> <li> <p>Now move your certs into that folder.</p> </li> <li> <p>Open the api file and add the api certificate or if its a wildcard the directory should be <code>/certs/EXAMPLE.COM/</code></p> <pre><code>sudo nano /etc/nginx/sites-available/rmm.conf\n</code></pre> <p>replace   </p> <pre><code>ssl_certificate /etc/letsencrypt/live/EXAMPLE.COM/fullchain.pem;\nssl_certificate_key /etc/letsencrypt/live/EXAMPLE.COM/privkey.pem;\n</code></pre> <p>with</p> <pre><code>ssl_certificate /certs/api.EXAMPLE.COM/fullchain.pem;\nssl_certificate_key /certs/api.EXAMPLE.COM/privkey.pem;\n</code></pre> </li> <li> <p>Repeat the process for </p> <pre><code>/etc/nginx/sites-available/meshcentral.conf\n/etc/nginx/sites-available/frontend.conf\n</code></pre> <p>but change api. to: mesh. and rmm. respectively.</p> </li> <li> <p>Add the following to the last lines of <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code></p> <pre><code>nano /rmm/api/tacticalrmm/tacticalrmm/local_settings.py\n</code></pre> <p>add</p> <pre><code>CERT_FILE = \"/certs/api.EXAMPLE.COM/fullchain.pem\"\nKEY_FILE = \"/certs/api.EXAMPLE.COM/privkey.pem\"\n</code></pre> </li> <li> <p>Regenerate Nats Conf</p> <pre><code>cd /rmm/api/tacticalrmm\nsource ../env/bin/activate\npython manage.py reload_nats\n</code></pre> </li> <li> <p>Restart services</p> <pre><code>sudo systemctl restart rmm celery celerybeat nginx nats nats-api\n</code></pre> </li> </ol>"},{"location":"unsupported_scripts/#use-certbot-to-do-acme-challenge-over-http","title":"Use certbot to do acme challenge over http","text":"<p>The standard SSL cert process in Tactical uses a DNS challenge that requires dns txt files to be updated in your public DNS with every cert renewal.</p> <p>The below script uses http challenge on the 3 separate ssl certs, one for each subdomain: rmm, api, mesh. They still have the same 3 month expiry. Restart the Tactical RMM server about every 2.5 months (80 days) for auto-renewed certs to become active.</p> <p>Note</p> <p>Your Tactical RMM server will need to have TCP Port: 80 exposed to the internet</p> <pre><code>#!/bin/bash\n\n###Set colours same as Tactical RMM install and Update\nYELLOW='\\033[1;33m'\nGREEN='\\033[0;32m'\nRED='\\033[0;31m'\nNC='\\033[0m'\n\n### Ubuntu 20.04 Check\n\nUBU20=$(grep 20.04 \"/etc/\"*\"release\")\nif ! [[ $UBU20 ]]; then\n  echo -ne \"\\033[0;31mThis script will only work on Ubuntu 20.04\\e[0m\\n\"\n  exit 1\nfi\n\ncls() {\n  printf \"\\033c\"\n}\n\nprint_green() {\n  printf &gt;&amp;2 \"${GREEN}%0.s-${NC}\" {1..80}\n  printf &gt;&amp;2 \"\\n\"\n  printf &gt;&amp;2 \"${GREEN}${1}${NC}\\n\"\n  printf &gt;&amp;2 \"${GREEN}%0.s-${NC}\" {1..80}\n  printf &gt;&amp;2 \"\\n\"\n}\n\ncls\n\n### Set variables for domains\n\nwhile [[ $rmmdomain != *[.]*[.]* ]]\ndo\necho -ne \"${YELLOW}Enter the subdomain used for the backend (e.g. api.example.com)${NC}: \"\nread rmmdomain\ndone\n\nwhile [[ $frontenddomain != *[.]*[.]* ]]\ndo\necho -ne \"${YELLOW}Enter the subdomain used for the frontend (e.g. rmm.example.com)${NC}: \"\nread frontenddomain\ndone\n\nwhile [[ $meshdomain != *[.]*[.]* ]]\ndo\necho -ne \"${YELLOW}Enter the subdomain used for meshcentral (e.g. mesh.example.com)${NC}: \"\nread meshdomain\ndone\n\necho -ne \"${YELLOW}Enter the current root domain (e.g. example.com or example.co.uk)${NC}: \"\nread rootdomain\n\n\n### Setup Certificate Variables\nCERT_PRIV_KEY=/etc/letsencrypt/live/${rootdomain}/privkey.pem\nCERT_PUB_KEY=/etc/letsencrypt/live/${rootdomain}/fullchain.pem\n\n### Make Letsencrypt directories\n\nsudo mkdir /var/www/letsencrypt\nsudo mkdir /var/www/letsencrypt/.mesh\nsudo mkdir /var/www/letsencrypt/.rmm\nsudo mkdir /var/www/letsencrypt/.api\n\n### Remove config files for nginx\n\nsudo rm /etc/nginx/sites-available/rmm.conf\nsudo rm /etc/nginx/sites-available/meshcentral.conf\nsudo rm /etc/nginx/sites-available/frontend.conf\nsudo rm /etc/nginx/sites-enabled/rmm.conf\nsudo rm /etc/nginx/sites-enabled/meshcentral.conf\nsudo rm /etc/nginx/sites-enabled/frontend.conf\n\n### Setup tactical nginx config files for letsencrypt\n\nnginxrmm=\"$(cat &lt;&lt; EOF\nserver_tokens off;\nupstream tacticalrmm {\n    server unix:////rmm/api/tacticalrmm/tacticalrmm.sock;\n}\nmap \\$http_user_agent \\$ignore_ua {\n    \"~python-requests.*\" 0;\n    \"~go-resty.*\" 0;\n    default 1;\n}\nserver {\n    listen 80;\n    server_name ${rmmdomain};\n        location /.well-known/acme-challenge/ {\n        root /var/www/letsencrypt/.api/;}\n    location / {\n    return 301 https://\\$server_name\\$request_uri;}\n}\nserver {\n    listen 443 ssl;\n    server_name ${rmmdomain};\n    client_max_body_size 300M;\n    access_log /rmm/api/tacticalrmm/tacticalrmm/private/log/access.log;\n    error_log /rmm/api/tacticalrmm/tacticalrmm/private/log/error.log;\n    ssl_certificate ${CERT_PUB_KEY};\n    ssl_certificate_key ${CERT_PRIV_KEY};\n    ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384';\n\n    location /static/ {\n        root /rmm/api/tacticalrmm;\n    }\n    location /private/ {\n        internal;\n        add_header \"Access-Control-Allow-Origin\" \"https://${frontenddomain}\";\n        alias /rmm/api/tacticalrmm/tacticalrmm/private/;\n    }\nlocation ~ ^/ws/ {\n        proxy_pass http://unix:/rmm/daphne.sock;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n        proxy_redirect     off;\n        proxy_set_header   Host $host;\n        proxy_set_header   X-Real-IP $remote_addr;\n        proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header   X-Forwarded-Host $server_name;\n}\n    location /saltscripts/ {\n        internal;\n        add_header \"Access-Control-Allow-Origin\" \"https://${frontenddomain}\";\n        alias /srv/salt/scripts/userdefined/;\n    }\n    location /builtin/ {\n        internal;\n        add_header \"Access-Control-Allow-Origin\" \"https://${frontenddomain}\";\n        alias /srv/salt/scripts/;\n    }\n    location ~ ^/(natsapi) {\n        allow 127.0.0.1;\n        deny all;\n        uwsgi_pass tacticalrmm;\n        include     /etc/nginx/uwsgi_params;\n        uwsgi_read_timeout 500s;\n        uwsgi_ignore_client_abort on;\n    }\n    location / {\n        uwsgi_pass  tacticalrmm;\n        include     /etc/nginx/uwsgi_params;\n        uwsgi_read_timeout 9999s;\n        uwsgi_ignore_client_abort on;\n    }\n}\nEOF\n)\"\necho \"${nginxrmm}\" | sudo tee /etc/nginx/sites-available/rmm.conf &gt; /dev/null\n\n\nnginxmesh=\"$(cat &lt;&lt; EOF\nserver {\n  listen 80;\n  server_name ${meshdomain};\n      location /.well-known/acme-challenge/ {\n        root /var/www/letsencrypt/.mesh/;}\n    location / {\n  return 301 https://\\$server_name\\$request_uri;}\n}\nserver {\n    listen 443 ssl;\n    proxy_send_timeout 330s;\n    proxy_read_timeout 330s;\n    server_name ${meshdomain};\n    ssl_certificate ${CERT_PUB_KEY};\n    ssl_certificate_key ${CERT_PRIV_KEY};\n    ssl_session_cache shared:WEBSSL:10m;\n    ssl_ciphers HIGH:!aNULL:!MD5;\n    ssl_prefer_server_ciphers on;\n    location / {\n        proxy_pass http://127.0.0.1:4430/;\n        proxy_http_version 1.1;\n        proxy_set_header Host \\$host;\n        proxy_set_header Upgrade \\$http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n        proxy_set_header X-Forwarded-Host \\$host:\\$server_port;\n        proxy_set_header X-Forwarded-For \\$proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto \\$scheme;\n    }\n}\nEOF\n)\"\necho \"${nginxmesh}\" | sudo tee /etc/nginx/sites-available/meshcentral.conf &gt; /dev/null\n\n\n\nnginxfrontend=\"$(cat &lt;&lt; EOF\nserver {\n    server_name ${frontenddomain};\n    charset utf-8;\n    location / {\n        root /var/www/rmm/dist;\n        try_files \\$uri \\$uri/ /index.html;\n        add_header Cache-Control \"no-store, no-cache, must-revalidate\";\n        add_header Pragma \"no-cache\";\n    }\n    error_log  /var/log/nginx/frontend-error.log;\n    access_log /var/log/nginx/frontend-access.log;\n    listen 443 ssl;\n    ssl_certificate ${CERT_PUB_KEY};\n    ssl_certificate_key ${CERT_PRIV_KEY};\n    ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384';\n}\nserver {\n    listen 80;\n    server_name ${frontenddomain};\n    location /.well-known/acme-challenge/ {\n        root /var/www/letsencrypt/.rmm/;}\n    location / {\n    return 301 https://\\$host\\$request_uri;}\n}\nEOF\n)\"\necho \"${nginxfrontend}\" | sudo tee /etc/nginx/sites-available/frontend.conf &gt; /dev/null\n\n### Relink nginx config files\n\nsudo ln -s /etc/nginx/sites-available/rmm.conf /etc/nginx/sites-enabled/rmm.conf\nsudo ln -s /etc/nginx/sites-available/meshcentral.conf /etc/nginx/sites-enabled/meshcentral.conf\nsudo ln -s /etc/nginx/sites-available/frontend.conf /etc/nginx/sites-enabled/frontend.conf\n\n### Restart nginx\n\nsudo systemctl restart nginx\n\n\n### Get letsencrypt Certs\n\nsudo letsencrypt certonly --webroot -w /var/www/letsencrypt/.mesh/ -d ${meshdomain}\nsudo letsencrypt certonly --webroot -w /var/www/letsencrypt/.rmm/ -d ${frontenddomain}\nsudo letsencrypt certonly --webroot -w /var/www/letsencrypt/.api/ -d ${rmmdomain}\n\n### Ensure letsencrypt Permissions are correct\nsudo chown ${USER}:${USER} -R /etc/letsencrypt\nsudo chmod 775 -R /etc/letsencrypt\n\n### Set variables for new certs\n\nCERT_PRIV_KEY_API=/etc/letsencrypt/live/${rmmdomain}/privkey.pem\nCERT_PUB_KEY_API=/etc/letsencrypt/live/${rmmdomain}/fullchain.pem\nCERT_PRIV_KEY_RMM=/etc/letsencrypt/live/${frontenddomain}/privkey.pem\nCERT_PUB_KEY_RMM=/etc/letsencrypt/live/${frontenddomain}/fullchain.pem\nCERT_PRIV_KEY_MESH=/etc/letsencrypt/live/${meshdomain}/privkey.pem\nCERT_PUB_KEY_MESH=/etc/letsencrypt/live/${meshdomain}/fullchain.pem\n\n### Replace certs in files\n\nrmmlocalsettings=\"$(cat &lt;&lt; EOF\nCERT_FILE = \"${CERT_PUB_KEY_API}\"\nKEY_FILE = \"${CERT_PRIV_KEY_API}\"\nEOF\n)\"\necho \"${rmmlocalsettings}\" | tee --append /rmm/api/tacticalrmm/tacticalrmm/local_settings.py &gt; /dev/null\n\nsudo sed -i \"s|${CERT_PRIV_KEY}|${CERT_PRIV_KEY_API}|g\" /etc/nginx/sites-available/rmm.conf\nsudo sed -i \"s|${CERT_PUB_KEY}|${CERT_PUB_KEY_API}|g\" /etc/nginx/sites-available/rmm.conf\nsudo sed -i \"s|${CERT_PRIV_KEY}|${CERT_PRIV_KEY_MESH}|g\" /etc/nginx/sites-available/meshcentral.conf\nsudo sed -i \"s|${CERT_PUB_KEY}|${CERT_PUB_KEY_MESH}|g\" /etc/nginx/sites-available/meshcentral.conf\nsudo sed -i \"s|${CERT_PRIV_KEY}|${CERT_PRIV_KEY_RMM}|g\" /etc/nginx/sites-available/frontend.conf\nsudo sed -i \"s|${CERT_PUB_KEY}|${CERT_PUB_KEY_RMM}|g\" /etc/nginx/sites-available/frontend.conf\n\n### Remove Wildcard Cert\n\nrm -r /etc/letsencrypt/live/${rootdomain}/\nrm -r /etc/letsencrypt/archive/${rootdomain}/\nrm /etc/letsencrypt/renewal/${rootdomain}.conf\n\n\n### Regenerate Nats Conf\ncd /rmm/api/tacticalrmm\nsource ../env/bin/activate\npython manage.py reload_nats\n\n### Restart services\n\nfor i in rmm celery celerybeat nginx nats nats-api\ndo\nprintf &gt;&amp;2 \"${GREEN}Restarting ${i} service...${NC}\\n\"\nsudo systemctl restart ${i}\ndone\n\n\n###Renew certs can be done by sudo letsencrypt renew (this should automatically be in /etc/cron.d/certbot)\n</code></pre>"},{"location":"unsupported_scripts/#using-your-own-certs-with-docker","title":"Using your own certs with Docker","text":"<p>Let's Encrypt is the only officially supported method of obtaining wildcard certificates. Publicly signed certificates should work but have not been fully tested.</p> <p>If you are providing your own publicly signed certificates, ensure you download the full chain (combined CA/Root + Intermediary) certificate in pem format. If certificates are not provided, a self-signed certificate will be generated and most agent functions won't work.</p>"},{"location":"unsupported_scripts/#restricting-access-to-rmmexamplecom","title":"Restricting Access to rmm.EXAMPLE.COM","text":"<p>Limit access to Tactical RMM's administration panel in nginx to specific locations</p>"},{"location":"unsupported_scripts/#using-dns","title":"Using DNS","text":"<ol> <li> <p>Create a file allowed-domain.list which contains the DNS names you want to grant access to your rmm:</p> <p>Edit <code>/etc/nginx/allowed-domain.list</code> and add</p> <pre><code>nom1.dyndns.tv\nnom2.dyndns.tv\n</code></pre> </li> <li> <p>Create a bash script domain-resolver.sh which do the DNS lookups for you:</p> <p>Edit <code>/etc/nginx/domain-resolver.sh</code></p> <pre><code>#!/usr/bin/env bash\nfilename=\"$1\"\nwhile read -r line\ndo\n        ddns_record=\"$line\"\n        if [[ !  -z  $ddns_record ]]; then\n                resolved_ip=getent ahosts $line | awk '{ print $1 ; exit }'\n                if [[ !  -z  $resolved_ip ]]; then\n                        echo \"allow $resolved_ip;# from $ddns_record\"\n                fi\n        fi\ndone &lt; \"$filename\"\n</code></pre> </li> <li> <p>Give the right permission to this script <code>chmod +x /etc/nginx/domain-resolver.sh</code></p> </li> <li> <p>Add a cron job which produces a valid nginx configuration and restarts nginx:</p> <p><code>/etc/cron.hourly/domain-resolver</code></p> <pre><code>#!/usr/bin/env bash\n/etc/nginx/domain-resolver.sh /etc/nginx/allowed-domain.list &gt; /etc/nginx//allowed-ips-from-domains.conf\nservice nginx reload &gt; /dev/null 2&gt;&amp;1\n</code></pre> <p>This can be a hourly, daily or monthly job or you can have it run at a specific time. </p> </li> <li> <p>Give the right permission to this script chmod +x /etc/cron.hourly/domain-resolver</p> </li> <li> <p>When run it will give something like this</p> <p>Edit <code>/etc/nginx//allowed-ips-from-domains.conf</code></p> <pre><code>allow xxx.xxx.xxx.xxx;# from maison.nom1.dyndns.tv\nallow xxx.xxx.xxx.xxx;# from maison.nom2.dyndns.tv\n</code></pre> </li> <li> <p>Update your nginx configuration to take this output into account:</p> <p>Edit <code>/etc/nginx/sites-enabled/frontend.conf</code></p> <pre><code>server {\n    server_name rmm.example.com;\n    charset utf-8;\n    location / {\n        root /var/www/rmm/dist;\n        try_files $uri $uri/ /index.html;\n        add_header Cache-Control \"no-store, no-cache, must-revalidate\";\n        add_header Pragma \"no-cache\";\n    }\n    error_log  /var/log/nginx/frontend-error.log;\n    access_log /var/log/nginx/frontend-access.log;\n    include /etc/nginx/allowed-ips-from-domains.conf;\n    deny all;\n    listen 443 ssl;\n    listen [::]:443 ssl;\n    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;\n    ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384';\n}\n\nserver {\n    if ($host = rmm.example.com) {\n        return 301 https://$host$request_uri;\n    }\n\n    listen 80;\n    listen [::]:80;\n    server_name rmm.example.com;\n    return 404;\n}\n</code></pre> </li> </ol>"},{"location":"unsupported_scripts/#using-a-fixed-ip","title":"Using a fixed IP","text":"<ol> <li> <p>Create a file containg the fixed IP address (where xxx.xxx.xxx.xxx must be replaced by your real IP address)</p> <p>Edit <code>/etc/nginx//allowed-ips.conf</code></p> <pre><code># Private IP address\nallow 192.168.0.0/16;\nallow 172.16.0.0/12;\nallow 10.0.0.0/8;\n# Public fixed IP address\nallow xxx.xxx.xxx.xxx\n</code></pre> </li> <li> <p>Update your nginx configuration to take this output into account:</p> <p>Edit <code>/etc/nginx/sites-enabled/frontend.conf</code></p> <pre><code>server {\n    server_name rmm.example.com;\n    charset utf-8;\n    location / {\n        root /var/www/rmm/dist;\n        try_files $uri $uri/ /index.html;\n        add_header Cache-Control \"no-store, no-cache, must-revalidate\";\n        add_header Pragma \"no-cache\";\n    }\n    error_log  /var/log/nginx/frontend-error.log;\n    access_log /var/log/nginx/frontend-access.log;\ninclude /etc/nginx/allowed-ips;\n    deny all;\n    listen 443 ssl;\n    listen [::]:443 ssl;\n    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;\n    ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384';\n}\n\nserver {\n    if ($host = rmm.example.com) {\n        return 301 https://$host$request_uri;\n    }\n\n    listen 80;\n    listen [::]:80;\n    server_name rmm.example.com;\n    return 404;\n}\n</code></pre> </li> </ol>"},{"location":"unsupported_scripts/#apache-proxy","title":"Apache Proxy","text":"<p>howto -  proxy on apache</p>"},{"location":"unsupported_scripts/#trmm-server","title":"TRMM SERVER","text":"<p>edit file /etc/nginx/sites-available/rmm.conf add the lines from 'real_ip' module inside server tag:</p> <pre><code>set_real_ip_from    192.168.0.200; #IP Address of your apache proxy\nreal_ip_header      X-Forwarded-For;\n</code></pre> <p>restart nginx</p> <pre><code>systemctl restart nginx\n</code></pre>"},{"location":"unsupported_scripts/#apache","title":"APACHE","text":"<p>enable ssl proxy, rewriteEngine.  set proxy to preserve host. set upgrade rule to websocket. set proxypass rules redirecting to rmm location</p> <p>on your apache ssl config example:</p> <pre><code>&lt;VirtualHost *:443&gt;\n    ServerName rmm.blablabla.com.br:443\n    ServerAlias mesh.blablabla.com.br:443 api.blablabla.com.br:443 \n    SSLEngine on\n\n    SSLCertificateFile \"C:/Apache24/conf/ssl-rmm.blablabla.com.br/_.blablabla.com.br-chain.pem\"\n    SSLCertificateKeyFile \"C:/Apache24/conf/ssl-rmm.blablabla.com.br/_.blablabla.com.br-key.pem\"\n\n    SSLProxyEngine on\n\n    RewriteEngine On\n    ProxyPreserveHost On\n\n    # When Upgrade:websocket header is present, redirect to ws\n    # Using NC flag (case-insensitive) as some browsers will pass Websocket\n    RewriteCond %{HTTP:Upgrade} =websocket [NC]\n    RewriteRule ^/(.*)    wss://192.168.0.212/$1 [P,L]\n\n    ProxyPass \"/\"  \"https://192.168.0..212/\" retry=3\n    ProxyPassReverse \"/\"  \"https://192.168.0.212/\" retry=3\n\n    BrowserMatch \"MSIE [2-5]\" \\\n             nokeepalive ssl-unclean-shutdown \\\n             downgrade-1.0 force-response-1.0\n</code></pre> <p></p>"},{"location":"unsupported_scripts/#updating-certificate","title":"Updating certificate:","text":"<p>Im my case, auto DNS Challenge from apache, so every time we get new cert files, it must be copied inside rmm too. just overwrite default location: /etc/letsencrypt/archive/blablablabla or change certs location on nginx conf to whatever you want.</p>"},{"location":"unsupported_scripts/#nginx-proxy","title":"nginx Proxy","text":"<p>Having mesh connection issues? </p> <p>See https://info.meshcentral.com/downloads/MeshCentral2/MeshCentral2UserGuide.pdf page 30.</p>"},{"location":"unsupported_synology_docker_install/","title":"Installing on Synology NAS using docker install","text":""},{"location":"unsupported_synology_docker_install/#docker-setup","title":"Docker Setup","text":"<p>While a docker install is supported, trying to help someone get it working on their own Synology NAS is not. But here's how you do it!</p> <ul> <li>Follow the standard docker install documentation.</li> <li>Once the <code>docker-compose</code> file is downloaded, edit it and modify the ports used by the nginx server to custom ports (<code>13180</code> and <code>13443</code> in the example below)</li> </ul> <p></p>"},{"location":"unsupported_synology_docker_install/#setup-the-reverse-proxy","title":"Setup the reverse proxy","text":"<p>Go to Login Portal &gt; Advanced &gt; Reverse Proxy in the Control Panel</p> <p>Create 2 entries for each tactical DNS entries, one for the HTTP port &amp; one for the HTTPS</p> <p></p> <p>For the entries related to the mesh, add some custom headers and adjust the proxy timeout connection</p> <p></p> <p></p>"},{"location":"unsupported_synology_docker_install/#bonus-ssl-certificate","title":"Bonus: SSL Certificate","text":"<p>In regards to the certificate, I followed this tutorial (in french but still clear after translation) to automatically update it and manually updating it on the NAS and in TRMM</p> <pre><code>docker exec Acme sh -c \"acme.sh --issue --keylength 4096 -d '*.EXAMPLE.COM' --dns dns_provider\"\nsed -i '/CERT_PUB_KEY/d' /path/to/tactical/.env\nsed -i '/CERT_PRIV_KEY/d' /path/to/tactical/.env\necho \"CERT_PUB_KEY=$(sudo base64 -w 0 /volume1/docker/acme/\\*.EXAMPLE.COM/fullchain.cer)\" &gt;&gt; /path/to/tactical/.env\necho \"CERT_PRIV_KEY=$(sudo base64 -w 0 /volume1/docker/acme/\\*.EXAMPLE.COM/*.whitesnew.com.key)\" &gt;&gt; /path/to/tactical/.env\ndocker exec Acme sh -c \"acme.sh --deploy -d '*.EXAMPLE.COM' --deploy-hook synology_provider\"\ndocker-compose -f /path/to/tactical/docker-compose.yml restart\n</code></pre>"},{"location":"update_agents/","title":"Updating Agents","text":"<p>Warning</p> <p>The agent's version is directly tied to the RMM's version. For example, currently RMM version 0.4.17 is compatible with agent version 1.4.6 and lower. You should never attempt to manually update an agent to a newer version without first making sure your RMM is on the latest version.</p>"},{"location":"update_agents/#updating-from-the-web-ui","title":"Updating from the Web UI","text":"<p>Agents will automatically self update themselves if you have auto self update enabled in Settings &gt; Global Settings</p> <p></p> <p>There is a background job that runs every hour, at 35 minutes past the hour and sends any online agents an update command if it detects they are on an older version.</p> <p>You can also trigger this background job to run on demand by clicking Agents &gt; Update Agents in the web UI:</p> <p></p> <p>You can individually choose which agents to update, or simply Select All.</p> <p>The RMM will automatically skip any agents that don't need updating.</p> <p>You can trigger this manual agent update anytime you want. It is safe to spam, and won't run if an agent update task is already running.</p> <p>It will also make sure agents update to the correct version, in case they are an older version that cannot be directly upgraded to the latest version.</p> <p>For example, agents older than version 1.3.0 must first be updated to 1.3.0 before they can go any further.</p>"},{"location":"update_agents/#manually-updating-from-the-command-line-on-the-agent","title":"Manually updating from the command line on the agent","text":"<p>You should never need to do this but might be needed to troubleshoot agents that are not updating automatically.</p> <p>Download the <code>winagent-vX.X.X.exe</code> executable from the github releases page and place it somewhere on the filesystem.</p> <p>Open CMD as admin and call the exe like so:</p> <pre><code>C:\\Windows\\Temp&gt;winagent-vX.X.X.exe /VERYSILENT /LOG=agentupdate.txt\n</code></pre> <p>This command will return immediately since it spawns a background process to run the update. The agent will take around 30 seconds to fully update.</p> <p>You can check the <code>agentupdate.txt</code> log file that is created for troubleshooting.</p>"},{"location":"update_docker/","title":"Updating the RMM (Docker)","text":""},{"location":"update_docker/#updating-to-the-latest-rmm-version","title":"Updating to the latest RMM version","text":"<p>Question</p> <p>You have a backup right?</p> <p>Tactical RMM updates the docker images on every release and should be available within a few minutes</p> <p>SSH into your server as a root user and run the below commands:</p> <pre><code>cd [dir/with/compose/file]\nmv docker-compose.yml docker-compose.yml.old\nwget https://raw.githubusercontent.com/wh1te909/tacticalrmm/master/docker/docker-compose.yml\nsudo docker-compose pull\nsudo docker-compose down\nsudo docker-compose up -d --remove-orphans\n</code></pre>"},{"location":"update_docker/#keeping-your-lets-encrypt-certificate-up-to-date","title":"Keeping your Let's Encrypt certificate up to date","text":"<p>To renew your Let's Encrypt wildcard cert, run the following command, replacing <code>example.com</code> with your domain and <code>admin@example.com</code> with your email:</p> <pre><code>sudo certbot certonly --manual -d *.example.com --agree-tos --no-bootstrap --manual-public-ip-logging-ok --preferred-challenges dns -m admin@example.com --no-eff-email\n</code></pre> <p>Verify the domain with the TXT record. Once issued, run the below commands to base64 encode the certificates and add them to the .env file</p> <pre><code>echo \"CERT_PUB_KEY=$(sudo base64 -w 0 /etc/letsencrypt/live/${rootdomain}/fullchain.pem)\" &gt;&gt; .env\necho \"CERT_PRIV_KEY=$(sudo base64 -w 0 /etc/letsencrypt/live/${rootdomain}/privkey.pem)\" &gt;&gt; .env\n</code></pre> <p>Warning</p> <p>You must remove the old and any duplicate entries for CERT_PUB_KEY and CERT_PRIV_KEY in the .env file</p> <p>Now run <code>sudo docker-compose restart</code> and the new certificate will be in effect</p>"},{"location":"update_server/","title":"Updating the RMM","text":""},{"location":"update_server/#keeping-your-linux-server-up-to-date","title":"Keeping your linux server up to date","text":"<p>You should periodically run <code>sudo apt update</code> and <code>sudo apt -y upgrade</code> to keep your server up to date.</p> <p>Other than this, you should avoid making any changes to your server and let the <code>update.sh</code> script handle everything else for you.</p>"},{"location":"update_server/#updating-to-the-latest-rmm-version","title":"Updating to the latest RMM version","text":"<p>Danger</p> <p>Do not attempt to manually edit the update script or any configuration files unless specifically told to by one of the developers.</p> <p>Since this software is completely self hosted and we have no access to your server, we have to assume you have not made any config changes to any of the files or services on your server, and the update script will assume this.</p> <p>You should also never attempt to automate running the update script via cron.</p> <p>The update script will update itself if needed to the latest version when you run it, and then prompt you to run it again.</p> <p>Sometimes, manual intervention will be required during an update in the form of yes/no prompts, so attempting to automate this will ignore these prompts and cause your installation to break.</p> <p>SSH into your server as the linux user you created during install (eg <code>tactical</code>).</p> <p>Danger</p> <p>Never run any update scripts or commands as the <code>root</code> user.</p> <p>This will mess up permissions and break your installation.</p> <p>Question</p> <p>You have a backup right?</p> <p>Download the update script and run it:</p> <pre><code>wget -N https://raw.githubusercontent.com/wh1te909/tacticalrmm/master/update.sh\nchmod +x update.sh\n./update.sh\n</code></pre> <p>If you are already on the latest version, the update script will notify you of this and return immediately.</p> <p>You can pass the optional <code>--force</code> flag to the update script to forcefully run through an update, which will bypass the check for latest version.</p> <pre><code>./update.sh --force\n</code></pre> <p>This is useful for a botched update that might have not completed fully.</p> <p>The update script will also fix any permissions that might have gotten messed up during a botched update, or if you accidentally ran the update script as the <code>root</code> user.</p> <p>Warning</p> <p>Do not attempt to manually update MeshCentral to a newer version.</p> <p>You should let the <code>update.sh</code> script handle this for you. </p> <p>The developers will test MeshCentral and make sure integration does not break before bumping the mesh version.</p>"},{"location":"update_server/#keeping-your-lets-encrypt-certificate-up-to-date","title":"Keeping your Let's Encrypt certificate up to date","text":"<p>Info</p> <p>Currently, the update script does not automatically renew your Let's Encrypt wildcard certificate, which expires every 3 months, since this is non-trivial to automate using the DNS TXT record method.</p> <p>To renew your Let's Encrypt wildcard cert, run the following command, replacing <code>example.com</code> with your domain and <code>admin@example.com</code> with your email:</p> <pre><code>sudo certbot certonly --manual -d *.example.com --agree-tos --no-bootstrap --manual-public-ip-logging-ok --preferred-challenges dns -m admin@example.com --no-eff-email\n</code></pre> <p>Same instructions as during install for verifying the TXT record has propagated before hitting Enter.</p> <p>After this you have renewed the cert, simply run the <code>update.sh</code> script, passing it the <code>--force</code> flag.</p> <pre><code>./update.sh --force\n</code></pre>"},{"location":"update_server/#keep-an-eye-on-your-disk-space","title":"Keep an eye on your disk space","text":"<p>If you're running low, shrink you database</p> <ol> <li> <p>Choose Tools menu &gt; Server Maintenance &gt; Prune DB Tables</p> </li> <li> <p>At server command prompt run</p> </li> </ol> <pre><code>sudo -u postgres psql -d tacticalrmm -c \"vacuum full logs_auditlog\"\nsudo -u postgres psql -d tacticalrmm -c \"vacuum full logs_pendingaction\"\n</code></pre>"},{"location":"update_server/#video-walkthru","title":"Video Walkthru","text":""},{"location":"functions/alerting/","title":"Alerting Overview","text":"<p>Alerting and notifications can be managed centrally using Alert Templates. All an alert template does is configure the Email, Text and Dashboard alert check boxes on Agents, Checks, and Automated Tasks.</p> <p>Using Alert Templates also enables additional feature like:</p> <ul> <li>Periodic notifications if an alert is left unresolved</li> <li>Being able to notify on certain alert severities</li> <li>Sending notifications when an alert is resolved</li> <li>Executing scripts when an alert is triggered or resolved</li> </ul> <p>Setting up Email Alert Examples</p>"},{"location":"functions/alerting/#supported-notifications","title":"Supported Notifications","text":"<ul> <li>Email Alerts - Sends email to configured set of email addresses</li> <li>SMS Alerts - Sends text messages to configured set of numbers</li> <li>Dashboard Alerts - A notification popup will show up and be visible in the dashboard</li> </ul>"},{"location":"functions/alerting/#alert-severities","title":"Alert Severities","text":"<p>Info</p> <p>Agent overdue alerts are always of severity Error</p> <p>Alert severities are configured directly on the Check or Automated Task. When the Check/Automated Task fails, it will create an alert of the specified severity. The severity types are:</p> <ul> <li>Informational</li> <li>Warning</li> <li>Error</li> </ul>"},{"location":"functions/alerting/#adding-alert-templates","title":"Adding Alert Templates","text":"<p>To create an alert template, go to Settings &gt; Alerts Manager. Then click New</p> <p>The available options are:</p>"},{"location":"functions/alerting/#general-settings","title":"General Settings","text":"<ul> <li>Name - The name that is used to identify the Alert Template in the dashboard</li> <li>Email Recipients - Sets the list of email recipients. If this isn't set the email recipients will global settings will be used.</li> <li>From Email - Sets the From email address of the notification. If this isn't set the From address from global settings is used.</li> <li>SMS Recipients - Sets the list of text recipients. If this isn't set the sms list from global settings is used.</li> </ul>"},{"location":"functions/alerting/#action-settings","title":"Action Settings","text":"<ul> <li>Failure Action - Runs the selected script once on any agent. This is useful for running one-time tasks like sending an http request to an external system to create a ticket.</li> <li>Failure Action Args - Optionally pass in arguments to the failure script.</li> <li>Failure Action Timeout - Sets the timeout for the script.</li> <li>Resolved Action - Runs the selected script once on any agent if the alert is resolved. This is useful for running one-time tasks like sending an http request to an external system to close the ticket that was created.</li> <li>Resolved Action Args - Optionally pass in arguments to the resolved script.</li> <li>Resolved Action Timeout - Sets the timeout for the script.</li> </ul>"},{"location":"functions/alerting/#run-actions-only-on","title":"Run actions only on:","text":"<ul> <li>Agents - If Enabled, will run script failure/resolved actions on agent overdue alerts else no alert actions will be triggered for agent overdue alerts</li> <li>Checks - If Enabled, will run script failure/resolved actions on check alerts else no alert actions will be triggered check alerts</li> <li>Tasks - If Enabled, will run script failure/resolved actions on automated task alerts else no alert actions will be triggered automated task alerts</li> </ul>"},{"location":"functions/alerting/#agentchecktask-failure-settings","title":"Agent/Check/Task Failure Settings","text":"<ul> <li>Email - When Enabled, will send an email notification and override the Email Alert checkbox on the Agent/Check/Task. When Not Configured, the Email Alert checkbox on the Agent/Check/Task will take effect. If Disabled, no email notifications will be sent and will override any Email alert checkbox on the Agent/Check/Task</li> <li>Text - When Enabled, will send a text notification and override the SMS Alert checkbox on the Agent/Check/Task. When Not Configured, the SMS Alert checkbox on the Agent/Check/Task will take effect. If Disabled, no SMS notifications will be sent and will override any SMS Alert checkbox on the Agent/Check/Task</li> <li>Dashboard - When Enabled, will send a dashboard notification and override the Dashboard Alert checkbox on the Agent/Check/Task. When Not Configured, the Dashboard Alert checkbox on the Agent/Check/Task will take effect. If Disabled, no SMS notifications will be sent and will override any Dashboard Alert checkbox on the Agent/Check/Task</li> <li>Alert again if not resolved after (days) - This sends another notification if the alert isn't resolved after the set amount of days. Set to 0 to disable this</li> <li> <p>Alert on severity - Only applicable to Check and Task alert notifications. This will only send alerts when they are of the configured severity.</p> <p>Info</p> <p>Alert on Severity needs to be configured for check and task notifications to be sent!</p> </li> </ul>"},{"location":"functions/alerting/#agentchecktask-resolved-settings","title":"Agent/Check/Task Resolved Settings","text":"<ul> <li>Email - If enabled, sends an email notification when an alert is resolved</li> <li>Text - If enabled, sends a text messaged when an alert is resolved</li> </ul>"},{"location":"functions/alerting/#applying-alert-templates","title":"Applying Alert Templates","text":"<p>Alert templates can be configured Globally, through an Automation Policy, or set directly on the Client or Site.</p> <ul> <li>To apply Globally, navigate to Settings &gt; Global Settings. Set the Alert Template dropdown and save.</li> <li>You can configure an alert template on an automation policy by navigating to Settings &gt; Automation Manager, and clicking the Assign Alert Template click on the policy, or right-clicking the policy and selecting Assign Alert Template</li> <li>To configure on a Client or Site, right-click on one in the Client/Site tree view and select Assign Alert Template</li> </ul>"},{"location":"functions/alerting/#alert-template-exclusions","title":"Alert Template Exclusions","text":"<p>You can exclude Clients, Sites, and Agents from alert templates. To do this you can:</p> <ul> <li>right-click on the Alert Template in Alerts Manager and select Exclusions</li> <li>select the Alert Exclusions link in the Alert Template row.</li> </ul> <p>You can also Exclude Desktops from the alert template. This is useful if you only care about servers.</p>"},{"location":"functions/alerting/#alert-template-inheritance","title":"Alert Template inheritance","text":"<p>Alerts are applied in the following order. The agent picks the closest matching alert template.</p> <ol> <li>Policy w/ Alert Template applied to Site</li> <li>Site</li> <li>Policy w/ Alert Template applied to Client</li> <li>Client</li> <li>Default Alert Template</li> </ol>"},{"location":"functions/api/","title":"API Access","text":""},{"location":"functions/api/#api-access","title":"API Access","text":"<p>Version added: v0.8.3</p> <p>API Keys can be created to access any of TacticalRMM's api endpoints, which will bypass 2fa authentication</p> <p>When creating the key you'll need to choose a user, which will reflect what permissions the key has based on the user's role.</p> <p>Navigate to Settings &gt; Global Settings &gt; API Keys to generate a key</p> <p>Headers:</p> <pre><code>{\n    \"Content-Type\": \"application/json\", \n    \"X-API-KEY\": \"J57BXCFDA2WBCXH0XTELBR5KAI69CNCZ\"\n}\n</code></pre> <p>Example curl request:</p> <pre><code>curl https://api.example.com/clients/clients/ -H \"X-API-KEY: Y57BXCFAA9WBCXH0XTEL6R5KAK69CNCZ\"\n</code></pre>"},{"location":"functions/api/#enable-swagger","title":"Enable Swagger","text":"<p>This will let you add a browser interface to see how you can use the api better.</p> <p>Open <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code> and add </p> <pre><code>SWAGGER_ENABLED = True\n</code></pre> <p>Restart django: <code>sudo systemctl restart rmm</code></p> <p>Then visit <code>https://api.example.com/api/schema/swagger-ui/</code> to see it in action.</p>"},{"location":"functions/automated_tasks/","title":"Automated Tasks","text":""},{"location":"functions/automated_tasks/#collector-tasks","title":"Collector Tasks","text":"<p>Collector tasks allow saving data from script output directly to a custom field. The collector task will only save the last line of standard output of the script.</p> <p>You can create collector tasks by adding it to an Automation Policy or adding it directly to an agent. During creation, select the Collector checkbox and select the custom field to save to. You can only save to agent custom fields at this time.</p> <p>See Custom Fields and Scripting for more information</p>"},{"location":"functions/automation_policies/","title":"Automation Policies","text":"<p>Automation policies in Tactical RMM allow for mass deployment of Checks, Automated Tasks, Patch Policies, and Alert Templates. You can apply Automation Policies to:</p> <ul> <li>Global Settings</li> <li>Client</li> <li>Site</li> <li>Agent</li> </ul> <p>You can also see a list of Relations that show what policy is applied to what Clients | Sites | Agents</p>"},{"location":"functions/automation_policies/#creating-automation-policies","title":"Creating Automation Policies","text":"<p>In the dashboard, navigate to Settings &gt; Automation Manager. Use the Add button to create a blank Automation Policy. The options available are:</p> <ul> <li>Name - The name that will be used to identify the automation policy in the dashboard</li> <li>Description - Optional description of the automation policy</li> <li>Enabled - Specifies if the automation policy is active or not</li> <li>Enforced - Specifies that the automation policy should overwrite any conflicting checks configured directly on the agent</li> </ul>"},{"location":"functions/automation_policies/#policy-inheritance","title":"Policy Inheritance","text":"<p>They get applied in this order:</p> <ol> <li>Global Settings</li> <li>Client</li> <li>Site</li> <li>Agent</li> </ol> <p>and at each level you can Block policy inheritance from the level above using checkboxes in the appropriate screens.</p>"},{"location":"functions/automation_policies/#adding-windows-patch-management-policy","title":"Adding Windows Patch Management Policy","text":"<p>Under the Automation Manager you can create a Patch Policy and control what patches are applied, when, and if the computer is rebooted after.</p> <p>Note</p> <p>Most \"regular\" Windows patches are listed in the \"Other\" category.</p>"},{"location":"functions/custom_fields/","title":"Custom Fields","text":"<p>Info</p> <p>v0.5.0 adds support for custom fields to be used in the dashboard and in scripts.</p>"},{"location":"functions/custom_fields/#adding-custom-fields","title":"Adding Custom Fields","text":"<p>In the dashboard, go to Settings &gt; Global Settings &gt; Custom Fields and click Add Custom Field.</p> <p>Info</p> <p>Everything between {{}} is CaSe sEnSiTive</p> <p>The following options are available to configure on custom fields:</p> <ul> <li>Model - This is the object that the custom field will be added to. The available options are:<ul> <li>Agent</li> <li>Site</li> <li>Client</li> </ul> </li> <li>Name - Sets the name of the custom field. This will be used to identify the custom field in the dashboard and in scripts.</li> <li>Field Type - Sets the type of field. Below are the allowed types.<ul> <li>Text</li> <li>Number</li> <li>Single select dropdown</li> <li>Multi-select dropdown</li> <li>Checkbox</li> <li>DateTime</li> </ul> </li> <li>Input Options - Only available on Single and Multiple-select dropdowns. Sets the options to choose from.</li> <li>Default Value - If no value is found when looking up the custom field; this value will instead be supplied.</li> <li>Required - This makes the field required when adding new Clients, Sites, and Agents. If this is set a default value will need to be set as well</li> <li>Hide in Dashboard - This will not show the custom field in Client, Site, and Agent forms in the dashboard. This is useful if the custom field's value is updated by a collector task and only supplied to scripts.</li> </ul>"},{"location":"functions/custom_fields/#using-custom-fields-in-the-dashboard","title":"Using Custom Fields in the Dashboard","text":"<p>Once the custom fields are added, they will show up in the Client, Site, and Agent Add/Edit forms.</p>"},{"location":"functions/custom_fields/#using-custom-fields-in-scripts","title":"Using Custom Fields in Scripts","text":"<p>Tactical RMM allows for passing various database fields for Clients, Sites, and Agents in scripts. This includes custom fields as well! </p> <p>Warning</p> <p>The characters within the brackets is case-sensitive!</p> <p>In your script's arguments, use the notation <code>{{client.AV_KEY}}</code>. This will lookup the client for the agent that the script is running on and find the custom field named <code>AV_KEY</code> and replace that with the value.</p> <p>The same is also true for <code>{{site.no_patching}}</code> and <code>{{agent.Another Field}}</code></p> <p>For more information see SCRIPTING PAGE</p>"},{"location":"functions/custom_fields/#populating-custom-fields-automatically","title":"Populating Custom Fields automatically","text":"<p>Tactical RMM supports automatically collecting information and saving them directly to custom fields. This is made possible by creating Collector Tasks. These are just normal Automated Tasks, but instead they will save the last line of the standard output to the custom field that is selected.</p> <p>Info</p> <p>To populate a multiple select custom field, return a string with the options separated by a comma <code>\"This,will,be,an,array\"</code></p> <p>For more information See Collector Tasks</p>"},{"location":"functions/database_maintenance/","title":"Database Maintenance","text":"<p>Tactical RMM ships with data retention defaults that will work fine for most environments. There are situations, depending on the number of agents and checks configured, that these defaults need to be tweaked to improve performance.</p>"},{"location":"functions/database_maintenance/#adjusting-data-retention","title":"Adjusting Data Retention","text":"<p>In the dashboard, go to Settings &gt; Global Settings &gt; Retention</p> <p>The options are:</p> <ul> <li>Check History - Will delete check history older than the days specified (default is 30 days).</li> <li>Resolved Alerts - Will delete alerts that have been resolved older than the days specified (default is disabled).</li> <li>Agent History - Will delete agent command/script history older than the days specified (default is 60 days).</li> <li>Debug Logs - Will delete agent debug logs older than the days specified (default is 30 days)</li> <li>Audit Logs Will delete Tactical RMM audit logs older than the days specified (default is disabled)</li> </ul> <p>To disable database pruning on a table, set the days to 0.</p>"},{"location":"functions/django_admin/","title":"Django Admin","text":"<p>Warning</p> <p>Do not use the django admin unless you really know what you're doing.You should never need to access it unless you are familiar with django or are instructed to do something here by one of the developers.</p> <p>The django admin is basically a web interface for the postgres database.</p> <p>As of Tactical RMM v0.4.19, the django admin is disabled by default.</p> <p>To enable it, edit <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code> and change <code>ADMIN_ENABLED</code> from <code>False</code> to <code>True</code> then <code>sudo systemctl restart rmm</code></p> <p>Login to the django admin using the same credentials as your normal web ui login.</p> <p>If you did not save the django admin url (which was printed out at the end of the install script), check the <code>local_settings.py</code> file referenced above for the <code>ADMIN_URL</code> variable. Then simply append the value of this variable to your api domain (<code>https://api.EXAMPLE.COM/</code>) to get the full url.</p> <p>Example of a full django admin url: <pre><code>https://api.example.com/JwboKNYb3v6K93Fvtcz0G3vUM17LMTSZggOUAxa97jQfAh0P5xosEk7u2PPkjEfdOtucUp/\n</code></pre></p>"},{"location":"functions/email_alert/","title":"Email Setup","text":"<p>Under Settings &gt; Global Settings &gt; Email Alerts</p>"},{"location":"functions/email_alert/#setting-up-tactical-rmm-alerts-using-open-relay","title":"Setting up Tactical RMM Alerts using Open Relay","text":"<p>MS 365 in this example</p> <ol> <li>Log into Tactical RMM</li> <li>Go to Settings</li> <li>Go to Global Settings</li> <li>Click on Alerts</li> <li>Enter the email address (or addresses) you want to receive alerts to eg info@EXAMPLE.COM</li> <li>Enter the from email address (this will need to be part of your domain on 365, however it doesn\u2019t need a license) eg rmm@EXAMPLE.COM</li> <li>Go to MXToolbox.com and enter your domain name in, copy the hostname from there and paste into Host</li> <li>Change the port to 25</li> <li>Click Save</li> <li>Login to admin.microsoft.com</li> <li>Go to Exchange Admin Centre</li> <li>Go to \u201cConnectors\u201d under \u201cMail Flow\u201d</li> <li>Click to + button</li> <li>In From: select \u201cYour organisations email server\u201d</li> <li>In To: select \u201cOffice 365\u201d</li> <li>Click Next</li> <li>In the Name type in RMM</li> <li>Click By Verifying that the IP address\u2026\u2026</li> <li>Click +</li> <li>Enter your IP and Click OK</li> <li>Click Next</li> <li>Click OK</li> </ol>"},{"location":"functions/email_alert/#setting-up-tactical-rmm-alerts-using-username-password","title":"Setting up Tactical RMM Alerts using username &amp; password","text":"<p>Gmail in this example</p> <ol> <li>Log into Tactical RMM</li> <li>Go to Settings</li> <li>Go to Global Settings</li> <li>Click on Alerts</li> <li>Enter the email address (or addresses) you want to receive alerts to eg info@EXAMPLE.COM</li> <li>Enter the from email address myrmm@gmail.com</li> <li>Tick the box \u201cMy server requires Authentication\u201d  </li> <li>Enter your username e.g. myrmm@gmail.com</li> <li>Enter your password</li> <li>Change the port to 587</li> <li>Click Save</li> </ol>"},{"location":"functions/examples/","title":"Examples","text":""},{"location":"functions/examples/#create-run-url-action-to-computer-support-page","title":"Create Run URL Action to Computer support page","text":"<p>This will create a URL link that will take you to the support page for a computer based on the computers Serial Number</p> <ol> <li> <p>Goto <code>Settings | Global Settings | Custom Fields</code> </p> <p>Under Agents tab Add Custom Field (CaSe SeNsItIve)</p> <p></p> </li> <li> <p>Create Task (best to use <code>Settings | Automation Manager</code> if you want to apply it to all computers). Add script that has an output of the data you want.</p> <p></p> </li> <li> <p>Create URL Action (under <code>Settings | Global Settings | URL ACTIONS</code>) for Manufacturer websites</p> <p></p> </li> </ol> <p>Dell Support Page</p> <pre><code>https://www.dell.com/support/home/en-us/product-support/servicetag/{{agent.SerialNumber}}/overview\n</code></pre> <p>Lenovo  Support Page</p> <pre><code>https://pcsupport.lenovo.com/us/en/products/{{agent.SerialNumber}}\n</code></pre> <p>HP Support Page</p> <p>It gives an errors because the product model doesn't match the serial number. If you figure out a better link please let us know! :)</p> <pre><code>https://support.hp.com/us-en/product/hp-pro-3500-microtower-pc/5270849/model/5270850?serialnumber={{agent.SerialNumber}}\n</code></pre>"},{"location":"functions/keystore/","title":"Global Key Store","text":"<p>The key store is used to store values that need to be referenced from multiple scripts. This also allows for easy updating of values since scripts reference the values at runtime.</p> <p>To Add/Edit values in the Global Key Store, browse to Settings &gt; Global Settings &gt; KeyStore. </p> <p>You can reference values from the key store in script arguments by using the {{global.key_name}} syntax.</p> <p>Info</p> <p>Everything between {{}} is CaSe sEnSiTive</p> <p>See Scripts for more information.</p>"},{"location":"functions/maintenance_mode/","title":"Maintenance Mode","text":"<p>Enabling maintenance mode for an agent will prevent any overdue/check/task email/sms alerts from being sent.</p> <p>It will also prevent clients/sites/agents from showing up as red in the dashboard if they have any failing checks or are overdue.</p> <p>To enable maintenance mode for all agents in a client/site, Right Click on a client / site and choose Enable Maintenance Mode</p> <p></p> <p>To enable maintenance mode for a single agent, Right Click on the agent and choose Enable Maintenance Mode</p>"},{"location":"functions/permissions/","title":"User Roles and Permissions","text":""},{"location":"functions/permissions/#permission-manager","title":"Permission Manager","text":"<p>Make sure you've setup at least 1 valid (Super User aka Administrator) role under Settings &gt; Permission Manager</p> <ol> <li>Login as usual Tactical user</li> <li>Go to Settings - Permissions Manager</li> <li>Click New Role</li> <li>You can all the role anything, I called it Admins</li> <li>Tick the Super User Box/or relevant permissions required</li> <li>Click Save then exit Permissions Manager</li> <li>Go to Settings - Users</li> <li>Open current logged in user/or any other user and assign role (created above step 6) in the Role drop down box.</li> <li>Click Save </li> </ol> <p>Once you've set that up a Super User role and assigned your primary user, you can create other Roles with more limited access.</p>"},{"location":"functions/remote_bg/","title":"Remote Background","text":"<p>To access: Right click on an agent &gt; Remote Background</p>"},{"location":"functions/remote_bg/#services-tab","title":"Services Tab","text":"<p>Right click on a service to show the context menu where you can start/stop/restart services:</p> <p></p> <p>Click Service Details to bring up the details tab where you can edit more service options:</p> <p></p>"},{"location":"functions/remote_bg/#processes-tab","title":"Processes Tab","text":"<p>A very basic task manager that shows real time process usage.</p> <p>Right click on a process to end the task:</p> <p></p>"},{"location":"functions/scripting/","title":"Scripting","text":"<p>Tactical RMM supports uploading existing scripts or adding new scripts right in the dashboard. Languages supported are:</p> <ul> <li>Powershell</li> <li>Windows Batch</li> <li>Python</li> </ul>"},{"location":"functions/scripting/#adding-scripts","title":"Adding Scripts","text":"<p>In the dashboard, browse to Settings &gt; Scripts Manager. Click the New button and select either Upload Script or New Script. The available options for scripts are:</p> <ul> <li>Name - This identifies the script in the dashboard</li> <li>Description - Optional description for the script</li> <li>Category - Optional way to group similar scripts together. </li> <li>Type - This sets the language of the script. Available options are:<ul> <li>Powershell</li> <li>Windows Batch</li> <li>Python</li> </ul> </li> <li>Script Arguments - Optional way to set default arguments for scripts. These will auto populate when running scripts and can be changed at runtime.</li> <li>Default Timeout - Sets the default timeout of the script and will stop script execution if the duration surpasses the configured timeout. Can be changed at script runtime</li> <li>Favorite - Favorites the script.</li> </ul>"},{"location":"functions/scripting/#downloading-scripts","title":"Downloading Scripts","text":"<p>To download a Tactical RMM Script, click on the script in the Script Manager to select it. Then click the Download Script button on the top. You can also right-click on the script and select download</p>"},{"location":"functions/scripting/#community-scripts","title":"Community Scripts","text":"<p>These are script that are built into Tactical RMM. They are provided and maintained by the Tactical RMM community. These scripts are updated whenever Tactical RMM is updated and can't be modified or deleted in the dashboard.</p>"},{"location":"functions/scripting/#hiding-community-scripts","title":"Hiding Community Scripts","text":"<p>You can choose to hide community script throughout the dashboard by opening Script Manager and clicking the Show/Hide Community Scripts toggle button.</p>"},{"location":"functions/scripting/#using-scripts","title":"Using Scripts","text":""},{"location":"functions/scripting/#manual-run-on-agent","title":"Manual run on agent","text":"<p>In the Agent Table, you can right-click on an agent and select Run Script. You have the options of:</p> <ul> <li>Wait for Output - Runs the script and waits for the script to finish running and displays the output.</li> <li>Fire and Forget - Starts the script and does not wait for output.</li> <li>Email Output - Starts the script and will email the output. Allows for using the default email address in the global settings or adding a new email address.</li> <li>Save as Note - Saves the output as a Note that can be views in the agent Notes tab</li> <li>Collector - Saves to output to the specified custom field.</li> </ul> <p>There is also an option on the agent context menu called Run Favorited Script. This will pre-populate the script run dialog with the script of your choice.</p> <p>Script Execution Process</p>"},{"location":"functions/scripting/#script-arguments","title":"Script Arguments","text":"<p>The <code>Script Arguments</code> field should be pre-filled with information for any script that can accept or requires parameters.</p> <p> &lt;Required Parameter Name&gt; &lt;string&gt; [-&lt;Optional Parameter Name&gt; &lt;string&gt;] [-&lt;string&gt; {(&lt;default string if not specified&gt;) | &lt;string2&gt; | &lt;string3&gt;}]</p> <p>Where <code>[]</code> indicates an optional parameter</p> <p>and <code>{}</code> indicates a parameter with several preconfigured parameter</p> <p>and <code>()</code> indicates a default parameter if none is specified</p>"},{"location":"functions/scripting/#bulk-run-on-agents","title":"Bulk Run on agents","text":"<p>Under the tools menu -&gt; Run Bulk Script you can execute scripts against Clients/Sites/Selected Agents/All based on All/Servers/Workstations</p>"},{"location":"functions/scripting/#automated-tasks","title":"Automated Tasks","text":"<p>Tactical RMM allows scheduling tasks to run on agents. This leverages the Windows Task Scheduler and has the same scheduling options.</p> <p>See Automated Tasks for configuring automated tasks</p>"},{"location":"functions/scripting/#script-checks","title":"Script Checks","text":"<p>Scripts can also be run periodically on an agent and trigger an alert if it fails.</p>"},{"location":"functions/scripting/#alert-failureresolve-actions","title":"Alert Failure/Resolve Actions","text":"<p>Scripts can be triggered when an alert is triggered and resolved. This script will run on any online agent and supports passing the alert information as arguments. </p> <p>For configuring Alert Templates, see Alerting</p> <p>See below for populating dashboard data in scripts and the available options.</p>"},{"location":"functions/scripting/#using-dashboard-data-in-scripts","title":"Using dashboard data in scripts","text":"<p>Tactical RMM allows passing in dashboard data to scripts as arguments. The below powershell arguments will get the client name of the agent and also the agent's public IP address</p> <pre><code>-ClientName {{client.name}} -PublicIP {{agent.public_ip}}\n</code></pre> <p>Info</p> <p>Everything between {{}} is CaSe sEnSiTive</p> <p>See a full list of possible built-in variables Here</p>"},{"location":"functions/scripting/#getting-custom-field-values","title":"Getting Custom Field values","text":"<p>Tactical RMM supports pulling data from custom fields using the {{model.custom_field_name}} syntax.</p> <p>See Using Custom Fields in Scripts</p>"},{"location":"functions/scripting/#getting-values-from-the-global-keystore","title":"Getting values from the Global Keystore","text":"<p>Tactical RMM supports getting values from the global key store using the {{global.key_name}} syntax</p> <p>See Global Keystore.</p>"},{"location":"functions/scripting/#example-powershell-script","title":"Example Powershell Script","text":"<p>The below script takes five named values. The arguments will look like this: <code>-SiteName {{site.name}} -ClientName {{client.name}} -PublicIP {{agent.public_ip}} -CustomField {{client.AV_KEY}} -Global {{global.API_KEY}}</code></p> <pre><code>param (\n   [string] $SiteName,\n   [string] $ClientName,\n   [string] $PublicIp,\n   [string] $CustomField,\n   [string] $Global\n)\n\nWrite-Output \"Site: $SiteName\"\nWrite-Output \"Client: $ClientName\"\nWrite-Output \"Public IP: $PublicIp\"\nWrite-Output \"Custom Fields: $CustomField\"\nWrite-Output \"Global: $Global\"\n</code></pre>"},{"location":"functions/scripting/#script-snippets","title":"Script Snippets","text":"<p>Script Snippets allow you to create common code blocks or comments and apply them to all of your scripts. This could be initialization code, common error checking, or even code comments. </p>"},{"location":"functions/scripting/#adding-script-snippets","title":"Adding Script Snippets","text":"<p>In the dashboard, browse to Settings &gt; Scripts Manager. Click the Script Snippets button.</p> <ul> <li>Name - This identifies the script snippet in the dashboard</li> <li>Description - Optional description for the script snippet</li> <li>Shell - This sets the language of the script. Available options are:<ul> <li>Powershell</li> <li>Windows Batch</li> <li>Python</li> </ul> </li> </ul>"},{"location":"functions/scripting/#using-script-snippets","title":"Using Script Snippets","text":"<p>When editing a script, you can add template tags to the script body that contains the script snippet name. For example, if a script snippet exists with the name \"Check WMF\", you would put {{Check WMF}} in the script body and the snippet code will be replaced.</p> <p>Info</p> <p>Everything between {{}} is CaSe sEnSiTive</p> <p>The template tags will only be visible when Editing the script. When downloading or viewing the script code the template tags will be replaced with the script snippet code.</p>"},{"location":"functions/settings_override/","title":"Settings Override","text":""},{"location":"functions/settings_override/#browser-token-expiration","title":"Browser token expiration","text":"<p>The default browser token expiration is set to 5 hours. See this ticket for reference.</p> <p>To change it, add the following code block to the end of <code>/rmm/api/tacticalrmm/tacticalrmm/local_settings.py</code></p> <pre><code>from datetime import timedelta\n\nREST_KNOX = {\n    \"TOKEN_TTL\": timedelta(days=30),\n    \"AUTO_REFRESH\": True,\n    \"MIN_REFRESH_INTERVAL\": 600,\n}\n</code></pre> <p>Change <code>(days=30)</code> to whatever you prefer. Then run <code>sudo systemctl restart rmm</code> for changes to take effect.</p>"},{"location":"functions/url_actions/","title":"URL Actions","text":"<p>URL Actions will run against an agent and open a configured URL in a new browser tab or window. This allows for integrations with various remote viewing softwares.</p>"},{"location":"functions/url_actions/#adding-url-actions","title":"Adding URL Actions","text":"<p>In the dashboard, browse to Settings &gt; Global Settings &gt; URL Actions. The available options are:</p> <ul> <li>Name - This identifies the URL Action in other parts of the dashboard</li> <li>Description - Optional description for the URL Action</li> <li>Pattern - This is the actual URL pattern that will open in the new browser tab/window. This field supports variables from the Global Keystore and Script Variables.</li> </ul>"},{"location":"functions/url_actions/#url-pattern-example","title":"URL Pattern Example","text":"<p>Info</p> <p>Variable names are case sensitive!</p> <pre><code>https://remote.example.com/connect?API_KEY={{global.API_KEY}}&amp;agent_id={{agent.Remote ID}}\n</code></pre> <p>The above example uses a value defined in the global keystore named API_KEY and an Agent custom field called remote id. The URLs are properly encoded to work with any special characters or spaces returned in the values.</p>"},{"location":"functions/url_actions/#running-url-actions","title":"Running URL Actions","text":"<p>In the agent table, right-click on the Agent and select Run URL Action and select the action to run</p>"},{"location":"functions/user_ui/","title":"User Interface Preferences","text":"<p>Click on your username at the top right of the dashboard &gt; Preferences:</p> <p></p> <p></p>"}]}